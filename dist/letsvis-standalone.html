<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> LayerGroup 调试可视化工具</title>
    <!-- Vite 会注入 CSS -->
    <script type="module" crossorigin>(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function ws(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const Q={},$e=[],qt=()=>{},il=()=>!1,pr=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),xs=t=>t.startsWith("onUpdate:"),wt=Object.assign,bs=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},ol=Object.prototype.hasOwnProperty,K=(t,e)=>ol.call(t,e),U=Array.isArray,We=t=>Pn(t)==="[object Map]",mr=t=>Pn(t)==="[object Set]",js=t=>Pn(t)==="[object Date]",V=t=>typeof t=="function",at=t=>typeof t=="string",Jt=t=>typeof t=="symbol",nt=t=>t!==null&&typeof t=="object",co=t=>(nt(t)||V(t))&&V(t.then)&&V(t.catch),uo=Object.prototype.toString,Pn=t=>uo.call(t),al=t=>Pn(t).slice(8,-1),fo=t=>Pn(t)==="[object Object]",Ss=t=>at(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,cn=ws(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),gr=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},ll=/-(\w)/g,Bt=gr(t=>t.replace(ll,(e,n)=>n?n.toUpperCase():"")),cl=/\B([A-Z])/g,Ie=gr(t=>t.replace(cl,"-$1").toLowerCase()),vr=gr(t=>t.charAt(0).toUpperCase()+t.slice(1)),Pr=gr(t=>t?`on${vr(t)}`:""),xe=(t,e)=>!Object.is(t,e),Yn=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},jr=(t,e,n,r=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:r,value:n})},ho=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Ks;const yr=()=>Ks||(Ks=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function As(t){if(U(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],s=at(r)?dl(r):As(r);if(s)for(const i in s)e[i]=s[i]}return e}else if(at(t)||nt(t))return t}const ul=/;(?![^(]*\))/g,fl=/:([^]+)/,hl=/\/\*[^]*?\*\//g;function dl(t){const e={};return t.replace(hl,"").split(ul).forEach(n=>{if(n){const r=n.split(fl);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function _n(t){let e="";if(at(t))e=t;else if(U(t))for(let n=0;n<t.length;n++){const r=_n(t[n]);r&&(e+=r+" ")}else if(nt(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const pl="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",ml=ws(pl);function po(t){return!!t||t===""}function gl(t,e){if(t.length!==e.length)return!1;let n=!0;for(let r=0;n&&r<t.length;r++)n=_r(t[r],e[r]);return n}function _r(t,e){if(t===e)return!0;let n=js(t),r=js(e);if(n||r)return n&&r?t.getTime()===e.getTime():!1;if(n=Jt(t),r=Jt(e),n||r)return t===e;if(n=U(t),r=U(e),n||r)return n&&r?gl(t,e):!1;if(n=nt(t),r=nt(e),n||r){if(!n||!r)return!1;const s=Object.keys(t).length,i=Object.keys(e).length;if(s!==i)return!1;for(const o in t){const a=t.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!_r(t[o],e[o]))return!1}}return String(t)===String(e)}function vl(t,e){return t.findIndex(n=>_r(n,e))}const mo=t=>!!(t&&t.__v_isRef===!0),ht=t=>at(t)?t:t==null?"":U(t)||nt(t)&&(t.toString===uo||!V(t.toString))?mo(t)?ht(t.value):JSON.stringify(t,go,2):String(t),go=(t,e)=>mo(e)?go(t,e.value):We(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[r,s],i)=>(n[Ir(r,i)+" =>"]=s,n),{})}:mr(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>Ir(n))}:Jt(e)?Ir(e):nt(e)&&!U(e)&&!fo(e)?String(e):e,Ir=(t,e="")=>{var n;return Jt(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Rt;class yl{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Rt,!e&&Rt&&(this.index=(Rt.scopes||(Rt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=Rt;try{return Rt=this,e()}finally{Rt=n}}}on(){++this._on===1&&(this.prevScope=Rt,Rt=this)}off(){this._on>0&&--this._on===0&&(Rt=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(this.effects.length=0,n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function _l(){return Rt}let et;const Fr=new WeakSet;class vo{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Rt&&Rt.active&&Rt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Fr.has(this)&&(Fr.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||_o(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,qs(this),wo(this);const e=et,n=Ht;et=this,Ht=!0;try{return this.fn()}finally{xo(this),et=e,Ht=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Cs(e);this.deps=this.depsTail=void 0,qs(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Fr.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Kr(this)&&this.run()}get dirty(){return Kr(this)}}let yo=0,un,fn;function _o(t,e=!1){if(t.flags|=8,e){t.next=fn,fn=t;return}t.next=un,un=t}function Es(){yo++}function Ts(){if(--yo>0)return;if(fn){let e=fn;for(fn=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;un;){let e=un;for(un=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){t||(t=r)}e=n}}if(t)throw t}function wo(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function xo(t){let e,n=t.depsTail,r=n;for(;r;){const s=r.prevDep;r.version===-1?(r===n&&(n=s),Cs(r),wl(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=s}t.deps=e,t.depsTail=n}function Kr(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(bo(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function bo(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===wn)||(t.globalVersion=wn,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!Kr(t))))return;t.flags|=2;const e=t.dep,n=et,r=Ht;et=t,Ht=!0;try{wo(t);const s=t.fn(t._value);(e.version===0||xe(s,t._value))&&(t.flags|=128,t._value=s,e.version++)}catch(s){throw e.version++,s}finally{et=n,Ht=r,xo(t),t.flags&=-3}}function Cs(t,e=!1){const{dep:n,prevSub:r,nextSub:s}=t;if(r&&(r.nextSub=s,t.prevSub=void 0),s&&(s.prevSub=r,t.nextSub=void 0),n.subs===t&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let i=n.computed.deps;i;i=i.nextDep)Cs(i,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function wl(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let Ht=!0;const So=[];function ue(){So.push(Ht),Ht=!1}function fe(){const t=So.pop();Ht=t===void 0?!0:t}function qs(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=et;et=void 0;try{e()}finally{et=n}}}let wn=0;class xl{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Rs{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!et||!Ht||et===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==et)n=this.activeLink=new xl(et,this),et.deps?(n.prevDep=et.depsTail,et.depsTail.nextDep=n,et.depsTail=n):et.deps=et.depsTail=n,Ao(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const r=n.nextDep;r.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=r),n.prevDep=et.depsTail,n.nextDep=void 0,et.depsTail.nextDep=n,et.depsTail=n,et.deps===n&&(et.deps=r)}return n}trigger(e){this.version++,wn++,this.notify(e)}notify(e){Es();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{Ts()}}}function Ao(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)Ao(r)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const qr=new WeakMap,Me=Symbol(""),Zr=Symbol(""),xn=Symbol("");function vt(t,e,n){if(Ht&&et){let r=qr.get(t);r||qr.set(t,r=new Map);let s=r.get(n);s||(r.set(n,s=new Rs),s.map=r,s.key=n),s.track()}}function oe(t,e,n,r,s,i){const o=qr.get(t);if(!o){wn++;return}const a=l=>{l&&l.trigger()};if(Es(),e==="clear")o.forEach(a);else{const l=U(t),u=l&&Ss(n);if(l&&n==="length"){const c=Number(r);o.forEach((f,h)=>{(h==="length"||h===xn||!Jt(h)&&h>=c)&&a(f)})}else switch((n!==void 0||o.has(void 0))&&a(o.get(n)),u&&a(o.get(xn)),e){case"add":l?u&&a(o.get("length")):(a(o.get(Me)),We(t)&&a(o.get(Zr)));break;case"delete":l||(a(o.get(Me)),We(t)&&a(o.get(Zr)));break;case"set":We(t)&&a(o.get(Me));break}}Ts()}function Be(t){const e=j(t);return e===t?e:(vt(e,"iterate",xn),kt(t)?e:e.map(dt))}function wr(t){return vt(t=j(t),"iterate",xn),t}const bl={__proto__:null,[Symbol.iterator](){return Dr(this,Symbol.iterator,dt)},concat(...t){return Be(this).concat(...t.map(e=>U(e)?Be(e):e))},entries(){return Dr(this,"entries",t=>(t[1]=dt(t[1]),t))},every(t,e){return ne(this,"every",t,e,void 0,arguments)},filter(t,e){return ne(this,"filter",t,e,n=>n.map(dt),arguments)},find(t,e){return ne(this,"find",t,e,dt,arguments)},findIndex(t,e){return ne(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return ne(this,"findLast",t,e,dt,arguments)},findLastIndex(t,e){return ne(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return ne(this,"forEach",t,e,void 0,arguments)},includes(...t){return kr(this,"includes",t)},indexOf(...t){return kr(this,"indexOf",t)},join(t){return Be(this).join(t)},lastIndexOf(...t){return kr(this,"lastIndexOf",t)},map(t,e){return ne(this,"map",t,e,void 0,arguments)},pop(){return tn(this,"pop")},push(...t){return tn(this,"push",t)},reduce(t,...e){return Zs(this,"reduce",t,e)},reduceRight(t,...e){return Zs(this,"reduceRight",t,e)},shift(){return tn(this,"shift")},some(t,e){return ne(this,"some",t,e,void 0,arguments)},splice(...t){return tn(this,"splice",t)},toReversed(){return Be(this).toReversed()},toSorted(t){return Be(this).toSorted(t)},toSpliced(...t){return Be(this).toSpliced(...t)},unshift(...t){return tn(this,"unshift",t)},values(){return Dr(this,"values",dt)}};function Dr(t,e,n){const r=wr(t),s=r[e]();return r!==t&&!kt(t)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=n(i.value)),i}),s}const Sl=Array.prototype;function ne(t,e,n,r,s,i){const o=wr(t),a=o!==t&&!kt(t),l=o[e];if(l!==Sl[e]){const f=l.apply(t,i);return a?dt(f):f}let u=n;o!==t&&(a?u=function(f,h){return n.call(this,dt(f),h,t)}:n.length>2&&(u=function(f,h){return n.call(this,f,h,t)}));const c=l.call(o,u,r);return a&&s?s(c):c}function Zs(t,e,n,r){const s=wr(t);let i=n;return s!==t&&(kt(t)?n.length>3&&(i=function(o,a,l){return n.call(this,o,a,l,t)}):i=function(o,a,l){return n.call(this,o,dt(a),l,t)}),s[e](i,...r)}function kr(t,e,n){const r=j(t);vt(r,"iterate",xn);const s=r[e](...n);return(s===-1||s===!1)&&Ls(n[0])?(n[0]=j(n[0]),r[e](...n)):s}function tn(t,e,n=[]){ue(),Es();const r=j(t)[e].apply(t,n);return Ts(),fe(),r}const Al=ws("__proto__,__v_isRef,__isVue"),Eo=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Jt));function El(t){Jt(t)||(t=String(t));const e=j(this);return vt(e,"has",t),e.hasOwnProperty(t)}class To{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,r){if(n==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return i;if(n==="__v_raw")return r===(s?i?Dl:Oo:i?Mo:Ro).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=U(e);if(!s){let l;if(o&&(l=bl[n]))return l;if(n==="hasOwnProperty")return El}const a=Reflect.get(e,n,_t(e)?e:r);return(Jt(n)?Eo.has(n):Al(n))||(s||vt(e,"get",n),i)?a:_t(a)?o&&Ss(n)?a:a.value:nt(a)?s?Po(a):In(a):a}}class Co extends To{constructor(e=!1){super(!1,e)}set(e,n,r,s){let i=e[n];if(!this._isShallow){const l=be(i);if(!kt(r)&&!be(r)&&(i=j(i),r=j(r)),!U(e)&&_t(i)&&!_t(r))return l?!1:(i.value=r,!0)}const o=U(e)&&Ss(n)?Number(n)<e.length:K(e,n),a=Reflect.set(e,n,r,_t(e)?e:s);return e===j(s)&&(o?xe(r,i)&&oe(e,"set",n,r):oe(e,"add",n,r)),a}deleteProperty(e,n){const r=K(e,n);e[n];const s=Reflect.deleteProperty(e,n);return s&&r&&oe(e,"delete",n,void 0),s}has(e,n){const r=Reflect.has(e,n);return(!Jt(n)||!Eo.has(n))&&vt(e,"has",n),r}ownKeys(e){return vt(e,"iterate",U(e)?"length":Me),Reflect.ownKeys(e)}}class Tl extends To{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const Cl=new Co,Rl=new Tl,Ml=new Co(!0);const Jr=t=>t,$n=t=>Reflect.getPrototypeOf(t);function Ol(t,e,n){return function(...r){const s=this.__v_raw,i=j(s),o=We(i),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,u=s[t](...r),c=n?Jr:e?Qn:dt;return!e&&vt(i,"iterate",l?Zr:Me),{next(){const{value:f,done:h}=u.next();return h?{value:f,done:h}:{value:a?[c(f[0]),c(f[1])]:c(f),done:h}},[Symbol.iterator](){return this}}}}function Wn(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Ll(t,e){const n={get(s){const i=this.__v_raw,o=j(i),a=j(s);t||(xe(s,a)&&vt(o,"get",s),vt(o,"get",a));const{has:l}=$n(o),u=e?Jr:t?Qn:dt;if(l.call(o,s))return u(i.get(s));if(l.call(o,a))return u(i.get(a));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!t&&vt(j(s),"iterate",Me),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,o=j(i),a=j(s);return t||(xe(s,a)&&vt(o,"has",s),vt(o,"has",a)),s===a?i.has(s):i.has(s)||i.has(a)},forEach(s,i){const o=this,a=o.__v_raw,l=j(a),u=e?Jr:t?Qn:dt;return!t&&vt(l,"iterate",Me),a.forEach((c,f)=>s.call(i,u(c),u(f),o))}};return wt(n,t?{add:Wn("add"),set:Wn("set"),delete:Wn("delete"),clear:Wn("clear")}:{add(s){!e&&!kt(s)&&!be(s)&&(s=j(s));const i=j(this);return $n(i).has.call(i,s)||(i.add(s),oe(i,"add",s,s)),this},set(s,i){!e&&!kt(i)&&!be(i)&&(i=j(i));const o=j(this),{has:a,get:l}=$n(o);let u=a.call(o,s);u||(s=j(s),u=a.call(o,s));const c=l.call(o,s);return o.set(s,i),u?xe(i,c)&&oe(o,"set",s,i):oe(o,"add",s,i),this},delete(s){const i=j(this),{has:o,get:a}=$n(i);let l=o.call(i,s);l||(s=j(s),l=o.call(i,s)),a&&a.call(i,s);const u=i.delete(s);return l&&oe(i,"delete",s,void 0),u},clear(){const s=j(this),i=s.size!==0,o=s.clear();return i&&oe(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{n[s]=Ol(s,t,e)}),n}function Ms(t,e){const n=Ll(t,e);return(r,s,i)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?r:Reflect.get(K(n,s)&&s in r?n:r,s,i)}const Pl={get:Ms(!1,!1)},Il={get:Ms(!1,!0)},Fl={get:Ms(!0,!1)};const Ro=new WeakMap,Mo=new WeakMap,Oo=new WeakMap,Dl=new WeakMap;function kl(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Bl(t){return t.__v_skip||!Object.isExtensible(t)?0:kl(al(t))}function In(t){return be(t)?t:Os(t,!1,Cl,Pl,Ro)}function Lo(t){return Os(t,!1,Ml,Il,Mo)}function Po(t){return Os(t,!0,Rl,Fl,Oo)}function Os(t,e,n,r,s){if(!nt(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=Bl(t);if(i===0)return t;const o=s.get(t);if(o)return o;const a=new Proxy(t,i===2?r:n);return s.set(t,a),a}function Ue(t){return be(t)?Ue(t.__v_raw):!!(t&&t.__v_isReactive)}function be(t){return!!(t&&t.__v_isReadonly)}function kt(t){return!!(t&&t.__v_isShallow)}function Ls(t){return t?!!t.__v_raw:!1}function j(t){const e=t&&t.__v_raw;return e?j(e):t}function Nl(t){return!K(t,"__v_skip")&&Object.isExtensible(t)&&jr(t,"__v_skip",!0),t}const dt=t=>nt(t)?In(t):t,Qn=t=>nt(t)?Po(t):t;function _t(t){return t?t.__v_isRef===!0:!1}function it(t){return Io(t,!1)}function Hl(t){return Io(t,!0)}function Io(t,e){return _t(t)?t:new $l(t,e)}class $l{constructor(e,n){this.dep=new Rs,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:j(e),this._value=n?e:dt(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,r=this.__v_isShallow||kt(e)||be(e);e=r?e:j(e),xe(e,n)&&(this._rawValue=e,this._value=r?e:dt(e),this.dep.trigger())}}function Oe(t){return _t(t)?t.value:t}const Wl={get:(t,e,n)=>e==="__v_raw"?t:Oe(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const s=t[e];return _t(s)&&!_t(n)?(s.value=n,!0):Reflect.set(t,e,n,r)}};function Fo(t){return Ue(t)?t:new Proxy(t,Wl)}class Ul{constructor(e,n,r){this.fn=e,this.setter=n,this._value=void 0,this.dep=new Rs(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=wn-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&et!==this)return _o(this,!0),!0}get value(){const e=this.dep.track();return bo(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function zl(t,e,n=!1){let r,s;return V(t)?r=t:(r=t.get,s=t.set),new Ul(r,s,n)}const Un={},tr=new WeakMap;let Ce;function Vl(t,e=!1,n=Ce){if(n){let r=tr.get(n);r||tr.set(n,r=[]),r.push(t)}}function Gl(t,e,n=Q){const{immediate:r,deep:s,once:i,scheduler:o,augmentJob:a,call:l}=n,u=x=>s?x:kt(x)||s===!1||s===0?ae(x,1):ae(x);let c,f,h,d,v=!1,y=!1;if(_t(t)?(f=()=>t.value,v=kt(t)):Ue(t)?(f=()=>u(t),v=!0):U(t)?(y=!0,v=t.some(x=>Ue(x)||kt(x)),f=()=>t.map(x=>{if(_t(x))return x.value;if(Ue(x))return u(x);if(V(x))return l?l(x,2):x()})):V(t)?e?f=l?()=>l(t,2):t:f=()=>{if(h){ue();try{h()}finally{fe()}}const x=Ce;Ce=c;try{return l?l(t,3,[d]):t(d)}finally{Ce=x}}:f=qt,e&&s){const x=f,M=s===!0?1/0:s;f=()=>ae(x(),M)}const T=_l(),w=()=>{c.stop(),T&&T.active&&bs(T.effects,c)};if(i&&e){const x=e;e=(...M)=>{x(...M),w()}}let _=y?new Array(t.length).fill(Un):Un;const b=x=>{if(!(!(c.flags&1)||!c.dirty&&!x))if(e){const M=c.run();if(s||v||(y?M.some((k,W)=>xe(k,_[W])):xe(M,_))){h&&h();const k=Ce;Ce=c;try{const W=[M,_===Un?void 0:y&&_[0]===Un?[]:_,d];_=M,l?l(e,3,W):e(...W)}finally{Ce=k}}}else c.run()};return a&&a(b),c=new vo(f),c.scheduler=o?()=>o(b,!1):b,d=x=>Vl(x,!1,c),h=c.onStop=()=>{const x=tr.get(c);if(x){if(l)l(x,4);else for(const M of x)M();tr.delete(c)}},e?r?b(!0):_=c.run():o?o(b.bind(null,!0),!0):c.run(),w.pause=c.pause.bind(c),w.resume=c.resume.bind(c),w.stop=w,w}function ae(t,e=1/0,n){if(e<=0||!nt(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,_t(t))ae(t.value,e,n);else if(U(t))for(let r=0;r<t.length;r++)ae(t[r],e,n);else if(mr(t)||We(t))t.forEach(r=>{ae(r,e,n)});else if(fo(t)){for(const r in t)ae(t[r],e,n);for(const r of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,r)&&ae(t[r],e,n)}return t}/**
* @vue/runtime-core v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Fn(t,e,n,r){try{return r?t(...r):t()}catch(s){xr(s,e,n)}}function Qt(t,e,n,r){if(V(t)){const s=Fn(t,e,n,r);return s&&co(s)&&s.catch(i=>{xr(i,e,n)}),s}if(U(t)){const s=[];for(let i=0;i<t.length;i++)s.push(Qt(t[i],e,n,r));return s}}function xr(t,e,n,r=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Q;if(e){let a=e.parent;const l=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const c=a.ec;if(c){for(let f=0;f<c.length;f++)if(c[f](t,l,u)===!1)return}a=a.parent}if(i){ue(),Fn(i,null,10,[t,l,u]),fe();return}}Yl(t,n,s,r,o)}function Yl(t,e,n,r=!0,s=!1){if(s)throw t;console.error(t)}const St=[];let jt=-1;const ze=[];let ge=null,Ne=0;const Do=Promise.resolve();let er=null;function Dn(t){const e=er||Do;return t?e.then(this?t.bind(this):t):e}function Xl(t){let e=jt+1,n=St.length;for(;e<n;){const r=e+n>>>1,s=St[r],i=bn(s);i<t||i===t&&s.flags&2?e=r+1:n=r}return e}function Ps(t){if(!(t.flags&1)){const e=bn(t),n=St[St.length-1];!n||!(t.flags&2)&&e>=bn(n)?St.push(t):St.splice(Xl(e),0,t),t.flags|=1,ko()}}function ko(){er||(er=Do.then(No))}function jl(t){U(t)?ze.push(...t):ge&&t.id===-1?ge.splice(Ne+1,0,t):t.flags&1||(ze.push(t),t.flags|=1),ko()}function Js(t,e,n=jt+1){for(;n<St.length;n++){const r=St[n];if(r&&r.flags&2){if(t&&r.id!==t.uid)continue;St.splice(n,1),n--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function Bo(t){if(ze.length){const e=[...new Set(ze)].sort((n,r)=>bn(n)-bn(r));if(ze.length=0,ge){ge.push(...e);return}for(ge=e,Ne=0;Ne<ge.length;Ne++){const n=ge[Ne];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}ge=null,Ne=0}}const bn=t=>t.id==null?t.flags&2?-1:1/0:t.id;function No(t){try{for(jt=0;jt<St.length;jt++){const e=St[jt];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Fn(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;jt<St.length;jt++){const e=St[jt];e&&(e.flags&=-2)}jt=-1,St.length=0,Bo(),er=null,(St.length||ze.length)&&No()}}let Pt=null,Ho=null;function nr(t){const e=Pt;return Pt=t,Ho=t&&t.type.__scopeId||null,e}function Qr(t,e=Pt,n){if(!e||t._n)return t;const r=(...s)=>{r._d&&ci(-1);const i=nr(e);let o;try{o=t(...s)}finally{nr(i),r._d&&ci(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function ts(t,e){if(Pt===null)return t;const n=Cr(Pt),r=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,a,l=Q]=e[s];i&&(V(i)&&(i={mounted:i,updated:i}),i.deep&&ae(o),r.push({dir:i,instance:n,value:o,oldValue:void 0,arg:a,modifiers:l}))}return t}function Ee(t,e,n,r){const s=t.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let l=a.dir[r];l&&(ue(),Qt(l,n,8,[t.el,a,t,e]),fe())}}const Kl=Symbol("_vte"),ql=t=>t.__isTeleport;function Is(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Is(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}/*! #__NO_SIDE_EFFECTS__ */function $o(t,e){return V(t)?wt({name:t.name},e,{setup:t}):t}function Wo(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function hn(t,e,n,r,s=!1){if(U(t)){t.forEach((v,y)=>hn(v,e&&(U(e)?e[y]:e),n,r,s));return}if(dn(r)&&!s){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&hn(t,e,n,r.component.subTree);return}const i=r.shapeFlag&4?Cr(r.component):r.el,o=s?null:i,{i:a,r:l}=t,u=e&&e.r,c=a.refs===Q?a.refs={}:a.refs,f=a.setupState,h=j(f),d=f===Q?()=>!1:v=>K(h,v);if(u!=null&&u!==l&&(at(u)?(c[u]=null,d(u)&&(f[u]=null)):_t(u)&&(u.value=null)),V(l))Fn(l,a,12,[o,c]);else{const v=at(l),y=_t(l);if(v||y){const T=()=>{if(t.f){const w=v?d(l)?f[l]:c[l]:l.value;s?U(w)&&bs(w,i):U(w)?w.includes(i)||w.push(i):v?(c[l]=[i],d(l)&&(f[l]=c[l])):(l.value=[i],t.k&&(c[t.k]=l.value))}else v?(c[l]=o,d(l)&&(f[l]=o)):y&&(l.value=o,t.k&&(c[t.k]=o))};o?(T.id=-1,Lt(T,n)):T()}}}yr().requestIdleCallback;yr().cancelIdleCallback;const dn=t=>!!t.type.__asyncLoader,Uo=t=>t.type.__isKeepAlive;function Zl(t,e){zo(t,"a",e)}function Jl(t,e){zo(t,"da",e)}function zo(t,e,n=yt){const r=t.__wdc||(t.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(br(e,r,n),n){let s=n.parent;for(;s&&s.parent;)Uo(s.parent.vnode)&&Ql(r,e,n,s),s=s.parent}}function Ql(t,e,n,r){const s=br(e,t,r,!0);Ar(()=>{bs(r[e],s)},n)}function br(t,e,n=yt,r=!1){if(n){const s=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{ue();const a=kn(n),l=Qt(e,n,t,o);return a(),fe(),l});return r?s.unshift(i):s.push(i),i}}const de=t=>(e,n=yt)=>{(!En||t==="sp")&&br(t,(...r)=>e(...r),n)},tc=de("bm"),Sr=de("m"),ec=de("bu"),nc=de("u"),rc=de("bum"),Ar=de("um"),sc=de("sp"),ic=de("rtg"),oc=de("rtc");function ac(t,e=yt){br("ec",t,e)}const lc="components";function Qs(t,e){return uc(lc,t,!0,e)||t}const cc=Symbol.for("v-ndc");function uc(t,e,n=!0,r=!1){const s=Pt||yt;if(s){const i=s.type;{const a=Zc(i,!1);if(a&&(a===e||a===Bt(e)||a===vr(Bt(e))))return i}const o=ti(s[t]||i[t],e)||ti(s.appContext[t],e);return!o&&r?i:o}}function ti(t,e){return t&&(t[e]||t[Bt(e)]||t[vr(Bt(e))])}function es(t,e,n,r){let s;const i=n,o=U(t);if(o||at(t)){const a=o&&Ue(t);let l=!1,u=!1;a&&(l=!kt(t),u=be(t),t=wr(t)),s=new Array(t.length);for(let c=0,f=t.length;c<f;c++)s[c]=e(l?u?Qn(dt(t[c])):dt(t[c]):t[c],c,void 0,i)}else if(typeof t=="number"){s=new Array(t);for(let a=0;a<t;a++)s[a]=e(a+1,a,void 0,i)}else if(nt(t))if(t[Symbol.iterator])s=Array.from(t,(a,l)=>e(a,l,void 0,i));else{const a=Object.keys(t);s=new Array(a.length);for(let l=0,u=a.length;l<u;l++){const c=a[l];s[l]=e(t[c],c,l,i)}}else s=[];return s}const ns=t=>t?ua(t)?Cr(t):ns(t.parent):null,pn=wt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>ns(t.parent),$root:t=>ns(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Go(t),$forceUpdate:t=>t.f||(t.f=()=>{Ps(t.update)}),$nextTick:t=>t.n||(t.n=Dn.bind(t.proxy)),$watch:t=>Lc.bind(t)}),Br=(t,e)=>t!==Q&&!t.__isScriptSetup&&K(t,e),fc={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:l}=t;let u;if(e[0]!=="$"){const d=o[e];if(d!==void 0)switch(d){case 1:return r[e];case 2:return s[e];case 4:return n[e];case 3:return i[e]}else{if(Br(r,e))return o[e]=1,r[e];if(s!==Q&&K(s,e))return o[e]=2,s[e];if((u=t.propsOptions[0])&&K(u,e))return o[e]=3,i[e];if(n!==Q&&K(n,e))return o[e]=4,n[e];rs&&(o[e]=0)}}const c=pn[e];let f,h;if(c)return e==="$attrs"&&vt(t.attrs,"get",""),c(t);if((f=a.__cssModules)&&(f=f[e]))return f;if(n!==Q&&K(n,e))return o[e]=4,n[e];if(h=l.config.globalProperties,K(h,e))return h[e]},set({_:t},e,n){const{data:r,setupState:s,ctx:i}=t;return Br(s,e)?(s[e]=n,!0):r!==Q&&K(r,e)?(r[e]=n,!0):K(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!n[o]||t!==Q&&K(t,o)||Br(e,o)||(a=i[0])&&K(a,o)||K(r,o)||K(pn,o)||K(s.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:K(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function ei(t){return U(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let rs=!0;function hc(t){const e=Go(t),n=t.proxy,r=t.ctx;rs=!1,e.beforeCreate&&ni(e.beforeCreate,t,"bc");const{data:s,computed:i,methods:o,watch:a,provide:l,inject:u,created:c,beforeMount:f,mounted:h,beforeUpdate:d,updated:v,activated:y,deactivated:T,beforeDestroy:w,beforeUnmount:_,destroyed:b,unmounted:x,render:M,renderTracked:k,renderTriggered:W,errorCaptured:st,serverPrefetch:ft,expose:lt,inheritAttrs:mt,components:xt,directives:gt,filters:rt}=e;if(u&&dc(u,r,null),o)for(const Z in o){const Y=o[Z];V(Y)&&(r[Z]=Y.bind(n))}if(s){const Z=s.call(n,n);nt(Z)&&(t.data=In(Z))}if(rs=!0,i)for(const Z in i){const Y=i[Z],ee=V(Y)?Y.bind(n,n):V(Y.get)?Y.get.bind(n,n):qt,pe=!V(Y)&&V(Y.set)?Y.set.bind(n):qt,zt=At({get:ee,set:pe});Object.defineProperty(r,Z,{enumerable:!0,configurable:!0,get:()=>zt.value,set:Et=>zt.value=Et})}if(a)for(const Z in a)Vo(a[Z],r,n,Z);if(l){const Z=V(l)?l.call(n):l;Reflect.ownKeys(Z).forEach(Y=>{Xn(Y,Z[Y])})}c&&ni(c,t,"c");function ut(Z,Y){U(Y)?Y.forEach(ee=>Z(ee.bind(n))):Y&&Z(Y.bind(n))}if(ut(tc,f),ut(Sr,h),ut(ec,d),ut(nc,v),ut(Zl,y),ut(Jl,T),ut(ac,st),ut(oc,k),ut(ic,W),ut(rc,_),ut(Ar,x),ut(sc,ft),U(lt))if(lt.length){const Z=t.exposed||(t.exposed={});lt.forEach(Y=>{Object.defineProperty(Z,Y,{get:()=>n[Y],set:ee=>n[Y]=ee,enumerable:!0})})}else t.exposed||(t.exposed={});M&&t.render===qt&&(t.render=M),mt!=null&&(t.inheritAttrs=mt),xt&&(t.components=xt),gt&&(t.directives=gt),ft&&Wo(t)}function dc(t,e,n=qt){U(t)&&(t=ss(t));for(const r in t){const s=t[r];let i;nt(s)?"default"in s?i=ce(s.from||r,s.default,!0):i=ce(s.from||r):i=ce(s),_t(i)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[r]=i}}function ni(t,e,n){Qt(U(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function Vo(t,e,n,r){let s=r.includes(".")?sa(n,r):()=>n[r];if(at(t)){const i=e[t];V(i)&&mn(s,i)}else if(V(t))mn(s,t.bind(n));else if(nt(t))if(U(t))t.forEach(i=>Vo(i,e,n,r));else{const i=V(t.handler)?t.handler.bind(n):e[t.handler];V(i)&&mn(s,i,t)}}function Go(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let l;return a?l=a:!s.length&&!n&&!r?l=e:(l={},s.length&&s.forEach(u=>rr(l,u,o,!0)),rr(l,e,o)),nt(e)&&i.set(e,l),l}function rr(t,e,n,r=!1){const{mixins:s,extends:i}=e;i&&rr(t,i,n,!0),s&&s.forEach(o=>rr(t,o,n,!0));for(const o in e)if(!(r&&o==="expose")){const a=pc[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const pc={data:ri,props:si,emits:si,methods:sn,computed:sn,beforeCreate:bt,created:bt,beforeMount:bt,mounted:bt,beforeUpdate:bt,updated:bt,beforeDestroy:bt,beforeUnmount:bt,destroyed:bt,unmounted:bt,activated:bt,deactivated:bt,errorCaptured:bt,serverPrefetch:bt,components:sn,directives:sn,watch:gc,provide:ri,inject:mc};function ri(t,e){return e?t?function(){return wt(V(t)?t.call(this,this):t,V(e)?e.call(this,this):e)}:e:t}function mc(t,e){return sn(ss(t),ss(e))}function ss(t){if(U(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function bt(t,e){return t?[...new Set([].concat(t,e))]:e}function sn(t,e){return t?wt(Object.create(null),t,e):e}function si(t,e){return t?U(t)&&U(e)?[...new Set([...t,...e])]:wt(Object.create(null),ei(t),ei(e??{})):e}function gc(t,e){if(!t)return e;if(!e)return t;const n=wt(Object.create(null),t);for(const r in e)n[r]=bt(t[r],e[r]);return n}function Yo(){return{app:null,config:{isNativeTag:il,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let vc=0;function yc(t,e){return function(r,s=null){V(r)||(r=wt({},r)),s!=null&&!nt(s)&&(s=null);const i=Yo(),o=new WeakSet,a=[];let l=!1;const u=i.app={_uid:vc++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:Qc,get config(){return i.config},set config(c){},use(c,...f){return o.has(c)||(c&&V(c.install)?(o.add(c),c.install(u,...f)):V(c)&&(o.add(c),c(u,...f))),u},mixin(c){return i.mixins.includes(c)||i.mixins.push(c),u},component(c,f){return f?(i.components[c]=f,u):i.components[c]},directive(c,f){return f?(i.directives[c]=f,u):i.directives[c]},mount(c,f,h){if(!l){const d=u._ceVNode||ot(r,s);return d.appContext=i,h===!0?h="svg":h===!1&&(h=void 0),t(d,c,h),l=!0,u._container=c,c.__vue_app__=u,Cr(d.component)}},onUnmount(c){a.push(c)},unmount(){l&&(Qt(a,u._instance,16),t(null,u._container),delete u._container.__vue_app__)},provide(c,f){return i.provides[c]=f,u},runWithContext(c){const f=Ve;Ve=u;try{return c()}finally{Ve=f}}};return u}}let Ve=null;function Xn(t,e){if(yt){let n=yt.provides;const r=yt.parent&&yt.parent.provides;r===n&&(n=yt.provides=Object.create(r)),n[t]=e}}function ce(t,e,n=!1){const r=Yc();if(r||Ve){let s=Ve?Ve._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(s&&t in s)return s[t];if(arguments.length>1)return n&&V(e)?e.call(r&&r.proxy):e}}const Xo={},jo=()=>Object.create(Xo),Ko=t=>Object.getPrototypeOf(t)===Xo;function _c(t,e,n,r=!1){const s={},i=jo();t.propsDefaults=Object.create(null),qo(t,e,s,i);for(const o in t.propsOptions[0])o in s||(s[o]=void 0);n?t.props=r?s:Lo(s):t.type.props?t.props=s:t.props=i,t.attrs=i}function wc(t,e,n,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=t,a=j(s),[l]=t.propsOptions;let u=!1;if((r||o>0)&&!(o&16)){if(o&8){const c=t.vnode.dynamicProps;for(let f=0;f<c.length;f++){let h=c[f];if(Er(t.emitsOptions,h))continue;const d=e[h];if(l)if(K(i,h))d!==i[h]&&(i[h]=d,u=!0);else{const v=Bt(h);s[v]=is(l,a,v,d,t,!1)}else d!==i[h]&&(i[h]=d,u=!0)}}}else{qo(t,e,s,i)&&(u=!0);let c;for(const f in a)(!e||!K(e,f)&&((c=Ie(f))===f||!K(e,c)))&&(l?n&&(n[f]!==void 0||n[c]!==void 0)&&(s[f]=is(l,a,f,void 0,t,!0)):delete s[f]);if(i!==a)for(const f in i)(!e||!K(e,f))&&(delete i[f],u=!0)}u&&oe(t.attrs,"set","")}function qo(t,e,n,r){const[s,i]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(cn(l))continue;const u=e[l];let c;s&&K(s,c=Bt(l))?!i||!i.includes(c)?n[c]=u:(a||(a={}))[c]=u:Er(t.emitsOptions,l)||(!(l in r)||u!==r[l])&&(r[l]=u,o=!0)}if(i){const l=j(n),u=a||Q;for(let c=0;c<i.length;c++){const f=i[c];n[f]=is(s,l,f,u[f],t,!K(u,f))}}return o}function is(t,e,n,r,s,i){const o=t[n];if(o!=null){const a=K(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&V(l)){const{propsDefaults:u}=s;if(n in u)r=u[n];else{const c=kn(s);r=u[n]=l.call(null,e),c()}}else r=l;s.ce&&s.ce._setProp(n,r)}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===Ie(n))&&(r=!0))}return r}const xc=new WeakMap;function Zo(t,e,n=!1){const r=n?xc:e.propsCache,s=r.get(t);if(s)return s;const i=t.props,o={},a=[];let l=!1;if(!V(t)){const c=f=>{l=!0;const[h,d]=Zo(f,e,!0);wt(o,h),d&&a.push(...d)};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}if(!i&&!l)return nt(t)&&r.set(t,$e),$e;if(U(i))for(let c=0;c<i.length;c++){const f=Bt(i[c]);ii(f)&&(o[f]=Q)}else if(i)for(const c in i){const f=Bt(c);if(ii(f)){const h=i[c],d=o[f]=U(h)||V(h)?{type:h}:wt({},h),v=d.type;let y=!1,T=!0;if(U(v))for(let w=0;w<v.length;++w){const _=v[w],b=V(_)&&_.name;if(b==="Boolean"){y=!0;break}else b==="String"&&(T=!1)}else y=V(v)&&v.name==="Boolean";d[0]=y,d[1]=T,(y||K(d,"default"))&&a.push(f)}}const u=[o,a];return nt(t)&&r.set(t,u),u}function ii(t){return t[0]!=="$"&&!cn(t)}const Fs=t=>t==="_"||t==="__"||t==="_ctx"||t==="$stable",Ds=t=>U(t)?t.map(Kt):[Kt(t)],bc=(t,e,n)=>{if(e._n)return e;const r=Qr((...s)=>Ds(e(...s)),n);return r._c=!1,r},Jo=(t,e,n)=>{const r=t._ctx;for(const s in t){if(Fs(s))continue;const i=t[s];if(V(i))e[s]=bc(s,i,r);else if(i!=null){const o=Ds(i);e[s]=()=>o}}},Qo=(t,e)=>{const n=Ds(e);t.slots.default=()=>n},ta=(t,e,n)=>{for(const r in e)(n||!Fs(r))&&(t[r]=e[r])},Sc=(t,e,n)=>{const r=t.slots=jo();if(t.vnode.shapeFlag&32){const s=e.__;s&&jr(r,"__",s,!0);const i=e._;i?(ta(r,e,n),n&&jr(r,"_",i,!0)):Jo(e,r)}else e&&Qo(t,e)},Ac=(t,e,n)=>{const{vnode:r,slots:s}=t;let i=!0,o=Q;if(r.shapeFlag&32){const a=e._;a?n&&a===1?i=!1:ta(s,e,n):(i=!e.$stable,Jo(e,s)),o=e}else e&&(Qo(t,e),o={default:1});if(i)for(const a in s)!Fs(a)&&o[a]==null&&delete s[a]},Lt=Nc;function Ec(t){return Tc(t)}function Tc(t,e){const n=yr();n.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:l,setText:u,setElementText:c,parentNode:f,nextSibling:h,setScopeId:d=qt,insertStaticContent:v}=t,y=(p,m,g,S=null,C=null,E=null,P=void 0,L=null,O=!!m.dynamicChildren)=>{if(p===m)return;p&&!en(p,m)&&(S=A(p),Et(p,C,E,!0),p=null),m.patchFlag===-2&&(O=!1,m.dynamicChildren=null);const{type:R,ref:$,shapeFlag:F}=m;switch(R){case Tr:T(p,m,g,S);break;case Se:w(p,m,g,S);break;case Hr:p==null&&_(m,g,S,P);break;case Dt:xt(p,m,g,S,C,E,P,L,O);break;default:F&1?M(p,m,g,S,C,E,P,L,O):F&6?gt(p,m,g,S,C,E,P,L,O):(F&64||F&128)&&R.process(p,m,g,S,C,E,P,L,O,B)}$!=null&&C?hn($,p&&p.ref,E,m||p,!m):$==null&&p&&p.ref!=null&&hn(p.ref,null,E,p,!0)},T=(p,m,g,S)=>{if(p==null)r(m.el=a(m.children),g,S);else{const C=m.el=p.el;m.children!==p.children&&u(C,m.children)}},w=(p,m,g,S)=>{p==null?r(m.el=l(m.children||""),g,S):m.el=p.el},_=(p,m,g,S)=>{[p.el,p.anchor]=v(p.children,m,g,S,p.el,p.anchor)},b=({el:p,anchor:m},g,S)=>{let C;for(;p&&p!==m;)C=h(p),r(p,g,S),p=C;r(m,g,S)},x=({el:p,anchor:m})=>{let g;for(;p&&p!==m;)g=h(p),s(p),p=g;s(m)},M=(p,m,g,S,C,E,P,L,O)=>{m.type==="svg"?P="svg":m.type==="math"&&(P="mathml"),p==null?k(m,g,S,C,E,P,L,O):ft(p,m,C,E,P,L,O)},k=(p,m,g,S,C,E,P,L)=>{let O,R;const{props:$,shapeFlag:F,transition:H,dirs:z}=p;if(O=p.el=o(p.type,E,$&&$.is,$),F&8?c(O,p.children):F&16&&st(p.children,O,null,S,C,Nr(p,E),P,L),z&&Ee(p,null,S,"created"),W(O,p,p.scopeId,P,S),$){for(const tt in $)tt!=="value"&&!cn(tt)&&i(O,tt,null,$[tt],E,S);"value"in $&&i(O,"value",null,$.value,E),(R=$.onVnodeBeforeMount)&&Xt(R,S,p)}z&&Ee(p,null,S,"beforeMount");const G=Cc(C,H);G&&H.beforeEnter(O),r(O,m,g),((R=$&&$.onVnodeMounted)||G||z)&&Lt(()=>{R&&Xt(R,S,p),G&&H.enter(O),z&&Ee(p,null,S,"mounted")},C)},W=(p,m,g,S,C)=>{if(g&&d(p,g),S)for(let E=0;E<S.length;E++)d(p,S[E]);if(C){let E=C.subTree;if(m===E||oa(E.type)&&(E.ssContent===m||E.ssFallback===m)){const P=C.vnode;W(p,P,P.scopeId,P.slotScopeIds,C.parent)}}},st=(p,m,g,S,C,E,P,L,O=0)=>{for(let R=O;R<p.length;R++){const $=p[R]=L?ve(p[R]):Kt(p[R]);y(null,$,m,g,S,C,E,P,L)}},ft=(p,m,g,S,C,E,P)=>{const L=m.el=p.el;let{patchFlag:O,dynamicChildren:R,dirs:$}=m;O|=p.patchFlag&16;const F=p.props||Q,H=m.props||Q;let z;if(g&&Te(g,!1),(z=H.onVnodeBeforeUpdate)&&Xt(z,g,m,p),$&&Ee(m,p,g,"beforeUpdate"),g&&Te(g,!0),(F.innerHTML&&H.innerHTML==null||F.textContent&&H.textContent==null)&&c(L,""),R?lt(p.dynamicChildren,R,L,g,S,Nr(m,C),E):P||Y(p,m,L,null,g,S,Nr(m,C),E,!1),O>0){if(O&16)mt(L,F,H,g,C);else if(O&2&&F.class!==H.class&&i(L,"class",null,H.class,C),O&4&&i(L,"style",F.style,H.style,C),O&8){const G=m.dynamicProps;for(let tt=0;tt<G.length;tt++){const q=G[tt],Tt=F[q],Ct=H[q];(Ct!==Tt||q==="value")&&i(L,q,Tt,Ct,C,g)}}O&1&&p.children!==m.children&&c(L,m.children)}else!P&&R==null&&mt(L,F,H,g,C);((z=H.onVnodeUpdated)||$)&&Lt(()=>{z&&Xt(z,g,m,p),$&&Ee(m,p,g,"updated")},S)},lt=(p,m,g,S,C,E,P)=>{for(let L=0;L<m.length;L++){const O=p[L],R=m[L],$=O.el&&(O.type===Dt||!en(O,R)||O.shapeFlag&198)?f(O.el):g;y(O,R,$,null,S,C,E,P,!0)}},mt=(p,m,g,S,C)=>{if(m!==g){if(m!==Q)for(const E in m)!cn(E)&&!(E in g)&&i(p,E,m[E],null,C,S);for(const E in g){if(cn(E))continue;const P=g[E],L=m[E];P!==L&&E!=="value"&&i(p,E,L,P,C,S)}"value"in g&&i(p,"value",m.value,g.value,C)}},xt=(p,m,g,S,C,E,P,L,O)=>{const R=m.el=p?p.el:a(""),$=m.anchor=p?p.anchor:a("");let{patchFlag:F,dynamicChildren:H,slotScopeIds:z}=m;z&&(L=L?L.concat(z):z),p==null?(r(R,g,S),r($,g,S),st(m.children||[],g,$,C,E,P,L,O)):F>0&&F&64&&H&&p.dynamicChildren?(lt(p.dynamicChildren,H,g,C,E,P,L),(m.key!=null||C&&m===C.subTree)&&ea(p,m,!0)):Y(p,m,g,$,C,E,P,L,O)},gt=(p,m,g,S,C,E,P,L,O)=>{m.slotScopeIds=L,p==null?m.shapeFlag&512?C.ctx.activate(m,g,S,P,O):rt(m,g,S,C,E,P,O):Fe(p,m,O)},rt=(p,m,g,S,C,E,P)=>{const L=p.component=Gc(p,S,C);if(Uo(p)&&(L.ctx.renderer=B),Xc(L,!1,P),L.asyncDep){if(C&&C.registerDep(L,ut,P),!p.el){const O=L.subTree=ot(Se);w(null,O,m,g),p.placeholder=O.el}}else ut(L,p,m,g,C,E,P)},Fe=(p,m,g)=>{const S=m.component=p.component;if(kc(p,m,g))if(S.asyncDep&&!S.asyncResolved){Z(S,m,g);return}else S.next=m,S.update();else m.el=p.el,S.vnode=m},ut=(p,m,g,S,C,E,P)=>{const L=()=>{if(p.isMounted){let{next:F,bu:H,u:z,parent:G,vnode:tt}=p;{const Gt=na(p);if(Gt){F&&(F.el=tt.el,Z(p,F,P)),Gt.asyncDep.then(()=>{p.isUnmounted||L()});return}}let q=F,Tt;Te(p,!1),F?(F.el=tt.el,Z(p,F,P)):F=tt,H&&Yn(H),(Tt=F.props&&F.props.onVnodeBeforeUpdate)&&Xt(Tt,G,F,tt),Te(p,!0);const Ct=ai(p),Vt=p.subTree;p.subTree=Ct,y(Vt,Ct,f(Vt.el),A(Vt),p,C,E),F.el=Ct.el,q===null&&Bc(p,Ct.el),z&&Lt(z,C),(Tt=F.props&&F.props.onVnodeUpdated)&&Lt(()=>Xt(Tt,G,F,tt),C)}else{let F;const{el:H,props:z}=m,{bm:G,m:tt,parent:q,root:Tt,type:Ct}=p,Vt=dn(m);Te(p,!1),G&&Yn(G),!Vt&&(F=z&&z.onVnodeBeforeMount)&&Xt(F,q,m),Te(p,!0);{Tt.ce&&Tt.ce._def.shadowRoot!==!1&&Tt.ce._injectChildStyle(Ct);const Gt=p.subTree=ai(p);y(null,Gt,g,S,p,C,E),m.el=Gt.el}if(tt&&Lt(tt,C),!Vt&&(F=z&&z.onVnodeMounted)){const Gt=m;Lt(()=>Xt(F,q,Gt),C)}(m.shapeFlag&256||q&&dn(q.vnode)&&q.vnode.shapeFlag&256)&&p.a&&Lt(p.a,C),p.isMounted=!0,m=g=S=null}};p.scope.on();const O=p.effect=new vo(L);p.scope.off();const R=p.update=O.run.bind(O),$=p.job=O.runIfDirty.bind(O);$.i=p,$.id=p.uid,O.scheduler=()=>Ps($),Te(p,!0),R()},Z=(p,m,g)=>{m.component=p;const S=p.vnode.props;p.vnode=m,p.next=null,wc(p,m.props,S,g),Ac(p,m.children,g),ue(),Js(p),fe()},Y=(p,m,g,S,C,E,P,L,O=!1)=>{const R=p&&p.children,$=p?p.shapeFlag:0,F=m.children,{patchFlag:H,shapeFlag:z}=m;if(H>0){if(H&128){pe(R,F,g,S,C,E,P,L,O);return}else if(H&256){ee(R,F,g,S,C,E,P,L,O);return}}z&8?($&16&&Ft(R,C,E),F!==R&&c(g,F)):$&16?z&16?pe(R,F,g,S,C,E,P,L,O):Ft(R,C,E,!0):($&8&&c(g,""),z&16&&st(F,g,S,C,E,P,L,O))},ee=(p,m,g,S,C,E,P,L,O)=>{p=p||$e,m=m||$e;const R=p.length,$=m.length,F=Math.min(R,$);let H;for(H=0;H<F;H++){const z=m[H]=O?ve(m[H]):Kt(m[H]);y(p[H],z,g,null,C,E,P,L,O)}R>$?Ft(p,C,E,!0,!1,F):st(m,g,S,C,E,P,L,O,F)},pe=(p,m,g,S,C,E,P,L,O)=>{let R=0;const $=m.length;let F=p.length-1,H=$-1;for(;R<=F&&R<=H;){const z=p[R],G=m[R]=O?ve(m[R]):Kt(m[R]);if(en(z,G))y(z,G,g,null,C,E,P,L,O);else break;R++}for(;R<=F&&R<=H;){const z=p[F],G=m[H]=O?ve(m[H]):Kt(m[H]);if(en(z,G))y(z,G,g,null,C,E,P,L,O);else break;F--,H--}if(R>F){if(R<=H){const z=H+1,G=z<$?m[z].el:S;for(;R<=H;)y(null,m[R]=O?ve(m[R]):Kt(m[R]),g,G,C,E,P,L,O),R++}}else if(R>H)for(;R<=F;)Et(p[R],C,E,!0),R++;else{const z=R,G=R,tt=new Map;for(R=G;R<=H;R++){const Ot=m[R]=O?ve(m[R]):Kt(m[R]);Ot.key!=null&&tt.set(Ot.key,R)}let q,Tt=0;const Ct=H-G+1;let Vt=!1,Gt=0;const Qe=new Array(Ct);for(R=0;R<Ct;R++)Qe[R]=0;for(R=z;R<=F;R++){const Ot=p[R];if(Tt>=Ct){Et(Ot,C,E,!0);continue}let Yt;if(Ot.key!=null)Yt=tt.get(Ot.key);else for(q=G;q<=H;q++)if(Qe[q-G]===0&&en(Ot,m[q])){Yt=q;break}Yt===void 0?Et(Ot,C,E,!0):(Qe[Yt-G]=R+1,Yt>=Gt?Gt=Yt:Vt=!0,y(Ot,m[Yt],g,null,C,E,P,L,O),Tt++)}const Gs=Vt?Rc(Qe):$e;for(q=Gs.length-1,R=Ct-1;R>=0;R--){const Ot=G+R,Yt=m[Ot],Ys=m[Ot+1],Xs=Ot+1<$?Ys.el||Ys.placeholder:S;Qe[R]===0?y(null,Yt,g,Xs,C,E,P,L,O):Vt&&(q<0||R!==Gs[q]?zt(Yt,g,Xs,2):q--)}}},zt=(p,m,g,S,C=null)=>{const{el:E,type:P,transition:L,children:O,shapeFlag:R}=p;if(R&6){zt(p.component.subTree,m,g,S);return}if(R&128){p.suspense.move(m,g,S);return}if(R&64){P.move(p,m,g,B);return}if(P===Dt){r(E,m,g);for(let F=0;F<O.length;F++)zt(O[F],m,g,S);r(p.anchor,m,g);return}if(P===Hr){b(p,m,g);return}if(S!==2&&R&1&&L)if(S===0)L.beforeEnter(E),r(E,m,g),Lt(()=>L.enter(E),C);else{const{leave:F,delayLeave:H,afterLeave:z}=L,G=()=>{p.ctx.isUnmounted?s(E):r(E,m,g)},tt=()=>{F(E,()=>{G(),z&&z()})};H?H(E,G,tt):tt()}else r(E,m,g)},Et=(p,m,g,S=!1,C=!1)=>{const{type:E,props:P,ref:L,children:O,dynamicChildren:R,shapeFlag:$,patchFlag:F,dirs:H,cacheIndex:z}=p;if(F===-2&&(C=!1),L!=null&&(ue(),hn(L,null,g,p,!0),fe()),z!=null&&(m.renderCache[z]=void 0),$&256){m.ctx.deactivate(p);return}const G=$&1&&H,tt=!dn(p);let q;if(tt&&(q=P&&P.onVnodeBeforeUnmount)&&Xt(q,m,p),$&6)Hn(p.component,g,S);else{if($&128){p.suspense.unmount(g,S);return}G&&Ee(p,null,m,"beforeUnmount"),$&64?p.type.remove(p,m,g,B,S):R&&!R.hasOnce&&(E!==Dt||F>0&&F&64)?Ft(R,m,g,!1,!0):(E===Dt&&F&384||!C&&$&16)&&Ft(O,m,g),S&&De(p)}(tt&&(q=P&&P.onVnodeUnmounted)||G)&&Lt(()=>{q&&Xt(q,m,p),G&&Ee(p,null,m,"unmounted")},g)},De=p=>{const{type:m,el:g,anchor:S,transition:C}=p;if(m===Dt){ke(g,S);return}if(m===Hr){x(p);return}const E=()=>{s(g),C&&!C.persisted&&C.afterLeave&&C.afterLeave()};if(p.shapeFlag&1&&C&&!C.persisted){const{leave:P,delayLeave:L}=C,O=()=>P(g,E);L?L(p.el,E,O):O()}else E()},ke=(p,m)=>{let g;for(;p!==m;)g=h(p),s(p),p=g;s(m)},Hn=(p,m,g)=>{const{bum:S,scope:C,job:E,subTree:P,um:L,m:O,a:R,parent:$,slots:{__:F}}=p;oi(O),oi(R),S&&Yn(S),$&&U(F)&&F.forEach(H=>{$.renderCache[H]=void 0}),C.stop(),E&&(E.flags|=8,Et(P,p,m,g)),L&&Lt(L,m),Lt(()=>{p.isUnmounted=!0},m),m&&m.pendingBranch&&!m.isUnmounted&&p.asyncDep&&!p.asyncResolved&&p.suspenseId===m.pendingId&&(m.deps--,m.deps===0&&m.resolve())},Ft=(p,m,g,S=!1,C=!1,E=0)=>{for(let P=E;P<p.length;P++)Et(p[P],m,g,S,C)},A=p=>{if(p.shapeFlag&6)return A(p.component.subTree);if(p.shapeFlag&128)return p.suspense.next();const m=h(p.anchor||p.el),g=m&&m[Kl];return g?h(g):m};let D=!1;const I=(p,m,g)=>{p==null?m._vnode&&Et(m._vnode,null,null,!0):y(m._vnode||null,p,m,null,null,null,g),m._vnode=p,D||(D=!0,Js(),Bo(),D=!1)},B={p:y,um:Et,m:zt,r:De,mt:rt,mc:st,pc:Y,pbc:lt,n:A,o:t};return{render:I,hydrate:void 0,createApp:yc(I)}}function Nr({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Te({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Cc(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function ea(t,e,n=!1){const r=t.children,s=e.children;if(U(r)&&U(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=ve(s[i]),a.el=o.el),!n&&a.patchFlag!==-2&&ea(o,a)),a.type===Tr&&(a.el=o.el),a.type===Se&&!a.el&&(a.el=o.el)}}function Rc(t){const e=t.slice(),n=[0];let r,s,i,o,a;const l=t.length;for(r=0;r<l;r++){const u=t[r];if(u!==0){if(s=n[n.length-1],t[s]<u){e[r]=s,n.push(r);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,t[n[a]]<u?i=a+1:o=a;u<t[n[i]]&&(i>0&&(e[r]=n[i-1]),n[i]=r)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}function na(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:na(e)}function oi(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const Mc=Symbol.for("v-scx"),Oc=()=>ce(Mc);function mn(t,e,n){return ra(t,e,n)}function ra(t,e,n=Q){const{immediate:r,deep:s,flush:i,once:o}=n,a=wt({},n),l=e&&r||!e&&i!=="post";let u;if(En){if(i==="sync"){const d=Oc();u=d.__watcherHandles||(d.__watcherHandles=[])}else if(!l){const d=()=>{};return d.stop=qt,d.resume=qt,d.pause=qt,d}}const c=yt;a.call=(d,v,y)=>Qt(d,c,v,y);let f=!1;i==="post"?a.scheduler=d=>{Lt(d,c&&c.suspense)}:i!=="sync"&&(f=!0,a.scheduler=(d,v)=>{v?d():Ps(d)}),a.augmentJob=d=>{e&&(d.flags|=4),f&&(d.flags|=2,c&&(d.id=c.uid,d.i=c))};const h=Gl(t,e,a);return En&&(u?u.push(h):l&&h()),h}function Lc(t,e,n){const r=this.proxy,s=at(t)?t.includes(".")?sa(r,t):()=>r[t]:t.bind(r,r);let i;V(e)?i=e:(i=e.handler,n=e);const o=kn(this),a=ra(s,i.bind(r),n);return o(),a}function sa(t,e){const n=e.split(".");return()=>{let r=t;for(let s=0;s<n.length&&r;s++)r=r[n[s]];return r}}const Pc=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${Bt(e)}Modifiers`]||t[`${Ie(e)}Modifiers`];function Ic(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||Q;let s=n;const i=e.startsWith("update:"),o=i&&Pc(r,e.slice(7));o&&(o.trim&&(s=n.map(c=>at(c)?c.trim():c)),o.number&&(s=n.map(ho)));let a,l=r[a=Pr(e)]||r[a=Pr(Bt(e))];!l&&i&&(l=r[a=Pr(Ie(e))]),l&&Qt(l,t,6,s);const u=r[a+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Qt(u,t,6,s)}}function ia(t,e,n=!1){const r=e.emitsCache,s=r.get(t);if(s!==void 0)return s;const i=t.emits;let o={},a=!1;if(!V(t)){const l=u=>{const c=ia(u,e,!0);c&&(a=!0,wt(o,c))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!i&&!a?(nt(t)&&r.set(t,null),null):(U(i)?i.forEach(l=>o[l]=null):wt(o,i),nt(t)&&r.set(t,o),o)}function Er(t,e){return!t||!pr(e)?!1:(e=e.slice(2).replace(/Once$/,""),K(t,e[0].toLowerCase()+e.slice(1))||K(t,Ie(e))||K(t,e))}function ai(t){const{type:e,vnode:n,proxy:r,withProxy:s,propsOptions:[i],slots:o,attrs:a,emit:l,render:u,renderCache:c,props:f,data:h,setupState:d,ctx:v,inheritAttrs:y}=t,T=nr(t);let w,_;try{if(n.shapeFlag&4){const x=s||r,M=x;w=Kt(u.call(M,x,c,f,d,h,v)),_=a}else{const x=e;w=Kt(x.length>1?x(f,{attrs:a,slots:o,emit:l}):x(f,null)),_=e.props?a:Fc(a)}}catch(x){gn.length=0,xr(x,t,1),w=ot(Se)}let b=w;if(_&&y!==!1){const x=Object.keys(_),{shapeFlag:M}=b;x.length&&M&7&&(i&&x.some(xs)&&(_=Dc(_,i)),b=Ye(b,_,!1,!0))}return n.dirs&&(b=Ye(b,null,!1,!0),b.dirs=b.dirs?b.dirs.concat(n.dirs):n.dirs),n.transition&&Is(b,n.transition),w=b,nr(T),w}const Fc=t=>{let e;for(const n in t)(n==="class"||n==="style"||pr(n))&&((e||(e={}))[n]=t[n]);return e},Dc=(t,e)=>{const n={};for(const r in t)(!xs(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function kc(t,e,n){const{props:r,children:s,component:i}=t,{props:o,children:a,patchFlag:l}=e,u=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return r?li(r,o,u):!!o;if(l&8){const c=e.dynamicProps;for(let f=0;f<c.length;f++){const h=c[f];if(o[h]!==r[h]&&!Er(u,h))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?li(r,o,u):!0:!!o;return!1}function li(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==t[i]&&!Er(n,i))return!0}return!1}function Bc({vnode:t,parent:e},n){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===t&&(r.el=t.el),r===t)(t=e.vnode).el=n,e=e.parent;else break}}const oa=t=>t.__isSuspense;function Nc(t,e){e&&e.pendingBranch?U(t)?e.effects.push(...t):e.effects.push(t):jl(t)}const Dt=Symbol.for("v-fgt"),Tr=Symbol.for("v-txt"),Se=Symbol.for("v-cmt"),Hr=Symbol.for("v-stc"),gn=[];let It=null;function ct(t=!1){gn.push(It=t?null:[])}function Hc(){gn.pop(),It=gn[gn.length-1]||null}let Sn=1;function ci(t,e=!1){Sn+=t,t<0&&It&&e&&(It.hasOnce=!0)}function aa(t){return t.dynamicChildren=Sn>0?It||$e:null,Hc(),Sn>0&&It&&It.push(t),t}function pt(t,e,n,r,s,i){return aa(N(t,e,n,r,s,i,!0))}function la(t,e,n,r,s){return aa(ot(t,e,n,r,s,!0))}function sr(t){return t?t.__v_isVNode===!0:!1}function en(t,e){return t.type===e.type&&t.key===e.key}const ca=({key:t})=>t??null,jn=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?at(t)||_t(t)||V(t)?{i:Pt,r:t,k:e,f:!!n}:t:null);function N(t,e=null,n=null,r=0,s=null,i=t===Dt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&ca(e),ref:e&&jn(e),scopeId:Ho,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Pt};return a?(ks(l,n),i&128&&t.normalize(l)):n&&(l.shapeFlag|=at(n)?8:16),Sn>0&&!o&&It&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&It.push(l),l}const ot=$c;function $c(t,e=null,n=null,r=0,s=null,i=!1){if((!t||t===cc)&&(t=Se),sr(t)){const a=Ye(t,e,!0);return n&&ks(a,n),Sn>0&&!i&&It&&(a.shapeFlag&6?It[It.indexOf(t)]=a:It.push(a)),a.patchFlag=-2,a}if(Jc(t)&&(t=t.__vccOpts),e){e=Wc(e);let{class:a,style:l}=e;a&&!at(a)&&(e.class=_n(a)),nt(l)&&(Ls(l)&&!U(l)&&(l=wt({},l)),e.style=As(l))}const o=at(t)?1:oa(t)?128:ql(t)?64:nt(t)?4:V(t)?2:0;return N(t,e,n,r,s,o,i,!0)}function Wc(t){return t?Ls(t)||Ko(t)?wt({},t):t:null}function Ye(t,e,n=!1,r=!1){const{props:s,ref:i,patchFlag:o,children:a,transition:l}=t,u=e?Uc(s||{},e):s,c={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&ca(u),ref:e&&e.ref?n&&i?U(i)?i.concat(jn(e)):[i,jn(e)]:jn(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Dt?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Ye(t.ssContent),ssFallback:t.ssFallback&&Ye(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&r&&Is(c,l.clone(c)),c}function An(t=" ",e=0){return ot(Tr,null,t,e)}function Xe(t="",e=!1){return e?(ct(),la(Se,null,t)):ot(Se,null,t)}function Kt(t){return t==null||typeof t=="boolean"?ot(Se):U(t)?ot(Dt,null,t.slice()):sr(t)?ve(t):ot(Tr,null,String(t))}function ve(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Ye(t)}function ks(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(U(e))n=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),ks(t,s()),s._c&&(s._d=!0));return}else{n=32;const s=e._;!s&&!Ko(e)?e._ctx=Pt:s===3&&Pt&&(Pt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else V(e)?(e={default:e,_ctx:Pt},n=32):(e=String(e),r&64?(n=16,e=[An(e)]):n=8);t.children=e,t.shapeFlag|=n}function Uc(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=_n([e.class,r.class]));else if(s==="style")e.style=As([e.style,r.style]);else if(pr(s)){const i=e[s],o=r[s];o&&i!==o&&!(U(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function Xt(t,e,n,r=null){Qt(t,e,7,[n,r])}const zc=Yo();let Vc=0;function Gc(t,e,n){const r=t.type,s=(e?e.appContext:t.appContext)||zc,i={uid:Vc++,vnode:t,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new yl(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Zo(r,s),emitsOptions:ia(r,s),emit:null,emitted:null,propsDefaults:Q,inheritAttrs:r.inheritAttrs,ctx:Q,data:Q,props:Q,attrs:Q,slots:Q,refs:Q,setupState:Q,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=Ic.bind(null,i),t.ce&&t.ce(i),i}let yt=null;const Yc=()=>yt||Pt;let ir,os;{const t=yr(),e=(n,r)=>{let s;return(s=t[n])||(s=t[n]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};ir=e("__VUE_INSTANCE_SETTERS__",n=>yt=n),os=e("__VUE_SSR_SETTERS__",n=>En=n)}const kn=t=>{const e=yt;return ir(t),t.scope.on(),()=>{t.scope.off(),ir(e)}},ui=()=>{yt&&yt.scope.off(),ir(null)};function ua(t){return t.vnode.shapeFlag&4}let En=!1;function Xc(t,e=!1,n=!1){e&&os(e);const{props:r,children:s}=t.vnode,i=ua(t);_c(t,r,i,e),Sc(t,s,n||e);const o=i?jc(t,e):void 0;return e&&os(!1),o}function jc(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,fc);const{setup:r}=n;if(r){ue();const s=t.setupContext=r.length>1?qc(t):null,i=kn(t),o=Fn(r,t,0,[t.props,s]),a=co(o);if(fe(),i(),(a||t.sp)&&!dn(t)&&Wo(t),a){if(o.then(ui,ui),e)return o.then(l=>{fi(t,l)}).catch(l=>{xr(l,t,0)});t.asyncDep=o}else fi(t,o)}else fa(t)}function fi(t,e,n){V(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:nt(e)&&(t.setupState=Fo(e)),fa(t)}function fa(t,e,n){const r=t.type;t.render||(t.render=r.render||qt);{const s=kn(t);ue();try{hc(t)}finally{fe(),s()}}}const Kc={get(t,e){return vt(t,"get",""),t[e]}};function qc(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,Kc),slots:t.slots,emit:t.emit,expose:e}}function Cr(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Fo(Nl(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in pn)return pn[n](t)},has(e,n){return n in e||n in pn}})):t.proxy}function Zc(t,e=!0){return V(t)?t.displayName||t.name:t.name||e&&t.__name}function Jc(t){return V(t)&&"__vccOpts"in t}const At=(t,e)=>zl(t,e,En);function ha(t,e,n){const r=arguments.length;return r===2?nt(e)&&!U(e)?sr(e)?ot(t,null,[e]):ot(t,e):ot(t,null,e):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&sr(n)&&(n=[n]),ot(t,e,n))}const Qc="3.5.18";/**
* @vue/runtime-dom v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let as;const hi=typeof window<"u"&&window.trustedTypes;if(hi)try{as=hi.createPolicy("vue",{createHTML:t=>t})}catch{}const da=as?t=>as.createHTML(t):t=>t,tu="http://www.w3.org/2000/svg",eu="http://www.w3.org/1998/Math/MathML",ie=typeof document<"u"?document:null,di=ie&&ie.createElement("template"),nu={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const s=e==="svg"?ie.createElementNS(tu,t):e==="mathml"?ie.createElementNS(eu,t):n?ie.createElement(t,{is:n}):ie.createElement(t);return t==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:t=>ie.createTextNode(t),createComment:t=>ie.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>ie.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,r,s,i){const o=n?n.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),n),!(s===i||!(s=s.nextSibling)););else{di.innerHTML=da(r==="svg"?`<svg>${t}</svg>`:r==="mathml"?`<math>${t}</math>`:t);const a=di.content;if(r==="svg"||r==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},ru=Symbol("_vtc");function su(t,e,n){const r=t[ru];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const pi=Symbol("_vod"),iu=Symbol("_vsh"),ou=Symbol(""),au=/(^|;)\s*display\s*:/;function lu(t,e,n){const r=t.style,s=at(n);let i=!1;if(n&&!s){if(e)if(at(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&Kn(r,a,"")}else for(const o in e)n[o]==null&&Kn(r,o,"");for(const o in n)o==="display"&&(i=!0),Kn(r,o,n[o])}else if(s){if(e!==n){const o=r[ou];o&&(n+=";"+o),r.cssText=n,i=au.test(n)}}else e&&t.removeAttribute("style");pi in t&&(t[pi]=i?r.display:"",t[iu]&&(r.display="none"))}const mi=/\s*!important$/;function Kn(t,e,n){if(U(n))n.forEach(r=>Kn(t,e,r));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=cu(t,e);mi.test(n)?t.setProperty(Ie(r),n.replace(mi,""),"important"):t[r]=n}}const gi=["Webkit","Moz","ms"],$r={};function cu(t,e){const n=$r[e];if(n)return n;let r=Bt(e);if(r!=="filter"&&r in t)return $r[e]=r;r=vr(r);for(let s=0;s<gi.length;s++){const i=gi[s]+r;if(i in t)return $r[e]=i}return e}const vi="http://www.w3.org/1999/xlink";function yi(t,e,n,r,s,i=ml(e)){r&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(vi,e.slice(6,e.length)):t.setAttributeNS(vi,e,n):n==null||i&&!po(n)?t.removeAttribute(e):t.setAttribute(e,i?"":Jt(n)?String(n):n)}function _i(t,e,n,r,s){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?da(n):n);return}const i=t.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?t.getAttribute("value")||"":t.value,l=n==null?t.type==="checkbox"?"on":"":String(n);(a!==l||!("_value"in t))&&(t.value=l),n==null&&t.removeAttribute(e),t._value=n;return}let o=!1;if(n===""||n==null){const a=typeof t[e];a==="boolean"?n=po(n):n==null&&a==="string"?(n="",o=!0):a==="number"&&(n=0,o=!0)}try{t[e]=n}catch{}o&&t.removeAttribute(s||e)}function pa(t,e,n,r){t.addEventListener(e,n,r)}function uu(t,e,n,r){t.removeEventListener(e,n,r)}const wi=Symbol("_vei");function fu(t,e,n,r,s=null){const i=t[wi]||(t[wi]={}),o=i[e];if(r&&o)o.value=r;else{const[a,l]=hu(e);if(r){const u=i[e]=mu(r,s);pa(t,a,u,l)}else o&&(uu(t,a,o,l),i[e]=void 0)}}const xi=/(?:Once|Passive|Capture)$/;function hu(t){let e;if(xi.test(t)){e={};let r;for(;r=t.match(xi);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Ie(t.slice(2)),e]}let Wr=0;const du=Promise.resolve(),pu=()=>Wr||(du.then(()=>Wr=0),Wr=Date.now());function mu(t,e){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;Qt(gu(r,n.value),e,5,[r])};return n.value=t,n.attached=pu(),n}function gu(t,e){if(U(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const bi=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,vu=(t,e,n,r,s,i)=>{const o=s==="svg";e==="class"?su(t,r,o):e==="style"?lu(t,n,r):pr(e)?xs(e)||fu(t,e,n,r,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):yu(t,e,r,o))?(_i(t,e,r),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&yi(t,e,r,o,i,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!at(r))?_i(t,Bt(e),r,i,e):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),yi(t,e,r,o))};function yu(t,e,n,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in t&&bi(e)&&V(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=t.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return bi(e)&&at(n)?!1:e in t}const Si=t=>{const e=t.props["onUpdate:modelValue"]||!1;return U(e)?n=>Yn(e,n):e},Ur=Symbol("_assign"),ls={deep:!0,created(t,{value:e,modifiers:{number:n}},r){const s=mr(e);pa(t,"change",()=>{const i=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?ho(or(o)):or(o));t[Ur](t.multiple?s?new Set(i):i:i[0]),t._assigning=!0,Dn(()=>{t._assigning=!1})}),t[Ur]=Si(r)},mounted(t,{value:e}){Ai(t,e)},beforeUpdate(t,e,n){t[Ur]=Si(n)},updated(t,{value:e}){t._assigning||Ai(t,e)}};function Ai(t,e){const n=t.multiple,r=U(e);if(!(n&&!r&&!mr(e))){for(let s=0,i=t.options.length;s<i;s++){const o=t.options[s],a=or(o);if(n)if(r){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(u=>String(u)===String(a)):o.selected=vl(e,a)>-1}else o.selected=e.has(a);else if(_r(or(o),e)){t.selectedIndex!==s&&(t.selectedIndex=s);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function or(t){return"_value"in t?t._value:t.value}const _u=wt({patchProp:vu},nu);let Ei;function wu(){return Ei||(Ei=Ec(_u))}const xu=(...t)=>{const e=wu().createApp(...t),{mount:n}=e;return e.mount=r=>{const s=Su(r);if(!s)return;const i=e._component;!V(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=n(s,!1,bu(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function bu(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Su(t){return at(t)?document.querySelector(t):t}const Je=(t,e)=>{const n=t.__vccOpts||t;for(const[r,s]of e)n[r]=s;return n},Au={id:"app"},Eu={class:"view-navigation"},Tu={class:"main-content"},Cu={__name:"App",setup(t){return(e,n)=>{const r=Qs("router-link"),s=Qs("router-view");return ct(),pt("div",Au,[N("nav",Eu,[ot(r,{to:"/lmem",class:_n(["nav-link",{active:e.$route.name==="lmem"}])},{default:Qr(()=>n[0]||(n[0]=[An(" LMEM 可视化 ",-1)])),_:1,__:[0]},8,["class"]),ot(r,{to:"/timestep",class:_n(["nav-link",{active:e.$route.name==="timestep"}])},{default:Qr(()=>n[1]||(n[1]=[An(" Timestep 可视化 ",-1)])),_:1,__:[1]},8,["class"])]),N("main",Tu,[ot(s)])])}}},Ru=Je(Cu,[["__scopeId","data-v-d174690f"]]);/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const He=typeof document<"u";function ma(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function Mu(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&ma(t.default)}const X=Object.assign;function zr(t,e){const n={};for(const r in e){const s=e[r];n[r]=$t(s)?s.map(t):t(s)}return n}const vn=()=>{},$t=Array.isArray,ga=/#/g,Ou=/&/g,Lu=/\//g,Pu=/=/g,Iu=/\?/g,va=/\+/g,Fu=/%5B/g,Du=/%5D/g,ya=/%5E/g,ku=/%60/g,_a=/%7B/g,Bu=/%7C/g,wa=/%7D/g,Nu=/%20/g;function Bs(t){return encodeURI(""+t).replace(Bu,"|").replace(Fu,"[").replace(Du,"]")}function Hu(t){return Bs(t).replace(_a,"{").replace(wa,"}").replace(ya,"^")}function cs(t){return Bs(t).replace(va,"%2B").replace(Nu,"+").replace(ga,"%23").replace(Ou,"%26").replace(ku,"`").replace(_a,"{").replace(wa,"}").replace(ya,"^")}function $u(t){return cs(t).replace(Pu,"%3D")}function Wu(t){return Bs(t).replace(ga,"%23").replace(Iu,"%3F")}function Uu(t){return t==null?"":Wu(t).replace(Lu,"%2F")}function Tn(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const zu=/\/$/,Vu=t=>t.replace(zu,"");function Vr(t,e,n="/"){let r,s={},i="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(r=e.slice(0,l),i=e.slice(l+1,a>-1?a:e.length),s=t(i)),a>-1&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=ju(r??e,n),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:Tn(o)}}function Gu(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function Ti(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function Yu(t,e,n){const r=e.matched.length-1,s=n.matched.length-1;return r>-1&&r===s&&je(e.matched[r],n.matched[s])&&xa(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function je(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function xa(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!Xu(t[n],e[n]))return!1;return!0}function Xu(t,e){return $t(t)?Ci(t,e):$t(e)?Ci(e,t):t===e}function Ci(t,e){return $t(e)?t.length===e.length&&t.every((n,r)=>n===e[r]):t.length===1&&t[0]===e}function ju(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),r=t.split("/"),s=r[r.length-1];(s===".."||s===".")&&r.push("");let i=n.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")i>1&&i--;else break;return n.slice(0,i).join("/")+"/"+r.slice(o).join("/")}const me={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Cn;(function(t){t.pop="pop",t.push="push"})(Cn||(Cn={}));var yn;(function(t){t.back="back",t.forward="forward",t.unknown=""})(yn||(yn={}));function Ku(t){if(!t)if(He){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),Vu(t)}const qu=/^[^#]+#/;function Zu(t,e){return t.replace(qu,"#")+e}function Ju(t,e){const n=document.documentElement.getBoundingClientRect(),r=t.getBoundingClientRect();return{behavior:e.behavior,left:r.left-n.left-(e.left||0),top:r.top-n.top-(e.top||0)}}const Rr=()=>({left:window.scrollX,top:window.scrollY});function Qu(t){let e;if("el"in t){const n=t.el,r=typeof n=="string"&&n.startsWith("#"),s=typeof n=="string"?r?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!s)return;e=Ju(s,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function Ri(t,e){return(history.state?history.state.position-e:-1)+t}const us=new Map;function tf(t,e){us.set(t,e)}function ef(t){const e=us.get(t);return us.delete(t),e}let nf=()=>location.protocol+"//"+location.host;function ba(t,e){const{pathname:n,search:r,hash:s}=e,i=t.indexOf("#");if(i>-1){let a=s.includes(t.slice(i))?t.slice(i).length:1,l=s.slice(a);return l[0]!=="/"&&(l="/"+l),Ti(l,"")}return Ti(n,t)+r+s}function rf(t,e,n,r){let s=[],i=[],o=null;const a=({state:h})=>{const d=ba(t,location),v=n.value,y=e.value;let T=0;if(h){if(n.value=d,e.value=h,o&&o===v){o=null;return}T=y?h.position-y.position:0}else r(d);s.forEach(w=>{w(n.value,v,{delta:T,type:Cn.pop,direction:T?T>0?yn.forward:yn.back:yn.unknown})})};function l(){o=n.value}function u(h){s.push(h);const d=()=>{const v=s.indexOf(h);v>-1&&s.splice(v,1)};return i.push(d),d}function c(){const{history:h}=window;h.state&&h.replaceState(X({},h.state,{scroll:Rr()}),"")}function f(){for(const h of i)h();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",c)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",c,{passive:!0}),{pauseListeners:l,listen:u,destroy:f}}function Mi(t,e,n,r=!1,s=!1){return{back:t,current:e,forward:n,replaced:r,position:window.history.length,scroll:s?Rr():null}}function sf(t){const{history:e,location:n}=window,r={value:ba(t,n)},s={value:e.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(l,u,c){const f=t.indexOf("#"),h=f>-1?(n.host&&document.querySelector("base")?t:t.slice(f))+l:nf()+t+l;try{e[c?"replaceState":"pushState"](u,"",h),s.value=u}catch(d){console.error(d),n[c?"replace":"assign"](h)}}function o(l,u){const c=X({},e.state,Mi(s.value.back,l,s.value.forward,!0),u,{position:s.value.position});i(l,c,!0),r.value=l}function a(l,u){const c=X({},s.value,e.state,{forward:l,scroll:Rr()});i(c.current,c,!0);const f=X({},Mi(r.value,l,null),{position:c.position+1},u);i(l,f,!1),r.value=l}return{location:r,state:s,push:a,replace:o}}function of(t){t=Ku(t);const e=sf(t),n=rf(t,e.state,e.location,e.replace);function r(i,o=!0){o||n.pauseListeners(),history.go(i)}const s=X({location:"",base:t,go:r,createHref:Zu.bind(null,t)},e,n);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function af(t){return t=location.host?t||location.pathname+location.search:"",t.includes("#")||(t+="#"),of(t)}function lf(t){return typeof t=="string"||t&&typeof t=="object"}function Sa(t){return typeof t=="string"||typeof t=="symbol"}const Aa=Symbol("");var Oi;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(Oi||(Oi={}));function Ke(t,e){return X(new Error,{type:t,[Aa]:!0},e)}function re(t,e){return t instanceof Error&&Aa in t&&(e==null||!!(t.type&e))}const Li="[^/]+?",cf={sensitive:!1,strict:!1,start:!0,end:!0},uf=/[.+*?^${}()[\]/\\]/g;function ff(t,e){const n=X({},cf,e),r=[];let s=n.start?"^":"";const i=[];for(const u of t){const c=u.length?[]:[90];n.strict&&!u.length&&(s+="/");for(let f=0;f<u.length;f++){const h=u[f];let d=40+(n.sensitive?.25:0);if(h.type===0)f||(s+="/"),s+=h.value.replace(uf,"\\$&"),d+=40;else if(h.type===1){const{value:v,repeatable:y,optional:T,regexp:w}=h;i.push({name:v,repeatable:y,optional:T});const _=w||Li;if(_!==Li){d+=10;try{new RegExp(`(${_})`)}catch(x){throw new Error(`Invalid custom RegExp for param "${v}" (${_}): `+x.message)}}let b=y?`((?:${_})(?:/(?:${_}))*)`:`(${_})`;f||(b=T&&u.length<2?`(?:/${b})`:"/"+b),T&&(b+="?"),s+=b,d+=20,T&&(d+=-8),y&&(d+=-20),_===".*"&&(d+=-50)}c.push(d)}r.push(c)}if(n.strict&&n.end){const u=r.length-1;r[u][r[u].length-1]+=.7000000000000001}n.strict||(s+="/?"),n.end?s+="$":n.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const o=new RegExp(s,n.sensitive?"":"i");function a(u){const c=u.match(o),f={};if(!c)return null;for(let h=1;h<c.length;h++){const d=c[h]||"",v=i[h-1];f[v.name]=d&&v.repeatable?d.split("/"):d}return f}function l(u){let c="",f=!1;for(const h of t){(!f||!c.endsWith("/"))&&(c+="/"),f=!1;for(const d of h)if(d.type===0)c+=d.value;else if(d.type===1){const{value:v,repeatable:y,optional:T}=d,w=v in u?u[v]:"";if($t(w)&&!y)throw new Error(`Provided param "${v}" is an array but it is not repeatable (* or + modifiers)`);const _=$t(w)?w.join("/"):w;if(!_)if(T)h.length<2&&(c.endsWith("/")?c=c.slice(0,-1):f=!0);else throw new Error(`Missing required param "${v}"`);c+=_}}return c||"/"}return{re:o,score:r,keys:i,parse:a,stringify:l}}function hf(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=e[n]-t[n];if(r)return r;n++}return t.length<e.length?t.length===1&&t[0]===80?-1:1:t.length>e.length?e.length===1&&e[0]===80?1:-1:0}function Ea(t,e){let n=0;const r=t.score,s=e.score;for(;n<r.length&&n<s.length;){const i=hf(r[n],s[n]);if(i)return i;n++}if(Math.abs(s.length-r.length)===1){if(Pi(r))return 1;if(Pi(s))return-1}return s.length-r.length}function Pi(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const df={type:0,value:""},pf=/[a-zA-Z0-9_]/;function mf(t){if(!t)return[[]];if(t==="/")return[[df]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(d){throw new Error(`ERR (${n})/"${u}": ${d}`)}let n=0,r=n;const s=[];let i;function o(){i&&s.push(i),i=[]}let a=0,l,u="",c="";function f(){u&&(n===0?i.push({type:0,value:u}):n===1||n===2||n===3?(i.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:u,regexp:c,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),u="")}function h(){u+=l}for(;a<t.length;){if(l=t[a++],l==="\\"&&n!==2){r=n,n=4;continue}switch(n){case 0:l==="/"?(u&&f(),o()):l===":"?(f(),n=1):h();break;case 4:h(),n=r;break;case 1:l==="("?n=2:pf.test(l)?h():(f(),n=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?c[c.length-1]=="\\"?c=c.slice(0,-1)+l:n=3:c+=l;break;case 3:f(),n=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,c="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${u}"`),f(),o(),s}function gf(t,e,n){const r=ff(mf(t.path),n),s=X(r,{record:t,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function vf(t,e){const n=[],r=new Map;e=ki({strict:!1,end:!0,sensitive:!1},e);function s(f){return r.get(f)}function i(f,h,d){const v=!d,y=Fi(f);y.aliasOf=d&&d.record;const T=ki(e,f),w=[y];if("alias"in f){const x=typeof f.alias=="string"?[f.alias]:f.alias;for(const M of x)w.push(Fi(X({},y,{components:d?d.record.components:y.components,path:M,aliasOf:d?d.record:y})))}let _,b;for(const x of w){const{path:M}=x;if(h&&M[0]!=="/"){const k=h.record.path,W=k[k.length-1]==="/"?"":"/";x.path=h.record.path+(M&&W+M)}if(_=gf(x,h,T),d?d.alias.push(_):(b=b||_,b!==_&&b.alias.push(_),v&&f.name&&!Di(_)&&o(f.name)),Ta(_)&&l(_),y.children){const k=y.children;for(let W=0;W<k.length;W++)i(k[W],_,d&&d.children[W])}d=d||_}return b?()=>{o(b)}:vn}function o(f){if(Sa(f)){const h=r.get(f);h&&(r.delete(f),n.splice(n.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=n.indexOf(f);h>-1&&(n.splice(h,1),f.record.name&&r.delete(f.record.name),f.children.forEach(o),f.alias.forEach(o))}}function a(){return n}function l(f){const h=wf(f,n);n.splice(h,0,f),f.record.name&&!Di(f)&&r.set(f.record.name,f)}function u(f,h){let d,v={},y,T;if("name"in f&&f.name){if(d=r.get(f.name),!d)throw Ke(1,{location:f});T=d.record.name,v=X(Ii(h.params,d.keys.filter(b=>!b.optional).concat(d.parent?d.parent.keys.filter(b=>b.optional):[]).map(b=>b.name)),f.params&&Ii(f.params,d.keys.map(b=>b.name))),y=d.stringify(v)}else if(f.path!=null)y=f.path,d=n.find(b=>b.re.test(y)),d&&(v=d.parse(y),T=d.record.name);else{if(d=h.name?r.get(h.name):n.find(b=>b.re.test(h.path)),!d)throw Ke(1,{location:f,currentLocation:h});T=d.record.name,v=X({},h.params,f.params),y=d.stringify(v)}const w=[];let _=d;for(;_;)w.unshift(_.record),_=_.parent;return{name:T,path:y,params:v,matched:w,meta:_f(w)}}t.forEach(f=>i(f));function c(){n.length=0,r.clear()}return{addRoute:i,resolve:u,removeRoute:o,clearRoutes:c,getRoutes:a,getRecordMatcher:s}}function Ii(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}function Fi(t){const e={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:yf(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function yf(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const r in t.components)e[r]=typeof n=="object"?n[r]:n;return e}function Di(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function _f(t){return t.reduce((e,n)=>X(e,n.meta),{})}function ki(t,e){const n={};for(const r in t)n[r]=r in e?e[r]:t[r];return n}function wf(t,e){let n=0,r=e.length;for(;n!==r;){const i=n+r>>1;Ea(t,e[i])<0?r=i:n=i+1}const s=xf(t);return s&&(r=e.lastIndexOf(s,r-1)),r}function xf(t){let e=t;for(;e=e.parent;)if(Ta(e)&&Ea(t,e)===0)return e}function Ta({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function bf(t){const e={};if(t===""||t==="?")return e;const r=(t[0]==="?"?t.slice(1):t).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(va," "),o=i.indexOf("="),a=Tn(o<0?i:i.slice(0,o)),l=o<0?null:Tn(i.slice(o+1));if(a in e){let u=e[a];$t(u)||(u=e[a]=[u]),u.push(l)}else e[a]=l}return e}function Bi(t){let e="";for(let n in t){const r=t[n];if(n=$u(n),r==null){r!==void 0&&(e+=(e.length?"&":"")+n);continue}($t(r)?r.map(i=>i&&cs(i)):[r&&cs(r)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+n,i!=null&&(e+="="+i))})}return e}function Sf(t){const e={};for(const n in t){const r=t[n];r!==void 0&&(e[n]=$t(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}const Af=Symbol(""),Ni=Symbol(""),Ns=Symbol(""),Ca=Symbol(""),fs=Symbol("");function nn(){let t=[];function e(r){return t.push(r),()=>{const s=t.indexOf(r);s>-1&&t.splice(s,1)}}function n(){t=[]}return{add:e,list:()=>t.slice(),reset:n}}function ye(t,e,n,r,s,i=o=>o()){const o=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((a,l)=>{const u=h=>{h===!1?l(Ke(4,{from:n,to:e})):h instanceof Error?l(h):lf(h)?l(Ke(2,{from:e,to:h})):(o&&r.enterCallbacks[s]===o&&typeof h=="function"&&o.push(h),a())},c=i(()=>t.call(r&&r.instances[s],e,n,u));let f=Promise.resolve(c);t.length<3&&(f=f.then(u)),f.catch(h=>l(h))})}function Gr(t,e,n,r,s=i=>i()){const i=[];for(const o of t)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(ma(l)){const c=(l.__vccOpts||l)[e];c&&i.push(ye(c,n,r,o,a,s))}else{let u=l();i.push(()=>u.then(c=>{if(!c)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const f=Mu(c)?c.default:c;o.mods[a]=c,o.components[a]=f;const d=(f.__vccOpts||f)[e];return d&&ye(d,n,r,o,a,s)()}))}}return i}function Hi(t){const e=ce(Ns),n=ce(Ca),r=At(()=>{const l=Oe(t.to);return e.resolve(l)}),s=At(()=>{const{matched:l}=r.value,{length:u}=l,c=l[u-1],f=n.matched;if(!c||!f.length)return-1;const h=f.findIndex(je.bind(null,c));if(h>-1)return h;const d=$i(l[u-2]);return u>1&&$i(c)===d&&f[f.length-1].path!==d?f.findIndex(je.bind(null,l[u-2])):h}),i=At(()=>s.value>-1&&Mf(n.params,r.value.params)),o=At(()=>s.value>-1&&s.value===n.matched.length-1&&xa(n.params,r.value.params));function a(l={}){if(Rf(l)){const u=e[Oe(t.replace)?"replace":"push"](Oe(t.to)).catch(vn);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>u),u}return Promise.resolve()}return{route:r,href:At(()=>r.value.href),isActive:i,isExactActive:o,navigate:a}}function Ef(t){return t.length===1?t[0]:t}const Tf=$o({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Hi,setup(t,{slots:e}){const n=In(Hi(t)),{options:r}=ce(Ns),s=At(()=>({[Wi(t.activeClass,r.linkActiveClass,"router-link-active")]:n.isActive,[Wi(t.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=e.default&&Ef(e.default(n));return t.custom?i:ha("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:s.value},i)}}}),Cf=Tf;function Rf(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function Mf(t,e){for(const n in e){const r=e[n],s=t[n];if(typeof r=="string"){if(r!==s)return!1}else if(!$t(s)||s.length!==r.length||r.some((i,o)=>i!==s[o]))return!1}return!0}function $i(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const Wi=(t,e,n)=>t??e??n,Of=$o({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const r=ce(fs),s=At(()=>t.route||r.value),i=ce(Ni,0),o=At(()=>{let u=Oe(i);const{matched:c}=s.value;let f;for(;(f=c[u])&&!f.components;)u++;return u}),a=At(()=>s.value.matched[o.value]);Xn(Ni,At(()=>o.value+1)),Xn(Af,a),Xn(fs,s);const l=it();return mn(()=>[l.value,a.value,t.name],([u,c,f],[h,d,v])=>{c&&(c.instances[f]=u,d&&d!==c&&u&&u===h&&(c.leaveGuards.size||(c.leaveGuards=d.leaveGuards),c.updateGuards.size||(c.updateGuards=d.updateGuards))),u&&c&&(!d||!je(c,d)||!h)&&(c.enterCallbacks[f]||[]).forEach(y=>y(u))},{flush:"post"}),()=>{const u=s.value,c=t.name,f=a.value,h=f&&f.components[c];if(!h)return Ui(n.default,{Component:h,route:u});const d=f.props[c],v=d?d===!0?u.params:typeof d=="function"?d(u):d:null,T=ha(h,X({},v,e,{onVnodeUnmounted:w=>{w.component.isUnmounted&&(f.instances[c]=null)},ref:l}));return Ui(n.default,{Component:T,route:u})||T}}});function Ui(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const Lf=Of;function Pf(t){const e=vf(t.routes,t),n=t.parseQuery||bf,r=t.stringifyQuery||Bi,s=t.history,i=nn(),o=nn(),a=nn(),l=Hl(me);let u=me;He&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=zr.bind(null,A=>""+A),f=zr.bind(null,Uu),h=zr.bind(null,Tn);function d(A,D){let I,B;return Sa(A)?(I=e.getRecordMatcher(A),B=D):B=A,e.addRoute(B,I)}function v(A){const D=e.getRecordMatcher(A);D&&e.removeRoute(D)}function y(){return e.getRoutes().map(A=>A.record)}function T(A){return!!e.getRecordMatcher(A)}function w(A,D){if(D=X({},D||l.value),typeof A=="string"){const g=Vr(n,A,D.path),S=e.resolve({path:g.path},D),C=s.createHref(g.fullPath);return X(g,S,{params:h(S.params),hash:Tn(g.hash),redirectedFrom:void 0,href:C})}let I;if(A.path!=null)I=X({},A,{path:Vr(n,A.path,D.path).path});else{const g=X({},A.params);for(const S in g)g[S]==null&&delete g[S];I=X({},A,{params:f(g)}),D.params=f(D.params)}const B=e.resolve(I,D),J=A.hash||"";B.params=c(h(B.params));const p=Gu(r,X({},A,{hash:Hu(J),path:B.path})),m=s.createHref(p);return X({fullPath:p,hash:J,query:r===Bi?Sf(A.query):A.query||{}},B,{redirectedFrom:void 0,href:m})}function _(A){return typeof A=="string"?Vr(n,A,l.value.path):X({},A)}function b(A,D){if(u!==A)return Ke(8,{from:D,to:A})}function x(A){return W(A)}function M(A){return x(X(_(A),{replace:!0}))}function k(A){const D=A.matched[A.matched.length-1];if(D&&D.redirect){const{redirect:I}=D;let B=typeof I=="function"?I(A):I;return typeof B=="string"&&(B=B.includes("?")||B.includes("#")?B=_(B):{path:B},B.params={}),X({query:A.query,hash:A.hash,params:B.path!=null?{}:A.params},B)}}function W(A,D){const I=u=w(A),B=l.value,J=A.state,p=A.force,m=A.replace===!0,g=k(I);if(g)return W(X(_(g),{state:typeof g=="object"?X({},J,g.state):J,force:p,replace:m}),D||I);const S=I;S.redirectedFrom=D;let C;return!p&&Yu(r,B,I)&&(C=Ke(16,{to:S,from:B}),zt(B,B,!0,!1)),(C?Promise.resolve(C):lt(S,B)).catch(E=>re(E)?re(E,2)?E:pe(E):Y(E,S,B)).then(E=>{if(E){if(re(E,2))return W(X({replace:m},_(E.to),{state:typeof E.to=="object"?X({},J,E.to.state):J,force:p}),D||S)}else E=xt(S,B,!0,m,J);return mt(S,B,E),E})}function st(A,D){const I=b(A,D);return I?Promise.reject(I):Promise.resolve()}function ft(A){const D=ke.values().next().value;return D&&typeof D.runWithContext=="function"?D.runWithContext(A):A()}function lt(A,D){let I;const[B,J,p]=If(A,D);I=Gr(B.reverse(),"beforeRouteLeave",A,D);for(const g of B)g.leaveGuards.forEach(S=>{I.push(ye(S,A,D))});const m=st.bind(null,A,D);return I.push(m),Ft(I).then(()=>{I=[];for(const g of i.list())I.push(ye(g,A,D));return I.push(m),Ft(I)}).then(()=>{I=Gr(J,"beforeRouteUpdate",A,D);for(const g of J)g.updateGuards.forEach(S=>{I.push(ye(S,A,D))});return I.push(m),Ft(I)}).then(()=>{I=[];for(const g of p)if(g.beforeEnter)if($t(g.beforeEnter))for(const S of g.beforeEnter)I.push(ye(S,A,D));else I.push(ye(g.beforeEnter,A,D));return I.push(m),Ft(I)}).then(()=>(A.matched.forEach(g=>g.enterCallbacks={}),I=Gr(p,"beforeRouteEnter",A,D,ft),I.push(m),Ft(I))).then(()=>{I=[];for(const g of o.list())I.push(ye(g,A,D));return I.push(m),Ft(I)}).catch(g=>re(g,8)?g:Promise.reject(g))}function mt(A,D,I){a.list().forEach(B=>ft(()=>B(A,D,I)))}function xt(A,D,I,B,J){const p=b(A,D);if(p)return p;const m=D===me,g=He?history.state:{};I&&(B||m?s.replace(A.fullPath,X({scroll:m&&g&&g.scroll},J)):s.push(A.fullPath,J)),l.value=A,zt(A,D,I,m),pe()}let gt;function rt(){gt||(gt=s.listen((A,D,I)=>{if(!Hn.listening)return;const B=w(A),J=k(B);if(J){W(X(J,{replace:!0,force:!0}),B).catch(vn);return}u=B;const p=l.value;He&&tf(Ri(p.fullPath,I.delta),Rr()),lt(B,p).catch(m=>re(m,12)?m:re(m,2)?(W(X(_(m.to),{force:!0}),B).then(g=>{re(g,20)&&!I.delta&&I.type===Cn.pop&&s.go(-1,!1)}).catch(vn),Promise.reject()):(I.delta&&s.go(-I.delta,!1),Y(m,B,p))).then(m=>{m=m||xt(B,p,!1),m&&(I.delta&&!re(m,8)?s.go(-I.delta,!1):I.type===Cn.pop&&re(m,20)&&s.go(-1,!1)),mt(B,p,m)}).catch(vn)}))}let Fe=nn(),ut=nn(),Z;function Y(A,D,I){pe(A);const B=ut.list();return B.length?B.forEach(J=>J(A,D,I)):console.error(A),Promise.reject(A)}function ee(){return Z&&l.value!==me?Promise.resolve():new Promise((A,D)=>{Fe.add([A,D])})}function pe(A){return Z||(Z=!A,rt(),Fe.list().forEach(([D,I])=>A?I(A):D()),Fe.reset()),A}function zt(A,D,I,B){const{scrollBehavior:J}=t;if(!He||!J)return Promise.resolve();const p=!I&&ef(Ri(A.fullPath,0))||(B||!I)&&history.state&&history.state.scroll||null;return Dn().then(()=>J(A,D,p)).then(m=>m&&Qu(m)).catch(m=>Y(m,A,D))}const Et=A=>s.go(A);let De;const ke=new Set,Hn={currentRoute:l,listening:!0,addRoute:d,removeRoute:v,clearRoutes:e.clearRoutes,hasRoute:T,getRoutes:y,resolve:w,options:t,push:x,replace:M,go:Et,back:()=>Et(-1),forward:()=>Et(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:ut.add,isReady:ee,install(A){const D=this;A.component("RouterLink",Cf),A.component("RouterView",Lf),A.config.globalProperties.$router=D,Object.defineProperty(A.config.globalProperties,"$route",{enumerable:!0,get:()=>Oe(l)}),He&&!De&&l.value===me&&(De=!0,x(s.location).catch(J=>{}));const I={};for(const J in me)Object.defineProperty(I,J,{get:()=>l.value[J],enumerable:!0});A.provide(Ns,D),A.provide(Ca,Lo(I)),A.provide(fs,l);const B=A.unmount;ke.add(A),A.unmount=function(){ke.delete(A),ke.size<1&&(u=me,gt&&gt(),gt=null,l.value=me,De=!1,Z=!1),B()}}};function Ft(A){return A.reduce((D,I)=>D.then(()=>ft(I)),Promise.resolve())}return Hn}function If(t,e){const n=[],r=[],s=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(t.matched.find(u=>je(u,a))?r.push(a):n.push(a));const l=t.matched[o];l&&(e.matched.find(u=>je(u,l))||s.push(l))}return[n,r,s]}var Ae=typeof Float32Array<"u"?Float32Array:Array;function le(){var t=new Ae(16);return Ae!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Ff(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ra(t,e){var n=e[0],r=e[1],s=e[2],i=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],f=e[9],h=e[10],d=e[11],v=e[12],y=e[13],T=e[14],w=e[15],_=n*a-r*o,b=n*l-s*o,x=n*u-i*o,M=r*l-s*a,k=r*u-i*a,W=s*u-i*l,st=c*y-f*v,ft=c*T-h*v,lt=c*w-d*v,mt=f*T-h*y,xt=f*w-d*y,gt=h*w-d*T,rt=_*gt-b*xt+x*mt+M*lt-k*ft+W*st;return rt?(rt=1/rt,t[0]=(a*gt-l*xt+u*mt)*rt,t[1]=(s*xt-r*gt-i*mt)*rt,t[2]=(y*W-T*k+w*M)*rt,t[3]=(h*k-f*W-d*M)*rt,t[4]=(l*lt-o*gt-u*ft)*rt,t[5]=(n*gt-s*lt+i*ft)*rt,t[6]=(T*x-v*W-w*b)*rt,t[7]=(c*W-h*x+d*b)*rt,t[8]=(o*xt-a*lt+u*st)*rt,t[9]=(r*lt-n*xt-i*st)*rt,t[10]=(v*k-y*x+w*_)*rt,t[11]=(f*x-c*k-d*_)*rt,t[12]=(a*ft-o*mt-l*st)*rt,t[13]=(n*mt-r*ft+s*st)*rt,t[14]=(y*b-v*M-T*_)*rt,t[15]=(c*M-f*b+h*_)*rt,t):null}function Df(t,e,n){var r=e[0],s=e[1],i=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],f=e[8],h=e[9],d=e[10],v=e[11],y=e[12],T=e[13],w=e[14],_=e[15],b=n[0],x=n[1],M=n[2],k=n[3];return t[0]=b*r+x*a+M*f+k*y,t[1]=b*s+x*l+M*h+k*T,t[2]=b*i+x*u+M*d+k*w,t[3]=b*o+x*c+M*v+k*_,b=n[4],x=n[5],M=n[6],k=n[7],t[4]=b*r+x*a+M*f+k*y,t[5]=b*s+x*l+M*h+k*T,t[6]=b*i+x*u+M*d+k*w,t[7]=b*o+x*c+M*v+k*_,b=n[8],x=n[9],M=n[10],k=n[11],t[8]=b*r+x*a+M*f+k*y,t[9]=b*s+x*l+M*h+k*T,t[10]=b*i+x*u+M*d+k*w,t[11]=b*o+x*c+M*v+k*_,b=n[12],x=n[13],M=n[14],k=n[15],t[12]=b*r+x*a+M*f+k*y,t[13]=b*s+x*l+M*h+k*T,t[14]=b*i+x*u+M*d+k*w,t[15]=b*o+x*c+M*v+k*_,t}function hs(t,e,n){var r=n[0],s=n[1],i=n[2],o,a,l,u,c,f,h,d,v,y,T,w;return e===t?(t[12]=e[0]*r+e[4]*s+e[8]*i+e[12],t[13]=e[1]*r+e[5]*s+e[9]*i+e[13],t[14]=e[2]*r+e[6]*s+e[10]*i+e[14],t[15]=e[3]*r+e[7]*s+e[11]*i+e[15]):(o=e[0],a=e[1],l=e[2],u=e[3],c=e[4],f=e[5],h=e[6],d=e[7],v=e[8],y=e[9],T=e[10],w=e[11],t[0]=o,t[1]=a,t[2]=l,t[3]=u,t[4]=c,t[5]=f,t[6]=h,t[7]=d,t[8]=v,t[9]=y,t[10]=T,t[11]=w,t[12]=o*r+c*s+v*i+e[12],t[13]=a*r+f*s+y*i+e[13],t[14]=l*r+h*s+T*i+e[14],t[15]=u*r+d*s+w*i+e[15]),t}function kf(t,e,n){var r=n[0],s=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Bf(t,e,n,r,s,i,o){var a=1/(e-n),l=1/(r-s),u=1/(i-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(s+r)*l,t[14]=(o+i)*u,t[15]=1,t}var ar=Bf;function Nf(){var t=new Ae(4);return Ae!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function zi(t,e,n,r){var s=new Ae(4);return s[0]=t,s[1]=e,s[2]=n,s[3]=r,s}function Vi(t,e,n){var r=e[0],s=e[1],i=e[2],o=e[3];return t[0]=n[0]*r+n[4]*s+n[8]*i+n[12]*o,t[1]=n[1]*r+n[5]*s+n[9]*i+n[13]*o,t[2]=n[2]*r+n[6]*s+n[10]*i+n[14]*o,t[3]=n[3]*r+n[7]*s+n[11]*i+n[15]*o,t}(function(){var t=Nf();return function(e,n,r,s,i,o){var a,l;for(n||(n=4),r||(r=0),s?l=Math.min(s*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],i(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();function Ma(){var t=new Ae(2);return Ae!=Float32Array&&(t[0]=0,t[1]=0),t}function Gi(t,e){var n=new Ae(2);return n[0]=t,n[1]=e,n}function Hf(t,e){return t[0]=e[0],t[1]=e[1],t}function $f(t,e,n){return t[0]=e,t[1]=n,t}function Wf(t,e,n){var r=e[0],s=e[1];return t[0]=n[0]*r+n[4]*s+n[12],t[1]=n[1]*r+n[5]*s+n[13],t}(function(){var t=Ma();return function(e,n,r,s,i,o){var a,l;for(n||(n=2),r||(r=0),s?l=Math.min(s*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],i(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}})();const Yi={memory:{vert:`
precision highp float;
attribute vec2 aPosition;
attribute vec2 aSize;
attribute vec4 aColor;
attribute float aType;
attribute float aBorder;
attribute vec2 aUnitCoord;

uniform mat4 uViewMatrix;
uniform vec2 uScreenSize;

varying vec4  vColor;
varying vec2  vUv;
varying float vType;
varying float vBorder;
varying vec2  vUnitCoord;

void main() {
    vec2 worldPos = aPosition + aUnitCoord * aSize;
    gl_Position   = uViewMatrix * vec4(worldPos, 0.0, 1.0);
    vUv           = aUnitCoord;
    vColor        = aColor;
    vType         = aType;
    vBorder       = aBorder;
    vUnitCoord    = aUnitCoord;
}`,frag:`
    precision mediump float;

varying vec4  vColor;
varying vec2  vUv;
varying float vType;
varying float vBorder;

/* ---------- 新增：图案增强参数 ---------- */
const float kDensity   = 10.0;        // 4×4 像素一个大像素
const float kDotSize   = 0.75;       // 实心块占单元格比例（0~1）
const float kLineWidth = 0.20;       // 斜线/十字线的线宽（0~1）
const float kAAFactor  = 0.25;       // 抗锯齿比例，让线条更柔和

/* ---------- 工具：抗锯齿 Step ---------- */
float aastep(float threshold, float value) {
    float afwidth = kAAFactor / kDensity;
    return smoothstep(threshold - afwidth, threshold + afwidth, value);
}

void main() {
    /* 1. 计算当前处于哪个“大像素” */
    vec2 cell   = floor(vUv * kDensity);           // 整数单元坐标
    vec2 cellUV = fract(vUv * kDensity);           // 单元内局部 0~1

    /* 2. 生成图案掩码 pattern (0 或 1) */
    float pattern = 0.0;

    if (vType > 1.5) {
        /* ---- 星号（十字线） ---- */
        // 1. 棋盘屏蔽：只在 (x+y) 为偶数的格子画线
        float cellMask = 1.0 - mod(cell.x + cell.y, 2.0);   // 0 或 1

        // 2. 普通十字线
        float cx = aastep(0.5 - kLineWidth * 0.5, cellUV.x) -
                   aastep(0.5 + kLineWidth * 0.5, cellUV.x);
        float cy = aastep(0.5 - kLineWidth * 0.5, cellUV.y) -
                   aastep(0.5 + kLineWidth * 0.5, cellUV.y);
        float cross = clamp(cx + cy, 0.0, 1.0);

        // 3. 只在棋盘允许的位置出现
        pattern = cross * cellMask;

    } else if (vType > 0.5) {
        /* ---- 斜线（左下到右上） ---- */
        float d = cellUV.x + cellUV.y;               // 对角线方程
        float halfW = kLineWidth * 0.5;
        pattern = aastep(1.0 - halfW, d) - aastep(1.0 + halfW, d);
    }

    /* 3. 失败边框（保持不变） */
    float edge = min(min(vUv.x, 1.0 - vUv.x),
                     min(vUv.y, 1.0 - vUv.y));
    if (vBorder > 0.5 && edge < 0.05) {
        gl_FragColor = vec4(0.9, 0.2, 0.2, 1.0);
        return;
    }

    /* 4. 最终颜色：底色与图案混合 */
    vec4 patternColor = vec4(0.0, 0.0, 0.0, 0.8);   // 70% 黑色覆盖
    gl_FragColor = mix(vColor, patternColor, pattern);
}
    `},grid:{vert:`
#ifdef GL_ES
precision highp float;
#endif

attribute vec2 aPosition;
attribute float aLineWidth;
attribute float aLineType; // 0: 时间步线, 1: Bank线, 2: 最大内存线

uniform mat4 uViewMatrix;
uniform vec2 uScreenSize;

varying float vLineWidth;
varying float vLineType;

void main() {
    gl_Position = uViewMatrix * vec4(aPosition, 0.0, 1.0);
    
    // 计算屏幕空间线宽
    vec2 screenFactor = vec2(2.0 / uScreenSize.x, 2.0 / uScreenSize.y);
    vLineWidth = aLineWidth * min(screenFactor.x, screenFactor.y);
    vLineType = aLineType;
}`,frag:`
#ifdef GL_ES
precision highp float;
#endif

varying float vLineWidth;
varying float vLineType;

void main() {
    // 虚线效果 - 基于屏幕坐标
    vec2 screenPos = gl_FragCoord.xy;
    float pattern;

    if (vLineType == 0.0) {               // 竖线
        float pos = mod(screenPos.x, 4.0); // 原来是 15
        pattern = step(0.0, pos - 2.0);    // 2px 实线 2px 空白
    } else if (vLineType == 1.0) {        // 横线
        float pos = mod(screenPos.y, 6.0); // 原来是 25
        pattern = step(0.0, pos - 3.0);    // 3px 实线 3px 空白
    } else {
        pattern = 1.0;
    }
    
    //if (pattern < 0.05) discard;

    vec4 color;
    if (vLineType == 0.0) {
            color = vec4(0.36, 0.35, 0.35, 0.6);   // 次时间步线
    } else if (vLineType == 1.0) {
            color = vec4(0.39, 0.38, 0.38, 0.6);  // 次Bank线
    } else {
        color = vec4(1.0, 0.0, 0.0, 0.6); // 最大内存线
    }
    
    gl_FragColor = color;
}
`},tooltip:{vert:`
attribute vec2 aPos;
uniform mat4 uViewMatrix;
void main() {
  gl_Position = uViewMatrix * vec4(aPos, 0.0, 1.0);
}`,frag:`
precision mediump float;
void main() {
  gl_FragColor = vec4(0.0, 0.0, 0.0, 0.75);
}`},summary:{vert:`
attribute vec2 aPosition;
attribute vec4 aColor;

uniform   mat4 uViewMatrix;

varying   vec4 vColor;

void main() {
  gl_Position = uViewMatrix * vec4(aPosition, 0.0, 1.0);
  vColor      = aColor * 0.8;
}`,frag:`
precision mediump float;
varying vec4 vColor;
void main() {
  gl_FragColor = vColor;
}`}};class we{static async load(e,n){if(!Yi[n])throw new Error(`Shader set "${n}" not found`);return Yi[n]}static compile(e,n,r){const s=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(s,n),e.compileShader(s),!e.getShaderParameter(s,e.COMPILE_STATUS))throw new Error("VS error: "+e.getShaderInfoLog(s));const i=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(i,r),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new Error("FS error: "+e.getShaderInfoLog(i));const o=e.createProgram();if(e.attachShader(o,s),e.attachShader(o,i),e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS))throw new Error("Link error: "+e.getProgramInfoLog(o));return e.detachShader(o,s),e.detachShader(o,i),e.deleteShader(s),e.deleteShader(i),o}}var Uf={value:()=>{}};function Oa(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new qn(n)}function qn(t){this._=t}function zf(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",s=n.indexOf(".");if(s>=0&&(r=n.slice(s+1),n=n.slice(0,s)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}qn.prototype=Oa.prototype={constructor:qn,on:function(t,e){var n=this._,r=zf(t+"",n),s,i=-1,o=r.length;if(arguments.length<2){for(;++i<o;)if((s=(t=r[i]).type)&&(s=Vf(n[s],t.name)))return s;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++i<o;)if(s=(t=r[i]).type)n[s]=Xi(n[s],t.name,e);else if(e==null)for(s in n)n[s]=Xi(n[s],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new qn(t)},call:function(t,e){if((s=arguments.length-2)>0)for(var n=new Array(s),r=0,s,i;r<s;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],s=0,i=r.length;s<i;++s)r[s].value.apply(e,n)}};function Vf(t,e){for(var n=0,r=t.length,s;n<r;++n)if((s=t[n]).name===e)return s.value}function Xi(t,e,n){for(var r=0,s=t.length;r<s;++r)if(t[r].name===e){t[r]=Uf,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var ds="http://www.w3.org/1999/xhtml";const ji={svg:"http://www.w3.org/2000/svg",xhtml:ds,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Mr(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),ji.hasOwnProperty(e)?{space:ji[e],local:t}:t}function Gf(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===ds&&e.documentElement.namespaceURI===ds?e.createElement(t):e.createElementNS(n,t)}}function Yf(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function La(t){var e=Mr(t);return(e.local?Yf:Gf)(e)}function Xf(){}function Hs(t){return t==null?Xf:function(){return this.querySelector(t)}}function jf(t){typeof t!="function"&&(t=Hs(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var i=e[s],o=i.length,a=r[s]=new Array(o),l,u,c=0;c<o;++c)(l=i[c])&&(u=t.call(l,l.__data__,c,i))&&("__data__"in l&&(u.__data__=l.__data__),a[c]=u);return new Wt(r,this._parents)}function Kf(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function qf(){return[]}function Pa(t){return t==null?qf:function(){return this.querySelectorAll(t)}}function Zf(t){return function(){return Kf(t.apply(this,arguments))}}function Jf(t){typeof t=="function"?t=Zf(t):t=Pa(t);for(var e=this._groups,n=e.length,r=[],s=[],i=0;i<n;++i)for(var o=e[i],a=o.length,l,u=0;u<a;++u)(l=o[u])&&(r.push(t.call(l,l.__data__,u,o)),s.push(l));return new Wt(r,s)}function Ia(t){return function(){return this.matches(t)}}function Fa(t){return function(e){return e.matches(t)}}var Qf=Array.prototype.find;function th(t){return function(){return Qf.call(this.children,t)}}function eh(){return this.firstElementChild}function nh(t){return this.select(t==null?eh:th(typeof t=="function"?t:Fa(t)))}var rh=Array.prototype.filter;function sh(){return Array.from(this.children)}function ih(t){return function(){return rh.call(this.children,t)}}function oh(t){return this.selectAll(t==null?sh:ih(typeof t=="function"?t:Fa(t)))}function ah(t){typeof t!="function"&&(t=Ia(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var i=e[s],o=i.length,a=r[s]=[],l,u=0;u<o;++u)(l=i[u])&&t.call(l,l.__data__,u,i)&&a.push(l);return new Wt(r,this._parents)}function Da(t){return new Array(t.length)}function lh(){return new Wt(this._enter||this._groups.map(Da),this._parents)}function lr(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}lr.prototype={constructor:lr,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function ch(t){return function(){return t}}function uh(t,e,n,r,s,i){for(var o=0,a,l=e.length,u=i.length;o<u;++o)(a=e[o])?(a.__data__=i[o],r[o]=a):n[o]=new lr(t,i[o]);for(;o<l;++o)(a=e[o])&&(s[o]=a)}function fh(t,e,n,r,s,i,o){var a,l,u=new Map,c=e.length,f=i.length,h=new Array(c),d;for(a=0;a<c;++a)(l=e[a])&&(h[a]=d=o.call(l,l.__data__,a,e)+"",u.has(d)?s[a]=l:u.set(d,l));for(a=0;a<f;++a)d=o.call(t,i[a],a,i)+"",(l=u.get(d))?(r[a]=l,l.__data__=i[a],u.delete(d)):n[a]=new lr(t,i[a]);for(a=0;a<c;++a)(l=e[a])&&u.get(h[a])===l&&(s[a]=l)}function hh(t){return t.__data__}function dh(t,e){if(!arguments.length)return Array.from(this,hh);var n=e?fh:uh,r=this._parents,s=this._groups;typeof t!="function"&&(t=ch(t));for(var i=s.length,o=new Array(i),a=new Array(i),l=new Array(i),u=0;u<i;++u){var c=r[u],f=s[u],h=f.length,d=ph(t.call(c,c&&c.__data__,u,r)),v=d.length,y=a[u]=new Array(v),T=o[u]=new Array(v),w=l[u]=new Array(h);n(c,f,y,T,w,d,e);for(var _=0,b=0,x,M;_<v;++_)if(x=y[_]){for(_>=b&&(b=_+1);!(M=T[b])&&++b<v;);x._next=M||null}}return o=new Wt(o,r),o._enter=a,o._exit=l,o}function ph(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function mh(){return new Wt(this._exit||this._groups.map(Da),this._parents)}function gh(t,e,n){var r=this.enter(),s=this,i=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(s=e(s),s&&(s=s.selection())),n==null?i.remove():n(i),r&&s?r.merge(s).order():s}function vh(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,s=n.length,i=r.length,o=Math.min(s,i),a=new Array(s),l=0;l<o;++l)for(var u=n[l],c=r[l],f=u.length,h=a[l]=new Array(f),d,v=0;v<f;++v)(d=u[v]||c[v])&&(h[v]=d);for(;l<s;++l)a[l]=n[l];return new Wt(a,this._parents)}function yh(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],s=r.length-1,i=r[s],o;--s>=0;)(o=r[s])&&(i&&o.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(o,i),i=o);return this}function _h(t){t||(t=wh);function e(f,h){return f&&h?t(f.__data__,h.__data__):!f-!h}for(var n=this._groups,r=n.length,s=new Array(r),i=0;i<r;++i){for(var o=n[i],a=o.length,l=s[i]=new Array(a),u,c=0;c<a;++c)(u=o[c])&&(l[c]=u);l.sort(e)}return new Wt(s,this._parents).order()}function wh(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function xh(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function bh(){return Array.from(this)}function Sh(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],s=0,i=r.length;s<i;++s){var o=r[s];if(o)return o}return null}function Ah(){let t=0;for(const e of this)++t;return t}function Eh(){return!this.node()}function Th(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var s=e[n],i=0,o=s.length,a;i<o;++i)(a=s[i])&&t.call(a,a.__data__,i,s);return this}function Ch(t){return function(){this.removeAttribute(t)}}function Rh(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Mh(t,e){return function(){this.setAttribute(t,e)}}function Oh(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Lh(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Ph(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Ih(t,e){var n=Mr(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Rh:Ch:typeof e=="function"?n.local?Ph:Lh:n.local?Oh:Mh)(n,e))}function ka(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Fh(t){return function(){this.style.removeProperty(t)}}function Dh(t,e,n){return function(){this.style.setProperty(t,e,n)}}function kh(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Bh(t,e,n){return arguments.length>1?this.each((e==null?Fh:typeof e=="function"?kh:Dh)(t,e,n??"")):qe(this.node(),t)}function qe(t,e){return t.style.getPropertyValue(e)||ka(t).getComputedStyle(t,null).getPropertyValue(e)}function Nh(t){return function(){delete this[t]}}function Hh(t,e){return function(){this[t]=e}}function $h(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Wh(t,e){return arguments.length>1?this.each((e==null?Nh:typeof e=="function"?$h:Hh)(t,e)):this.node()[t]}function Ba(t){return t.trim().split(/^|\s+/)}function $s(t){return t.classList||new Na(t)}function Na(t){this._node=t,this._names=Ba(t.getAttribute("class")||"")}Na.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Ha(t,e){for(var n=$s(t),r=-1,s=e.length;++r<s;)n.add(e[r])}function $a(t,e){for(var n=$s(t),r=-1,s=e.length;++r<s;)n.remove(e[r])}function Uh(t){return function(){Ha(this,t)}}function zh(t){return function(){$a(this,t)}}function Vh(t,e){return function(){(e.apply(this,arguments)?Ha:$a)(this,t)}}function Gh(t,e){var n=Ba(t+"");if(arguments.length<2){for(var r=$s(this.node()),s=-1,i=n.length;++s<i;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof e=="function"?Vh:e?Uh:zh)(n,e))}function Yh(){this.textContent=""}function Xh(t){return function(){this.textContent=t}}function jh(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Kh(t){return arguments.length?this.each(t==null?Yh:(typeof t=="function"?jh:Xh)(t)):this.node().textContent}function qh(){this.innerHTML=""}function Zh(t){return function(){this.innerHTML=t}}function Jh(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Qh(t){return arguments.length?this.each(t==null?qh:(typeof t=="function"?Jh:Zh)(t)):this.node().innerHTML}function td(){this.nextSibling&&this.parentNode.appendChild(this)}function ed(){return this.each(td)}function nd(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function rd(){return this.each(nd)}function sd(t){var e=typeof t=="function"?t:La(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function id(){return null}function od(t,e){var n=typeof t=="function"?t:La(t),r=e==null?id:typeof e=="function"?e:Hs(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function ad(){var t=this.parentNode;t&&t.removeChild(this)}function ld(){return this.each(ad)}function cd(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ud(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function fd(t){return this.select(t?ud:cd)}function hd(t){return arguments.length?this.property("__data__",t):this.node().__data__}function dd(t){return function(e){t.call(this,e,this.__data__)}}function pd(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function md(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,s=e.length,i;n<s;++n)i=e[n],(!t.type||i.type===t.type)&&i.name===t.name?this.removeEventListener(i.type,i.listener,i.options):e[++r]=i;++r?e.length=r:delete this.__on}}}function gd(t,e,n){return function(){var r=this.__on,s,i=dd(e);if(r){for(var o=0,a=r.length;o<a;++o)if((s=r[o]).type===t.type&&s.name===t.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=n),s.value=e;return}}this.addEventListener(t.type,i,n),s={type:t.type,name:t.name,value:e,listener:i,options:n},r?r.push(s):this.__on=[s]}}function vd(t,e,n){var r=pd(t+""),s,i=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,u=a.length,c;l<u;++l)for(s=0,c=a[l];s<i;++s)if((o=r[s]).type===c.type&&o.name===c.name)return c.value}return}for(a=e?gd:md,s=0;s<i;++s)this.each(a(r[s],e,n));return this}function Wa(t,e,n){var r=ka(t),s=r.CustomEvent;typeof s=="function"?s=new s(e,n):(s=r.document.createEvent("Event"),n?(s.initEvent(e,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(e,!1,!1)),t.dispatchEvent(s)}function yd(t,e){return function(){return Wa(this,t,e)}}function _d(t,e){return function(){return Wa(this,t,e.apply(this,arguments))}}function wd(t,e){return this.each((typeof e=="function"?_d:yd)(t,e))}function*xd(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],s=0,i=r.length,o;s<i;++s)(o=r[s])&&(yield o)}var bd=[null];function Wt(t,e){this._groups=t,this._parents=e}function Bn(){return new Wt([[document.documentElement]],bd)}function Sd(){return this}Wt.prototype=Bn.prototype={constructor:Wt,select:jf,selectAll:Jf,selectChild:nh,selectChildren:oh,filter:ah,data:dh,enter:lh,exit:mh,join:gh,merge:vh,selection:Sd,order:yh,sort:_h,call:xh,nodes:bh,node:Sh,size:Ah,empty:Eh,each:Th,attr:Ih,style:Bh,property:Wh,classed:Gh,text:Kh,html:Qh,raise:ed,lower:rd,append:sd,insert:od,remove:ld,clone:fd,datum:hd,on:vd,dispatch:wd,[Symbol.iterator]:xd};function Ws(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Ua(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Nn(){}var Rn=.7,cr=1/Rn,Ge="\\s*([+-]?\\d+)\\s*",Mn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Zt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ad=/^#([0-9a-f]{3,8})$/,Ed=new RegExp(`^rgb\\(${Ge},${Ge},${Ge}\\)$`),Td=new RegExp(`^rgb\\(${Zt},${Zt},${Zt}\\)$`),Cd=new RegExp(`^rgba\\(${Ge},${Ge},${Ge},${Mn}\\)$`),Rd=new RegExp(`^rgba\\(${Zt},${Zt},${Zt},${Mn}\\)$`),Md=new RegExp(`^hsl\\(${Mn},${Zt},${Zt}\\)$`),Od=new RegExp(`^hsla\\(${Mn},${Zt},${Zt},${Mn}\\)$`),Ki={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ws(Nn,On,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:qi,formatHex:qi,formatHex8:Ld,formatHsl:Pd,formatRgb:Zi,toString:Zi});function qi(){return this.rgb().formatHex()}function Ld(){return this.rgb().formatHex8()}function Pd(){return za(this).formatHsl()}function Zi(){return this.rgb().formatRgb()}function On(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Ad.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Ji(e):n===3?new Mt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?zn(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?zn(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Ed.exec(t))?new Mt(e[1],e[2],e[3],1):(e=Td.exec(t))?new Mt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Cd.exec(t))?zn(e[1],e[2],e[3],e[4]):(e=Rd.exec(t))?zn(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Md.exec(t))?eo(e[1],e[2]/100,e[3]/100,1):(e=Od.exec(t))?eo(e[1],e[2]/100,e[3]/100,e[4]):Ki.hasOwnProperty(t)?Ji(Ki[t]):t==="transparent"?new Mt(NaN,NaN,NaN,0):null}function Ji(t){return new Mt(t>>16&255,t>>8&255,t&255,1)}function zn(t,e,n,r){return r<=0&&(t=e=n=NaN),new Mt(t,e,n,r)}function Id(t){return t instanceof Nn||(t=On(t)),t?(t=t.rgb(),new Mt(t.r,t.g,t.b,t.opacity)):new Mt}function ps(t,e,n,r){return arguments.length===1?Id(t):new Mt(t,e,n,r??1)}function Mt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Ws(Mt,ps,Ua(Nn,{brighter(t){return t=t==null?cr:Math.pow(cr,t),new Mt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Rn:Math.pow(Rn,t),new Mt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Mt(Le(this.r),Le(this.g),Le(this.b),ur(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Qi,formatHex:Qi,formatHex8:Fd,formatRgb:to,toString:to}));function Qi(){return`#${Re(this.r)}${Re(this.g)}${Re(this.b)}`}function Fd(){return`#${Re(this.r)}${Re(this.g)}${Re(this.b)}${Re((isNaN(this.opacity)?1:this.opacity)*255)}`}function to(){const t=ur(this.opacity);return`${t===1?"rgb(":"rgba("}${Le(this.r)}, ${Le(this.g)}, ${Le(this.b)}${t===1?")":`, ${t})`}`}function ur(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Le(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Re(t){return t=Le(t),(t<16?"0":"")+t.toString(16)}function eo(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Nt(t,e,n,r)}function za(t){if(t instanceof Nt)return new Nt(t.h,t.s,t.l,t.opacity);if(t instanceof Nn||(t=On(t)),!t)return new Nt;if(t instanceof Nt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,s=Math.min(e,n,r),i=Math.max(e,n,r),o=NaN,a=i-s,l=(i+s)/2;return a?(e===i?o=(n-r)/a+(n<r)*6:n===i?o=(r-e)/a+2:o=(e-n)/a+4,a/=l<.5?i+s:2-i-s,o*=60):a=l>0&&l<1?0:o,new Nt(o,a,l,t.opacity)}function Dd(t,e,n,r){return arguments.length===1?za(t):new Nt(t,e,n,r??1)}function Nt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Ws(Nt,Dd,Ua(Nn,{brighter(t){return t=t==null?cr:Math.pow(cr,t),new Nt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Rn:Math.pow(Rn,t),new Nt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,s=2*n-r;return new Mt(Yr(t>=240?t-240:t+120,s,r),Yr(t,s,r),Yr(t<120?t+240:t-120,s,r),this.opacity)},clamp(){return new Nt(no(this.h),Vn(this.s),Vn(this.l),ur(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=ur(this.opacity);return`${t===1?"hsl(":"hsla("}${no(this.h)}, ${Vn(this.s)*100}%, ${Vn(this.l)*100}%${t===1?")":`, ${t})`}`}}));function no(t){return t=(t||0)%360,t<0?t+360:t}function Vn(t){return Math.max(0,Math.min(1,t||0))}function Yr(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Va=t=>()=>t;function kd(t,e){return function(n){return t+n*e}}function Bd(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Nd(t){return(t=+t)==1?Ga:function(e,n){return n-e?Bd(e,n,t):Va(isNaN(e)?n:e)}}function Ga(t,e){var n=e-t;return n?kd(t,n):Va(isNaN(t)?e:t)}const ro=(function t(e){var n=Nd(e);function r(s,i){var o=n((s=ps(s)).r,(i=ps(i)).r),a=n(s.g,i.g),l=n(s.b,i.b),u=Ga(s.opacity,i.opacity);return function(c){return s.r=o(c),s.g=a(c),s.b=l(c),s.opacity=u(c),s+""}}return r.gamma=t,r})(1);function _e(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var ms=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Xr=new RegExp(ms.source,"g");function Hd(t){return function(){return t}}function $d(t){return function(e){return t(e)+""}}function Wd(t,e){var n=ms.lastIndex=Xr.lastIndex=0,r,s,i,o=-1,a=[],l=[];for(t=t+"",e=e+"";(r=ms.exec(t))&&(s=Xr.exec(e));)(i=s.index)>n&&(i=e.slice(n,i),a[o]?a[o]+=i:a[++o]=i),(r=r[0])===(s=s[0])?a[o]?a[o]+=s:a[++o]=s:(a[++o]=null,l.push({i:o,x:_e(r,s)})),n=Xr.lastIndex;return n<e.length&&(i=e.slice(n),a[o]?a[o]+=i:a[++o]=i),a.length<2?l[0]?$d(l[0].x):Hd(e):(e=l.length,function(u){for(var c=0,f;c<e;++c)a[(f=l[c]).i]=f.x(u);return a.join("")})}var so=180/Math.PI,gs={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ya(t,e,n,r,s,i){var o,a,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),t*r<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:s,translateY:i,rotate:Math.atan2(e,t)*so,skewX:Math.atan(l)*so,scaleX:o,scaleY:a}}var Gn;function Ud(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?gs:Ya(e.a,e.b,e.c,e.d,e.e,e.f)}function zd(t){return t==null||(Gn||(Gn=document.createElementNS("http://www.w3.org/2000/svg","g")),Gn.setAttribute("transform",t),!(t=Gn.transform.baseVal.consolidate()))?gs:(t=t.matrix,Ya(t.a,t.b,t.c,t.d,t.e,t.f))}function Xa(t,e,n,r){function s(u){return u.length?u.pop()+" ":""}function i(u,c,f,h,d,v){if(u!==f||c!==h){var y=d.push("translate(",null,e,null,n);v.push({i:y-4,x:_e(u,f)},{i:y-2,x:_e(c,h)})}else(f||h)&&d.push("translate("+f+e+h+n)}function o(u,c,f,h){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),h.push({i:f.push(s(f)+"rotate(",null,r)-2,x:_e(u,c)})):c&&f.push(s(f)+"rotate("+c+r)}function a(u,c,f,h){u!==c?h.push({i:f.push(s(f)+"skewX(",null,r)-2,x:_e(u,c)}):c&&f.push(s(f)+"skewX("+c+r)}function l(u,c,f,h,d,v){if(u!==f||c!==h){var y=d.push(s(d)+"scale(",null,",",null,")");v.push({i:y-4,x:_e(u,f)},{i:y-2,x:_e(c,h)})}else(f!==1||h!==1)&&d.push(s(d)+"scale("+f+","+h+")")}return function(u,c){var f=[],h=[];return u=t(u),c=t(c),i(u.translateX,u.translateY,c.translateX,c.translateY,f,h),o(u.rotate,c.rotate,f,h),a(u.skewX,c.skewX,f,h),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,h),u=c=null,function(d){for(var v=-1,y=h.length,T;++v<y;)f[(T=h[v]).i]=T.x(d);return f.join("")}}}var Vd=Xa(Ud,"px, ","px)","deg)"),Gd=Xa(zd,", ",")",")"),Ze=0,on=0,rn=0,ja=1e3,fr,an,hr=0,Pe=0,Or=0,Ln=typeof performance=="object"&&performance.now?performance:Date,Ka=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Us(){return Pe||(Ka(Yd),Pe=Ln.now()+Or)}function Yd(){Pe=0}function dr(){this._call=this._time=this._next=null}dr.prototype=qa.prototype={constructor:dr,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Us():+n)+(e==null?0:+e),!this._next&&an!==this&&(an?an._next=this:fr=this,an=this),this._call=t,this._time=n,vs()},stop:function(){this._call&&(this._call=null,this._time=1/0,vs())}};function qa(t,e,n){var r=new dr;return r.restart(t,e,n),r}function Xd(){Us(),++Ze;for(var t=fr,e;t;)(e=Pe-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Ze}function io(){Pe=(hr=Ln.now())+Or,Ze=on=0;try{Xd()}finally{Ze=0,Kd(),Pe=0}}function jd(){var t=Ln.now(),e=t-hr;e>ja&&(Or-=e,hr=t)}function Kd(){for(var t,e=fr,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:fr=n);an=t,vs(r)}function vs(t){if(!Ze){on&&(on=clearTimeout(on));var e=t-Pe;e>24?(t<1/0&&(on=setTimeout(io,t-Ln.now()-Or)),rn&&(rn=clearInterval(rn))):(rn||(hr=Ln.now(),rn=setInterval(jd,ja)),Ze=1,Ka(io))}}function oo(t,e,n){var r=new dr;return e=e==null?0:+e,r.restart(s=>{r.stop(),t(s+e)},e,n),r}var qd=Oa("start","end","cancel","interrupt"),Zd=[],Za=0,ao=1,ys=2,Zn=3,lo=4,_s=5,Jn=6;function Lr(t,e,n,r,s,i){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;Jd(t,n,{name:e,index:r,group:s,on:qd,tween:Zd,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Za})}function zs(t,e){var n=Ut(t,e);if(n.state>Za)throw new Error("too late; already scheduled");return n}function te(t,e){var n=Ut(t,e);if(n.state>Zn)throw new Error("too late; already running");return n}function Ut(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Jd(t,e,n){var r=t.__transition,s;r[e]=n,n.timer=qa(i,0,n.time);function i(u){n.state=ao,n.timer.restart(o,n.delay,n.time),n.delay<=u&&o(u-n.delay)}function o(u){var c,f,h,d;if(n.state!==ao)return l();for(c in r)if(d=r[c],d.name===n.name){if(d.state===Zn)return oo(o);d.state===lo?(d.state=Jn,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[c]):+c<e&&(d.state=Jn,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[c])}if(oo(function(){n.state===Zn&&(n.state=lo,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=ys,n.on.call("start",t,t.__data__,n.index,n.group),n.state===ys){for(n.state=Zn,s=new Array(h=n.tween.length),c=0,f=-1;c<h;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(s[++f]=d);s.length=f+1}}function a(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(l),n.state=_s,1),f=-1,h=s.length;++f<h;)s[f].call(t,c);n.state===_s&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){n.state=Jn,n.timer.stop(),delete r[e];for(var u in r)return;delete t.__transition}}function Qd(t,e){var n=t.__transition,r,s,i=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((r=n[o]).name!==e){i=!1;continue}s=r.state>ys&&r.state<_s,r.state=Jn,r.timer.stop(),r.on.call(s?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[o]}i&&delete t.__transition}}function tp(t){return this.each(function(){Qd(this,t)})}function ep(t,e){var n,r;return function(){var s=te(this,t),i=s.tween;if(i!==n){r=n=i;for(var o=0,a=r.length;o<a;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}s.tween=r}}function np(t,e,n){var r,s;if(typeof n!="function")throw new Error;return function(){var i=te(this,t),o=i.tween;if(o!==r){s=(r=o).slice();for(var a={name:e,value:n},l=0,u=s.length;l<u;++l)if(s[l].name===e){s[l]=a;break}l===u&&s.push(a)}i.tween=s}}function rp(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=Ut(this.node(),n).tween,s=0,i=r.length,o;s<i;++s)if((o=r[s]).name===t)return o.value;return null}return this.each((e==null?ep:np)(n,t,e))}function Vs(t,e,n){var r=t._id;return t.each(function(){var s=te(this,r);(s.value||(s.value={}))[e]=n.apply(this,arguments)}),function(s){return Ut(s,r).value[e]}}function Ja(t,e){var n;return(typeof e=="number"?_e:e instanceof On?ro:(n=On(e))?(e=n,ro):Wd)(t,e)}function sp(t){return function(){this.removeAttribute(t)}}function ip(t){return function(){this.removeAttributeNS(t.space,t.local)}}function op(t,e,n){var r,s=n+"",i;return function(){var o=this.getAttribute(t);return o===s?null:o===r?i:i=e(r=o,n)}}function ap(t,e,n){var r,s=n+"",i;return function(){var o=this.getAttributeNS(t.space,t.local);return o===s?null:o===r?i:i=e(r=o,n)}}function lp(t,e,n){var r,s,i;return function(){var o,a=n(this),l;return a==null?void this.removeAttribute(t):(o=this.getAttribute(t),l=a+"",o===l?null:o===r&&l===s?i:(s=l,i=e(r=o,a)))}}function cp(t,e,n){var r,s,i;return function(){var o,a=n(this),l;return a==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),l=a+"",o===l?null:o===r&&l===s?i:(s=l,i=e(r=o,a)))}}function up(t,e){var n=Mr(t),r=n==="transform"?Gd:Ja;return this.attrTween(t,typeof e=="function"?(n.local?cp:lp)(n,r,Vs(this,"attr."+t,e)):e==null?(n.local?ip:sp)(n):(n.local?ap:op)(n,r,e))}function fp(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function hp(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function dp(t,e){var n,r;function s(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&hp(t,i)),n}return s._value=e,s}function pp(t,e){var n,r;function s(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&fp(t,i)),n}return s._value=e,s}function mp(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=Mr(t);return this.tween(n,(r.local?dp:pp)(r,e))}function gp(t,e){return function(){zs(this,t).delay=+e.apply(this,arguments)}}function vp(t,e){return e=+e,function(){zs(this,t).delay=e}}function yp(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?gp:vp)(e,t)):Ut(this.node(),e).delay}function _p(t,e){return function(){te(this,t).duration=+e.apply(this,arguments)}}function wp(t,e){return e=+e,function(){te(this,t).duration=e}}function xp(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?_p:wp)(e,t)):Ut(this.node(),e).duration}function bp(t,e){if(typeof e!="function")throw new Error;return function(){te(this,t).ease=e}}function Sp(t){var e=this._id;return arguments.length?this.each(bp(e,t)):Ut(this.node(),e).ease}function Ap(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;te(this,t).ease=n}}function Ep(t){if(typeof t!="function")throw new Error;return this.each(Ap(this._id,t))}function Tp(t){typeof t!="function"&&(t=Ia(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var i=e[s],o=i.length,a=r[s]=[],l,u=0;u<o;++u)(l=i[u])&&t.call(l,l.__data__,u,i)&&a.push(l);return new he(r,this._parents,this._name,this._id)}function Cp(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,s=n.length,i=Math.min(r,s),o=new Array(r),a=0;a<i;++a)for(var l=e[a],u=n[a],c=l.length,f=o[a]=new Array(c),h,d=0;d<c;++d)(h=l[d]||u[d])&&(f[d]=h);for(;a<r;++a)o[a]=e[a];return new he(o,this._parents,this._name,this._id)}function Rp(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Mp(t,e,n){var r,s,i=Rp(e)?zs:te;return function(){var o=i(this,t),a=o.on;a!==r&&(s=(r=a).copy()).on(e,n),o.on=s}}function Op(t,e){var n=this._id;return arguments.length<2?Ut(this.node(),n).on.on(t):this.each(Mp(n,t,e))}function Lp(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Pp(){return this.on("end.remove",Lp(this._id))}function Ip(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Hs(t));for(var r=this._groups,s=r.length,i=new Array(s),o=0;o<s;++o)for(var a=r[o],l=a.length,u=i[o]=new Array(l),c,f,h=0;h<l;++h)(c=a[h])&&(f=t.call(c,c.__data__,h,a))&&("__data__"in c&&(f.__data__=c.__data__),u[h]=f,Lr(u[h],e,n,h,u,Ut(c,n)));return new he(i,this._parents,e,n)}function Fp(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Pa(t));for(var r=this._groups,s=r.length,i=[],o=[],a=0;a<s;++a)for(var l=r[a],u=l.length,c,f=0;f<u;++f)if(c=l[f]){for(var h=t.call(c,c.__data__,f,l),d,v=Ut(c,n),y=0,T=h.length;y<T;++y)(d=h[y])&&Lr(d,e,n,y,h,v);i.push(h),o.push(c)}return new he(i,o,e,n)}var Dp=Bn.prototype.constructor;function kp(){return new Dp(this._groups,this._parents)}function Bp(t,e){var n,r,s;return function(){var i=qe(this,t),o=(this.style.removeProperty(t),qe(this,t));return i===o?null:i===n&&o===r?s:s=e(n=i,r=o)}}function Qa(t){return function(){this.style.removeProperty(t)}}function Np(t,e,n){var r,s=n+"",i;return function(){var o=qe(this,t);return o===s?null:o===r?i:i=e(r=o,n)}}function Hp(t,e,n){var r,s,i;return function(){var o=qe(this,t),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(t),qe(this,t))),o===l?null:o===r&&l===s?i:(s=l,i=e(r=o,a))}}function $p(t,e){var n,r,s,i="style."+e,o="end."+i,a;return function(){var l=te(this,t),u=l.on,c=l.value[i]==null?a||(a=Qa(e)):void 0;(u!==n||s!==c)&&(r=(n=u).copy()).on(o,s=c),l.on=r}}function Wp(t,e,n){var r=(t+="")=="transform"?Vd:Ja;return e==null?this.styleTween(t,Bp(t,r)).on("end.style."+t,Qa(t)):typeof e=="function"?this.styleTween(t,Hp(t,r,Vs(this,"style."+t,e))).each($p(this._id,t)):this.styleTween(t,Np(t,r,e),n).on("end.style."+t,null)}function Up(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function zp(t,e,n){var r,s;function i(){var o=e.apply(this,arguments);return o!==s&&(r=(s=o)&&Up(t,o,n)),r}return i._value=e,i}function Vp(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,zp(t,e,n??""))}function Gp(t){return function(){this.textContent=t}}function Yp(t){return function(){var e=t(this);this.textContent=e??""}}function Xp(t){return this.tween("text",typeof t=="function"?Yp(Vs(this,"text",t)):Gp(t==null?"":t+""))}function jp(t){return function(e){this.textContent=t.call(this,e)}}function Kp(t){var e,n;function r(){var s=t.apply(this,arguments);return s!==n&&(e=(n=s)&&jp(s)),e}return r._value=t,r}function qp(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Kp(t))}function Zp(){for(var t=this._name,e=this._id,n=tl(),r=this._groups,s=r.length,i=0;i<s;++i)for(var o=r[i],a=o.length,l,u=0;u<a;++u)if(l=o[u]){var c=Ut(l,e);Lr(l,t,n,u,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new he(r,this._parents,t,n)}function Jp(){var t,e,n=this,r=n._id,s=n.size();return new Promise(function(i,o){var a={value:o},l={value:function(){--s===0&&i()}};n.each(function(){var u=te(this,r),c=u.on;c!==t&&(e=(t=c).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),u.on=e}),s===0&&i()})}var Qp=0;function he(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function tl(){return++Qp}var se=Bn.prototype;he.prototype={constructor:he,select:Ip,selectAll:Fp,selectChild:se.selectChild,selectChildren:se.selectChildren,filter:Tp,merge:Cp,selection:kp,transition:Zp,call:se.call,nodes:se.nodes,node:se.node,size:se.size,empty:se.empty,each:se.each,on:Op,attr:up,attrTween:mp,style:Wp,styleTween:Vp,text:Xp,textTween:qp,remove:Pp,tween:rp,delay:yp,duration:xp,ease:Sp,easeVarying:Ep,end:Jp,[Symbol.iterator]:se[Symbol.iterator]};function tm(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var em={time:null,delay:0,duration:250,ease:tm};function nm(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function rm(t){var e,n;t instanceof he?(e=t._id,t=t._name):(e=tl(),(n=em).time=Us(),t=t==null?null:t+"");for(var r=this._groups,s=r.length,i=0;i<s;++i)for(var o=r[i],a=o.length,l,u=0;u<a;++u)(l=o[u])&&Lr(l,t,e,u,o,n||nm(l,e));return new he(r,this._parents,t,e)}Bn.prototype.interrupt=tp;Bn.prototype.transition=rm;function ln(t,e,n){this.k=t,this.x=e,this.y=n}ln.prototype={constructor:ln,scale:function(t){return t===1?this:new ln(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new ln(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};ln.prototype;class el{constructor(e,n={}){this.webglCanvas=e,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.options={zIndex:n.zIndex||10,pointerEvents:n.pointerEvents!==void 0?n.pointerEvents:"none",className:n.className||"letsvis-axis-overlay",...n},this.setupCanvas(),this.syncSize(),this.eventProxyEnabled=n.eventProxy!==!1,this.setupEventProxy()}setupCanvas(){Object.assign(this.canvas.style,{position:"absolute",left:"0",top:"0",pointerEvents:this.options.pointerEvents,zIndex:this.options.zIndex.toString()}),this.canvas.className=this.options.className,this.webglCanvas.parentElement&&(this.webglCanvas.parentElement.style.position="relative",this.webglCanvas.parentElement.appendChild(this.canvas))}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}destroy(){this.eventListeners&&(this.eventListeners={}),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.canvas.remove(),this.emit("destroy",null)}syncSize(){const{width:e,height:n}=this.webglCanvas;(this.canvas.width!==e||this.canvas.height!==n)&&(this.canvas.width=e,this.canvas.height=n,this.canvas.style.width=this.webglCanvas.style.width||`${this.webglCanvas.clientWidth}px`,this.canvas.style.height=this.webglCanvas.style.height||`${this.webglCanvas.clientHeight}px`);const r=window.devicePixelRatio||1;this.ctx.setTransform(r,0,0,r,0,0),this.emit("resize",{width:e,height:n})}setupEventProxy(){if(!this.eventProxyEnabled)return;["mousedown","mouseup","mousemove","click","dblclick","touchstart","touchend","touchmove","wheel"].forEach(n=>{this.canvas.addEventListener(n,r=>{const s=new r.constructor(r.type,r);this.webglCanvas.dispatchEvent(s),r.cancelable&&r.preventDefault(),r.stopPropagation()})})}on(e,n){this.eventListeners||(this.eventListeners={}),this.eventListeners[e]||(this.eventListeners[e]=[]),this.eventListeners[e].push(n)}off(e,n){!this.eventListeners||!this.eventListeners[e]||(this.eventListeners[e]=this.eventListeners[e].filter(r=>r!==n))}emit(e,n){!this.eventListeners||!this.eventListeners[e]||this.eventListeners[e].forEach(r=>r(n))}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}drawText(e,n,r,s={}){const{color:i="#000",fontSize:o=12,fontFamily:a="Arial",align:l="center",baseline:u="middle"}=s;this.ctx.font=`${o}px ${a}`,this.ctx.fillStyle=i,this.ctx.textAlign=l,this.ctx.textBaseline=u,this.ctx.fillText(e,n,r)}drawLine(e,n,r,s,i={}){const{color:o="#666",width:a=1,dash:l=[]}=i;this.ctx.strokeStyle=o,this.ctx.lineWidth=a,l.length>0&&this.ctx.setLineDash(l),this.ctx.beginPath(),this.ctx.moveTo(e,n),this.ctx.lineTo(r,s),this.ctx.stroke(),this.ctx.setLineDash([])}drawXAxis(e,n,r={}){const{padding:s=40,tickSize:i=4,majorTickInterval:o=1,showLabels:a=!0}=r,l=this.canvas.width/(window.devicePixelRatio||1),u=e([0,n.bottom])[1];this.drawLine(s,u,l-s,u,{color:"#666",width:1});for(let c=0;c<=n.right;c++){if(c%o!==0)continue;const f=e([c,0])[0];if(f<s||f>l-s)continue;const h=c%o===0;this.drawLine(f,u,f,u+i,{color:h?"#333":"#999",width:h?2:1}),a&&h&&this.drawText(c.toString(),f,u+15,{color:"#333",fontSize:12,align:"center",baseline:"top"})}}drawYAxis(e,n,r,s,i,o={}){const{padding:a=40,tickSize:l=4,showBankLabels:u=!0,showAddressLabels:c=!0,showMaxMemoryLabel:f=!0}=o,h=this.canvas.height/(window.devicePixelRatio||1),d=e([n.left,0])[0],v=e([n.right,0])[0];this.drawLine(d,a,d,h,{color:"#666",width:1});for(let y=0;y<=i;y++){const T=y*s;if(T>r)continue;const w=e([0,T])[1];if(this.drawLine(d,w,d-l,w,{color:"#333",width:2}),c&&this.drawText(this.formatMemorySize(T),d-15,w+4,{color:"#333",fontSize:12,align:"right",baseline:"middle"}),u&&y<i){const _=(e([0,s])[1]-e([0,0])[1])/2;this.drawText(`Bank ${y}`,v+10,w-10,{color:"#333",fontSize:12,align:"left",baseline:"middle"}),this.drawLine(v,w+_,v-l,w+_,{color:"#999",width:1})}}if(f){const y=e([0,r])[1];this.drawText(`Max: ${r}`,d-15,y-10,{color:"#333",fontSize:12,align:"right",baseline:"middle"})}}drawAxisTitles(e,n,r,s,i=40){const o=this.canvas.width/(window.devicePixelRatio||1),a=this.canvas.height/(window.devicePixelRatio||1),l=r([0,s.bottom])[1],u=r([s.left,0])[0];this.drawText(e,o/2,l+30,{color:"#666",fontSize:14,align:"center",baseline:"top"});const c=this.ctx;c.save();const f=u-70,h=a/2;c.translate(f,h),c.rotate(-Math.PI/2),this.drawText(n,0,0,{color:"#666",fontSize:14,align:"center",baseline:"middle"}),c.restore()}formatMemorySize(e){return e>=1024*1024?(e/(1024*1024)).toFixed(1)+"MB":e>=1024?(e/1024).toFixed(1)+"KB":e+"B"}}class nl{static operatorColors=new Map;static colorPalette=[[.12156862745098039,.4666666666666667,.7058823529411765,1],[.6823529411764706,.7803921568627451,.9098039215686274,1],[.05098039215686274,.3176470588235294,.5215686274509804,1],[.17254901960784313,.6274509803921569,.17254901960784313,1],[.596078431372549,.8745098039215686,.5411764705882353,1],[.09411764705882353,.4470588235294118,.09411764705882353,1],[.8392156862745098,.15294117647058825,.1568627450980392,1],[1,.596078431372549,.5882352941176471,1],[.6235294117647059,.10196078431372549,.10588235294117647,1],[.5803921568627451,.403921568627451,.7411764705882353,1],[.7725490196078432,.6901960784313725,.8352941176470589,1],[.40784313725490196,.26666666666666666,.5607843137254902,1],[.5490196078431373,.33725490196078434,.29411764705882354,1],[.7686274509803922,.611764705882353,.5803921568627451,1],[.37254901960784315,.2235294117647059,.19215686274509805,1],[.8901960784313725,.4666666666666667,.7607843137254902,1],[.9686274509803922,.7137254901960784,.8235294117647058,1],[.7019607843137254,.3176470588235294,.596078431372549,1],[.4980392156862745,.4980392156862745,.4980392156862745,1],[.7803921568627451,.7803921568627451,.7803921568627451,1],[.3176470588235294,.3176470588235294,.3176470588235294,1],[.7372549019607844,.7411764705882353,.13333333333333333,1],[.8588235294117647,.8588235294117647,.5529411764705883,1],[.5176470588235295,.5215686274509804,.09019607843137255,1],[.09019607843137255,.7450980392156863,.8117647058823529,1],[.6196078431372549,.8549019607843137,.8980392156862745,1],[.047058823529411764,.5803921568627451,.6392156862745098,1],[.6941176470588235,.34901960784313724,.1568627450980392,1],[.9372549019607843,.5411764705882353,.3843137254901961,1],[.5176470588235295,.24313725490196078,.10196078431372549,1],[.2,.4,.8,1],[.65,.75,.95,1],[.1,.3,.6,1],[.2,.7,.3,1],[.7,.9,.6,1],[.12,.52,.18,1],[.9,.25,.25,1],[1,.65,.65,1],[.7,.15,.15,1],[.65,.45,.85,1],[.82,.75,.9,1],[.45,.3,.65,1],[.6,.4,.35,1],[.8,.65,.6,1],[.4,.25,.2,1],[.95,.5,.8,1],[1,.75,.9,1],[.75,.35,.65,1],[.55,.55,.6,1],[.8,.8,.85,1],[.35,.35,.4,1],[.8,.8,.2,1],[.9,.9,.55,1],[.55,.55,.1,1],[.1,.8,.85,1],[.65,.9,.93,1],[.05,.6,.65,1],[.8,.5,.15,1],[.95,.7,.45,1],[.55,.35,.08,1]];static getTab20Color(e,n=1){const r=this.colorPalette,s=r[e%r.length];return[s[0],s[1],s[2],n]}static getColorForOperator(e,n=1){if(!this.operatorColors.has(e)){const i=this.operatorColors.size%this.colorPalette.length,o=[...this.colorPalette[i]];o[3]=n,this.operatorColors.set(e,o)}const s=[...this.operatorColors.get(e)];return s[3]=n,s}static getBaseColorForOperationType(e){return{compute:[.95,.95,.95,.3],load:[.95,.98,.95,.3],store:[.98,.95,.95,.3]}[e]||[.9,.9,.9,.3]}static getHighlightBorderColor(e){return(e[0]*299+e[1]*587+e[2]*114)/1e3>.5?[0,0,0,1]:[1,1,1,1]}static getGlowColor(e){return[(e[0]+.5)%1,(e[1]+.3)%1,(e[2]+.7)%1,.6]}static getHighlightColor(e,n="border"){switch(n){case"border":return this.getHighlightBorderColor(e);case"glow":return this.getGlowColor(e);case"invert":return this.getInvertedColor(e);case"saturate":return this.getSaturatedColor(e);default:return this.getDefaultHighlight(e)}}static getInvertedColor(e){return[1-e[0],1-e[1],1-e[2],1]}static getSaturatedColor(e){const[n,r,s,i]=e,o=Math.max(n,r,s),a=Math.min(n,r,s),l=o-a;if(l===0)return e;const c=(1-1.5)*l;return[Math.min(1,n+(n-a)*c/l),Math.min(1,r+(r-a)*c/l),Math.min(1,s+(s-a)*c/l),i]}static getDefaultHighlight(e){const[n,r,s]=this.rgbToHsl(e[0],e[1],e[2]),i=Math.min(.9,s+.3),o=this.hslToRgb(n,r,i);return[o[0],o[1],o[2],e[3]]}static rgbToHsl(e,n,r){e/=255,n/=255,r/=255;const s=Math.max(e,n,r),i=Math.min(e,n,r);let o,a,l=(s+i)/2;if(s===i)o=a=0;else{const u=s-i;switch(a=l>.5?u/(2-s-i):u/(s+i),s){case e:o=(n-r)/u+(n<r?6:0);break;case n:o=(r-e)/u+2;break;case r:o=(e-n)/u+4;break}o/=6}return[o,a,l]}static hslToRgb(e,n,r){let s,i,o;if(n===0)s=i=o=r;else{const a=(c,f,h)=>(h<0&&(h+=1),h>1&&(h-=1),h<.16666666666666666?c+(f-c)*6*h:h<.5?f:h<.6666666666666666?c+(f-c)*(.6666666666666666-h)*6:c),l=r<.5?r*(1+n):r+n-r*n,u=2*r-l;s=a(u,l,e+1/3),i=a(u,l,e),o=a(u,l,e-1/3)}return[Math.round(s*255),Math.round(i*255),Math.round(o*255)]}static getSelectedColor(e){return[Math.max(e[0]-.1,0),Math.max(e[1]-.1,0),Math.max(e[2]-.1,0),e[3]+.2]}static resetColorMap(){this.operatorColors.clear()}static rgbaToCss(e){return`rgba(${Math.round(e[0]*255)}, ${Math.round(e[1]*255)}, ${Math.round(e[2]*255)}, ${e[3]})`}static getBorderColorForType(e){return{compute:[.7,.7,.7,.8],load:[.5,.8,.5,.8],store:[.8,.5,.5,.8]}[e]||[.6,.6,.6,.8]}}class sm{constructor(e,n={}){if(this.canvas=typeof e=="string"?document.querySelector(e):e,!this.canvas)throw new Error("[LmemRenderer] canvas not found");if(this.canvas2d=new el(this.canvas,{zIndex:10,pointerEvents:"none",className:"letsvis-axis-overlay",eventProxy:!0}),this.gl=this.canvas.getContext("webgl2",{antialias:!1,premultipliedAlpha:!1})||this.canvas.getContext("webgl",{antialias:!1,premultipliedAlpha:!1}),!this.gl)throw console.error("WebGL not supported or canvas not available"),console.error("Canvas:",this.canvas),console.error("Canvas client dimensions:",this.canvas.clientWidth,this.canvas.clientHeight),new Error("[LmemRenderer] WebGL not supported");this.tooltipElement=n.tooltipElement||null,this.chipSpec=null,this.globalMaxMemory=0,this.memoryFootprint=0,this.programs={},this.buffers={},this.textures={},this.viewMatrix=le(),this.hoveredBlock=null,this.selectedBlocks=new Set,this.lastData=null,this.gridVertxCount=null,this.viewRange={},this.eventListeners={},this.blockColorIndexMap=new Map,this.nextColorIndex=0,this.initialized=!1,this.mouseMoveHandler=this.onMouseMove.bind(this),this.clickHandler=this.onClick.bind(this),this.zoomScale=1,this.zoomCenter=Gi(0,0),this.baseMinInteractWidth=.1,this.zoomHandler=null,this.isDragging=!1,this.lastDragPos=Ma(),this.dragStartHandler=this.onDragStart.bind(this),this.dragMoveHandler=this.onDragMove.bind(this),this.dragEndHandler=this.onDragEnd.bind(this)}async init(){if(this.initialized)return;const e=()=>{const n=window.devicePixelRatio||1,r=Math.floor(this.canvas.clientWidth*n),s=Math.floor(this.canvas.clientHeight*n);(this.canvas.width!==r||this.canvas.height!==s)&&(this.canvas.width=r,this.canvas.height=s,this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.canvas2d.syncSize(),this.lastData&&(this.calculateViewMatrix(this.lastData),this.render(this.lastData)))};e(),window.addEventListener("resize",e),await this.initShaders(),this.initBuffers(),this.initEventHandlers(),this.initialized=!0}destroy(){Object.values(this.programs).forEach(e=>this.gl.deleteProgram(e)),Object.values(this.buffers).forEach(e=>Object.values(e).forEach(n=>this.gl.deleteBuffer(n))),Object.values(this.textures).forEach(e=>this.gl.deleteTexture(e)),this.canvas2d.destroy(),this.canvas.removeEventListener("mousemove",this.mouseMoveHandler),this.canvas.removeEventListener("click",this.clickHandler),window.removeEventListener("resize",this.resizeCanvas),this.canvas.removeEventListener("mousedown",this.dragStartHandler),this.canvas.removeEventListener("mousemove",this.dragMoveHandler),this.canvas.removeEventListener("mouseup",this.dragEndHandler),this.canvas.removeEventListener("mouseleave",this.dragEndHandler),this.canvas2d.destroy(),this.eventListeners={},this.initialized=!1}on(e,n){(this.eventListeners[e]||=[]).push(n)}emit(e,...n){(this.eventListeners[e]||[]).forEach(r=>r(...n))}getColorForBlock(e){let n=0;e.lmem_type==="LMEM_WEIGHT"&&(n=20),e.lmem_type==="LMEM_OPERATION"&&(n=40),this.blockColorIndexMap.has(e.op_name)||(this.blockColorIndexMap.set(e.op_name,this.nextColorIndex),this.nextColorIndex++);const r=n+this.blockColorIndexMap.get(e.op_name),s=nl.getTab20Color(r,.7);return e.status==="failed"?[Math.min(1,s[0]*.8+.5),s[1]*.4,s[2]*.4,s[3]]:s}async initShaders(){try{console.log("开始加载着色器...");const[e,n]=await Promise.all([we.load(this.gl,"memory"),we.load(this.gl,"grid")]);if(console.log("着色器文件加载完成"),this.programs={main:we.compile(this.gl,e.vert,e.frag),grid:we.compile(this.gl,n.vert,n.frag)},!this.programs.main||!this.programs.grid)throw new Error("着色器编译失败");if(!this.gl.getProgramParameter(this.programs.main,this.gl.LINK_STATUS)){const i=this.gl.getProgramInfoLog(this.programs.main);throw new Error("主着色器链接失败: "+i)}if(!this.gl.getProgramParameter(this.programs.grid,this.gl.LINK_STATUS)){const i=this.gl.getProgramInfoLog(this.programs.grid);throw new Error("网格着色器链接失败: "+i)}console.log("着色器编译成功")}catch(e){throw console.error("着色器初始化失败:",e),e}}initBuffers(){const e=this.gl;this.buffers={blocks:{position:this.createBuffer(),size:this.createBuffer(),color:this.createBuffer(),type:this.createBuffer(),border:this.createBuffer(),unitCoord:this.createBuffer()},grid:{position:this.createBuffer(),width:this.createBuffer(),type:this.createBuffer()},quad:this.createBuffer()};const n=new Float32Array([0,0,1,0,0,1,1,0,1,1,0,1]);e.bindBuffer(e.ARRAY_BUFFER,this.buffers.blocks.unitCoord),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW);const r=new Uint16Array([0,1,2,3,4,5]);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.buffers.quad),e.bufferData(e.ELEMENT_ARRAY_BUFFER,r,e.STATIC_DRAW);const s=e.getBufferParameter(e.ELEMENT_ARRAY_BUFFER,e.BUFFER_SIZE);console.log("Quad index buffer size:",s,"bytes",s/2,"indices")}createBuffer(){const e=this.gl.createBuffer();if(!e)throw new Error("Failed to create WebGL buffer");return e}render(e,n=!1){if(!e){console.warn("Render called with null data");return}try{this.lastData=e,console.log("=== RENDER START ===");const r=window.devicePixelRatio||1,s=Math.floor(this.canvas.clientWidth*r),i=Math.floor(this.canvas.clientHeight*r);this.updateViewRangeFromMatrix(),(!this.viewRange||!n)&&this.calculateViewMatrix(e),this.uploadMemoryBuffers(e),this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.gl.clearColor(.98,.98,.98,1),this.gl.disable(this.gl.DEPTH_TEST),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.drawGrid(e),this.drawMemoryBlocks(e.allocations),this.drawAxisLabels(e),console.log("=== RENDER END ===")}catch(r){console.error("Render failed:",r)}}calculateViewMatrix(e){if(!e||!e.allocations||e.allocations.length===0){this.viewMatrix=le();return}const n=e.allocations,r=e.settings||{};let s=1/0,i=-1/0,o=1/0,a=-1/0;n.forEach(T=>{const w=T.timestep_end-T.timestep_start,_=(T.timestep_start+T.timestep_end)/2,b=w+1,x=_-b/2,M=_+b/2,k=T.addr,W=T.addr+T.size;s=Math.min(s,x),i=Math.max(i,M),o=Math.min(o,k),a=Math.max(a,W)}),r.lmem_bytes&&(this.memoryFootprint=Math.max(this.memoryFootprint,r.lmem_bytes),a=Math.max(a,this.memoryFootprint),console.log("视图矩阵maxY:",this.memoryFootprint)),i<=s&&(i=s+1);const l=i-s,u=a-o,c=l*.1,f=u*.1;let h=s-c,d=i+c,v=o-f,y=a+f;this.viewRange={left:h,right:d,bottom:v,top:y},ar(this.viewMatrix,h,d,v,y,-1,1),console.log("计算得视图矩阵viewMatrix:",this.viewMatrix)}drawMemoryBlocks(e){if(!e||e.length===0)return;const n=this.gl;n.useProgram(this.programs.main);const r=n.getUniformLocation(this.programs.main,"uViewMatrix");r&&n.uniformMatrix4fv(r,!1,this.viewMatrix);const s=n.getUniformLocation(this.programs.main,"uScreenSize");s&&n.uniform2f(s,n.canvas.width,n.canvas.height),this.setupMainShaderAttributes();const i=this.validAllocationsCount*6;n.drawArrays(n.TRIANGLES,0,i),this.disableMainAttributes()}getPatternType(e){const n={LMEM_ACTIVATION:0,LMEM_WEIGHT:1,LMEM_OPERATION:2,default:0};return n[e]||n.default}getGridRange(e){const{settings:n,allocations:r}=e,s=Math.max(this.memoryFootprint,n?.lmem_bytes||0);return{left:-.5,right:this.calculateTotalTimesteps(r)-.5,bottom:0,top:s}}generateGridData(e){const{settings:n,allocations:r}=e;let{bankSize:s,maxMemory:i,bankNum:o}=this.calculateDimensions(n);const a=this.calculateTotalTimesteps(r);i=Math.max(i,this.memoryFootprint);const l=Math.ceil(i/s);console.log("maxMemory:",i,"actualBankNum:",l);const u=[],c=[],f=[];for(let h=0;h<=a;h++)u.push(h-.5,0,h-.5,i),c.push(.5,.5),f.push(0,0);for(let h=0;h<=l;h++){const d=h*s;u.push(-.5,d,a-.5,d),c.push(.5,.5),f.push(1,1)}return u.push(-.5,e.settings?.lmem_bytes,a-.5,e.settings?.lmem_bytes),c.push(.3,.3),f.push(2,2),{vertices:new Float32Array(u),widths:new Float32Array(c),types:new Float32Array(f),vertexCount:u.length/2}}drawGrid(e){if(console.log("=== drawGrid 开始 ==="),!e){console.warn("drawGrid: data 为空");return}if(!this.programs.grid){console.warn("drawGrid: grid program 未初始化");return}const n=this.gl,r=this.generateGridData(e);console.log("buffer:",{vertices:r.vertices,widths:r.widths,types:r.types}),this.uploadGridBuffer(r),n.useProgram(this.programs.grid);const s=n.getUniformLocation(this.programs.grid,"uViewMatrix"),i=n.getUniformLocation(this.programs.grid,"uScreenSize");s&&n.uniformMatrix4fv(s,!1,this.viewMatrix),i&&n.uniform2f(i,n.canvas.width,n.canvas.height),this.setupGridShaderAttributes(),n.enable(n.BLEND),n.drawArrays(n.LINES,0,r.vertexCount),this.disableGridAttributes()}initEventHandlers(){this.canvas.addEventListener("mousemove",this.mouseMoveHandler),this.canvas.addEventListener("click",this.clickHandler),this.canvas.addEventListener("mousedown",this.dragStartHandler),this.canvas.addEventListener("mousemove",this.dragMoveHandler),this.canvas.addEventListener("mouseup",this.dragEndHandler),this.canvas.addEventListener("mouseleave",this.dragEndHandler),console.log("[Renderer] 事件监听注册完成，viewMatrix 初始值：",this.viewMatrix)}onMouseMove(e){const n=this.canvas.getBoundingClientRect(),r={x:e.clientX-n.left,y:e.clientY-n.top},s=this.screenToWorld(r),i=this.findBlockAtPosition(s);this.hoveredBlock=i,this.lastMousePos=r,this.handleHover(i),this.render(this.lastData,!0)}onClick(e){this.hoveredBlock&&this.toggleSelection(this.hoveredBlock)}toggleSelection(e){const n=this.getBlockId(e);this.selectedBlocks.has(n)?this.selectedBlocks.delete(n):this.selectedBlocks.add(n),this.emit("blockSelect",e,this.selectedBlocks)}getBlockId(e){return`${e.op_name}_${e.timestep_start}_${e.addr}`}handleHover(e){if(this.tooltipElement)if(e){this.tooltipElement.innerHTML=this.createTooltipContent(e),this.tooltipElement.classList.add("show");const n=this.canvas.getBoundingClientRect(),r=window.devicePixelRatio||1;this.tooltipElement.style.left=`${this.lastMousePos.x/r+n.left+15}px`,this.tooltipElement.style.top=`${this.lastMousePos.y/r+n.top+15}px`}else this.tooltipElement.classList.remove("show");this.emit("blockHover",e)}drawHighlights(){this.gl,this.lastData?.allocations}calculateDimensions(e){return{bankSize:e?.lmem_bank_bytes||65536,maxMemory:e?.lmem_bytes||1024*1024,bankNum:e?.lmem_banks||Math.ceil(maxMemory/bankSize)}}uploadBufferData(e,n,r=!1){const s=this.gl,i=r?this.buffers.grid[e]:this.buffers.blocks[e];if(!i){console.error(`[LmemRenderer] Buffer ${e} not found`);return}s.bindBuffer(s.ARRAY_BUFFER,i),s.bufferData(s.ARRAY_BUFFER,n,s.STATIC_DRAW)}webglToScreen(e,n){const[r,s]=n,i=window.devicePixelRatio||1,o=((r-e[12]/e[0])/(2/e[0])+.5)*canvas.width/i,a=(.5-s/(2*e[5]))*canvas.height/i;return[o,a]}formatMemorySize(e){return e<1024?e+" B":e<1024*1024?(e/1024).toFixed(1)+" KB":(e/(1024*1024)).toFixed(1)+" MB"}resetZoom(){this.calculateViewMatrix(this.lastData),this.render(this.lastData,!1)}setGlobalMaxMemory(e){this.globalMaxMemory=Math.max(e,this.globalMaxMemory),console.log("设置全局最大内存:",e)}setMemoryFootprint(e){this.memoryFootprint=Math.max(e,0),console.log("设置内存占用:",e)}findBlockAtPosition(e){if(!this.lastData)return null;const[n,r]=e,s=this.calculateTotalTimesteps(this.lastData.allocations),i=this.baseMinInteractWidth/this.zoomScale;for(let o=this.lastData.allocations.length-1;o>=0;o--){const a=this.lastData.allocations[o];let l,u;a.hold_in_lmem?(l=0,u=s):(l=a.timestep_start,u=a.timestep_end);let c,f;if(l<=u){const v=u-l,y=(l+u)/2,T=v+1,w=Math.max(T,i);c=y-w/2,f=y+w/2}else{const v=s-l,y=(l+s-1)/2,w=Math.max(v,i);c=y-w/2,f=y+w/2;const _=n>=c&&n<=f,b=r>=a.addr&&r<=a.addr+a.size;if(_&&b)return a;const x=u+1,M=u/2,W=Math.max(x,i);c=M-W/2,f=M+W/2}const h=n>=c&&n<=f,d=r>=a.addr&&r<=a.addr+a.size;if(h&&d)return a}return null}createTooltipContent(e){const n=e.size/1024;return`
            <div class="tooltip-title">${e.op_name}</div>
            <div><span>Block ID:</span> ${e.id||"N/A"}</div>
            <div><span>Timestep:</span> ${e.timestep_start} → ${e.timestep_end}</div>
            <div><span>Address:</span> 0x${e.addr.toString(16)} - 0x${(e.addr+e.size).toString(16)}</div>
            <div><span>Size:</span> ${e.size}B (${n.toFixed(1)} KB)</div>
            <div><span>Op Type:</span> ${e.op_type||"N/A"}</div>
            <div><span>LMEM Type:</span> ${e.lmem_type}</div>
            <div><span>Hold_in_Lmem:</span> ${e.hold_in_lmem}</div>
            <div><span>Status:</span> <span style="color: ${e.status==="success"?"green":"red"}">${e.status}</span></div>
        `}manageShaderAttributes(e,n,r=!0){const s=this.gl;for(const[i,o]of Object.entries(n)){const a=s.getAttribLocation(e,i);if(a===-1){console.warn(`Attribute ${i} not found in shader`);continue}if(r){s.bindBuffer(s.ARRAY_BUFFER,o),s.enableVertexAttribArray(a);let l,u;if(i==="aPosition")l=2,u=s.FLOAT;else if(i==="aColor")l=4,u=s.FLOAT;else if(i==="aSize")l=2,u=s.FLOAT;else if(i==="aLineWidth"||i==="aType"||i==="aBorder"||i==="aLineType")l=1,u=s.FLOAT;else if(i==="aUnitCoord")l=2,u=s.FLOAT;else{console.warn(`Unknown attribute type: ${i}`);continue}s.vertexAttribPointer(a,l,u,!1,0,0)}else s.disableVertexAttribArray(a)}}setupMainShaderAttributes(){this.gl;const e=this.programs.main;if(!e)throw new Error("[LmemRenderer] main program not initialized");const n={aPosition:this.buffers.blocks.position,aSize:this.buffers.blocks.size,aColor:this.buffers.blocks.color,aType:this.buffers.blocks.type,aBorder:this.buffers.blocks.border,aUnitCoord:this.buffers.blocks.unitCoord};this.manageShaderAttributes(e,n,!0)}disableMainAttributes(){this.gl;const e=this.programs.main;if(!e)return;const n={aPosition:null,aSize:null,aColor:null,aType:null,aBorder:null,aUnitCoord:null};this.manageShaderAttributes(e,n,!1)}setupGridShaderAttributes(){this.gl;const e=this.programs.grid;if(!e)throw new Error("[LmemRenderer] grid program not initialized");const n={aPosition:this.buffers.grid.position,aLineWidth:this.buffers.grid.width,aLineType:this.buffers.grid.type};this.manageShaderAttributes(e,n,!0)}disableGridAttributes(){this.gl;const e=this.programs.grid;if(!e)return;const n={aPosition:null,aLineWidth:null,aLineType:null};this.manageShaderAttributes(e,n,!1)}uploadMemoryBuffers(e){if(!e||!e.allocations)return;this.gl;const n=e.allocations,r=this.calculateTotalTimesteps(n);console.log("总时间步数:",r);const s=n.filter(c=>{const f=c.timestep_start,h=c.timestep_end,d=f>=0&&h>=0&&c.size>0&&(f<=h||f>h&&r>0);return d||console.warn("跳过无效的内存块:",c),d});console.log(`原始分配数: ${n.length}, 有效分配数: ${s.length}`);const i=[],o=[],a=[],l=[],u=[];console.log("=== 顶点坐标调试 (包含循环时间步) ==="),s.forEach((c,f)=>{const h=this.getColorForBlock(c),d=this.getPatternType(c.lmem_type),v=c.status==="failed"?1:0;let y,T;c.hold_in_lmem?(y=0,T=r):(y=c.timestep_start,T=c.timestep_end);const w=c.addr,_=c.addr+c.size;if(y<=T){const b=T-y,x=(y+T)/2,M=b+1,k=x-M/2,W=x+M/2;this.addRectangleVertices(i,o,a,l,u,k,w,W,_,h,d,v)}else{const b=r-y,x=(y+r-1)/2,M=b,k=x-M/2,W=x+M/2,st=T+1,ft=T/2,lt=st,mt=ft-lt/2,xt=ft+lt/2;this.addRectangleVertices(i,o,a,l,u,k,w,W,_,h,d,v),this.addRectangleVertices(i,o,a,l,u,mt,w,xt,_,h,d,v)}}),this.uploadBufferData("position",new Float32Array(i)),this.uploadBufferData("color",new Float32Array(o)),this.uploadBufferData("type",new Float32Array(a)),this.uploadBufferData("border",new Float32Array(l)),this.uploadBufferData("unitCoord",new Float32Array(u)),this.validAllocationsCount=i.length/6}addRectangleVertices(e,n,r,s,i,o,a,l,u,c,f,h){Math.abs(l-o)<.001&&(l=o+(l>o?.001:-.001)),Math.abs(u-a)<.001&&(u=a+(u>a?.001:-.001)),e.push(o,a),e.push(l,a),e.push(o,u),e.push(l,a),e.push(l,u),e.push(o,u);for(let y=0;y<6;y++)n.push(...c),r.push(f),s.push(h),i.push(0,0,1,0,0,1,1,0,1,1,0,1)}calculateTotalTimesteps(e=[]){if(e.length===0)return 1;let n=0;return e.forEach(r=>{r.timestep_start<=r.timestep_end?n=Math.max(n,r.timestep_end):n=Math.max(n,r.timestep_start)}),n+1}uploadGridBuffer(e){this.gl,this.uploadBufferData("position",e.vertices,!0),this.uploadBufferData("width",e.widths,!0),this.uploadBufferData("type",e.types,!0),this.gridVertexCount=e.vertexCount,console.log("网格数据上传完成:",{顶点数量:e.vertexCount,位置数据长度:e.vertices.length,线宽数据长度:e.widths.length,类型数据长度:e.types.length})}drawAxisLabels(e){if(!e)return;const n=this.getGridRange(e),{bankSize:r,maxMemory:s,bankNum:i}=this.calculateDimensions(e.settings),o=this.memoryFootprint?Math.ceil(this.memoryFootprint/r):i,a=Math.max(s,this.memoryFootprint);this.canvas2d.clear();const l=u=>this.worldToScreen(u);this.canvas2d.drawXAxis(l,n,{majorTickInterval:1,padding:25}),this.canvas2d.drawYAxis(l,n,a,r,o,{padding:25,showBankLabels:!0,showAddressLabels:!0}),this.canvas2d.drawAxisTitles("Time Step","Memory Address",l,n,40)}worldToScreen([e,n]){const{left:r,right:s,bottom:i,top:o}=this.viewRange,a=(e-r)/(s-r)*this.canvas.width,l=(n-i)/(o-i)*this.canvas.height,u=window.devicePixelRatio||1;return[a/u,(this.canvas.height-l)/u]}screenToWorld({x:e,y:n}){const r=window.devicePixelRatio||1,s=e*r,i=this.canvas.height-n*r,{left:o,right:a,bottom:l,top:u}=this.viewRange,c=o+s/this.canvas.width*(a-o),f=l+i/this.canvas.height*(u-l);return[c,f]}updateViewRangeFromMatrix(){const e=this.viewMatrix,n=(-1-e[12])/e[0],r=(1-e[12])/e[0],s=(-1-e[13])/e[5],i=(1-e[13])/e[5];this.viewRange={left:n,right:r,bottom:s,top:i}}onDragStart(e){if(e.button!==0)return;this.isDragging=!0;const n=this.canvas.getBoundingClientRect();$f(this.lastDragPos,e.clientX-n.left,e.clientY-n.top),this.canvas.style.cursor="grabbing"}onDragMove(e){if(!this.isDragging||!this.lastData)return;const n=this.canvas.getBoundingClientRect(),r=Gi(e.clientX-n.left,e.clientY-n.top),s=window.devicePixelRatio||1,i=(r[0]-this.lastDragPos[0])*s,o=(r[1]-this.lastDragPos[1])*s,a=this.viewRange.right-this.viewRange.left,l=this.viewRange.top-this.viewRange.bottom,u=-i/this.canvas.width*a,c=o/this.canvas.height*l;this.viewRange.left+=u,this.viewRange.right+=u,this.viewRange.bottom+=c,this.viewRange.top+=c,ar(this.viewMatrix,this.viewRange.left,this.viewRange.right,this.viewRange.bottom,this.viewRange.top,-1,1),Hf(this.lastDragPos,r),this.render(this.lastData,!0)}onDragEnd(){this.isDragging=!1,this.canvas.style.cursor="default"}}class im{constructor(e){if(this.canvas=e,this.gl=this.canvas.getContext("webgl2")||this.canvas.getContext("webgl"),!this.gl)throw new Error("WebGL not supported");this.canvas2d=new el(this.canvas,{zIndex:10,pointerEvents:"none",className:"letsvis-summary-overlay"}),this.lastData=null,this.programs={},this.buffers={},this.viewMatrix=le(),this.currentStepStats=null,this.currentData=null,this.vertexCount=0,this.viewRange={},this.gridRange={},this.initialized=!1,this.config={barWidth:.8,barColor:[.682,.78,.91,1],padding:{left:60,right:20,top:20,bottom:40},axisColor:"#333333",gridColor:"rgba(0, 0, 0, 0.1)",labelFont:"12px Arial, sans-serif"}}async init(){if(this.initialized)return;await this.initShaders(),this.initBuffers();const e=()=>{const n=window.devicePixelRatio||1,r=Math.floor(this.canvas.clientWidth*n),s=Math.floor(this.canvas.clientHeight*n);(this.canvas.width!==r||this.canvas.height!==s)&&(this.canvas.width=r,this.canvas.height=s,this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.canvas2d.syncSize(),this.lastData&&(this.updateViewMatrix(this.lastData),this.render(this.lastData)))};e(),window.addEventListener("resize",e),this.initialized=!0,console.log("[SummaryRenderer] 初始化完成")}destroy(){const e=this.gl;Object.values(this.programs).forEach(n=>e.deleteProgram(n)),Object.values(this.buffers).forEach(n=>{Object.values(n).forEach(r=>e.deleteBuffer(r))}),window.removeEventListener("resize",this.resizeCanvas),this.canvas2d.destroy(),this.initialized=!1}render(e){if(!e){console.warn("[SummaryRenderer] No summary data provided");return}let n=[];if(Array.isArray(e))console.warn("[SummaryRenderer] Received StepStatistics Array, need summary of this setting");else if(e.stepStatistics&&Array.isArray(e.stepStatistics))n=e.stepStatistics;else if(e.groups&&Array.isArray(e.groups)){console.warn("[SummaryRenderer] Received global summary, need specific group data");return}if(n.length===0){console.warn("[SummaryRenderer] No step statistics to render");return}this.lastData=e,this.currentData=e;try{this.updateViewMatrix(e),this.uploadData(e);const r=this.gl;r.viewport(0,0,this.canvas.width,this.canvas.height),r.clearColor(1,1,1,1),r.disable(r.DEPTH_TEST),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),this.drawBars(),this.drawGrid(e),r.flush(),this.canvas2d.clear(),this.draw2DElements()}catch(r){console.error("[SummaryRenderer] Rendering failed:",r)}}async initShaders(){try{const[e,n]=await Promise.all([we.load(this.gl,"summary"),we.load(this.gl,"grid")]);this.programs={summary:we.compile(this.gl,e.vert,e.frag),grid:we.compile(this.gl,n.vert,n.frag)}}catch(e){throw console.error("着色器初始化失败:",e),e}}initBuffers(){this.gl,this.buffers={grid:{position:this.createBuffer()},summary:{position:this.createBuffer(),color:this.createBuffer()}}}createBuffer(){const e=this.gl.createBuffer();if(!e)throw new Error("Failed to create WebGL buffer");return e}updateViewMatrix(e){const n=e.stepStatistics;if(!n||n.length===0)return;const{barWidth:r,padding:s}=this.config;let i=1/0,o=-1/0,a=0,l=-1/0;n.forEach(x=>{const M=x.step;i=Math.min(i,M-r/2),o=Math.max(o,M+r/2),l=Math.max(l,x.usedMemory||0)});const c=(o-i||1)*.1,f=i-c,h=o+c,d=e.summary.maxMemoryUsage;l=Math.max(l,d*.8);const y=this.canvas.clientHeight-s.bottom-s.top,T=l-a||1,w=y/T,_=a-s.bottom/w,b=l+s.top/w;ar(this.viewMatrix,f,h,_,b,-1,1),this.viewRange={left:f,right:h,bottom:_,top:b},console.log("[对齐] viewRange",this.viewRange)}uploadData(e){const n=e.stepStatistics,r=this.gl,{barWidth:s,barColor:i}=this.config,o=[],a=[];n.forEach(l=>{const u=l.step,c=u-s/2,f=u+s/2,h=0,d=l.usedMemory||0;o.push(c,h,f,h,c,d,f,h,f,d,c,d),l.step<3&&console.log("[对齐] 矩形中心坐标：",u,h);for(let v=0;v<6;v++)a.push(...i)}),r.bindBuffer(r.ARRAY_BUFFER,this.buffers.summary.position),r.bufferData(r.ARRAY_BUFFER,new Float32Array(o),r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,this.buffers.summary.color),r.bufferData(r.ARRAY_BUFFER,new Float32Array(a),r.STATIC_DRAW),this.vertexCount=o.length/2}drawBars(){const e=this.gl,n=this.programs.summary;if(!n)return;e.useProgram(n);const r=e.getUniformLocation(n,"uViewMatrix");e.uniformMatrix4fv(r,!1,this.viewMatrix);const s=e.getAttribLocation(n,"aPosition");e.bindBuffer(e.ARRAY_BUFFER,this.buffers.summary.position),e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,0,0);const i=e.getAttribLocation(n,"aColor");e.bindBuffer(e.ARRAY_BUFFER,this.buffers.summary.color),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,4,e.FLOAT,!1,0,0),e.drawArrays(e.TRIANGLES,0,this.vertexCount)}drawGrid(e){if(!this.currentData||!this.programs.grid)return;const n=this.gl,r=this.generateGridData(e);n.bindBuffer(n.ARRAY_BUFFER,this.buffers.grid.position),n.bufferData(n.ARRAY_BUFFER,new Float32Array(r.vertices),n.STATIC_DRAW),n.useProgram(this.programs.grid);const s=n.getUniformLocation(this.programs.grid,"uViewMatrix");n.uniformMatrix4fv(s,!1,this.viewMatrix);const i=n.getUniformLocation(this.programs.grid,"uColor");n.uniform4fv(i,[0,0,0,.1]);const o=n.getAttribLocation(this.programs.grid,"aPosition");n.bindBuffer(n.ARRAY_BUFFER,this.buffers.grid.position),n.enableVertexAttribArray(o),n.vertexAttribPointer(o,2,n.FLOAT,!1,0,0),n.drawArrays(n.LINES,0,r.vertexCount),n.disableVertexAttribArray(o)}generateGridData(e){if(!this.currentData)return{vertices:[],vertexCount:0};this.gridRange=this.getGridRange(e);const{left:n,right:r,bottom:s,top:i}=this.gridRange,o=[],a=this.calculateGridStep(s,i);for(let l=0;l<=i;l+=a)o.push(n,l,r,l);return{vertices:o,vertexCount:o.length/2}}calculateGridStep(e,n){const r=n-e||1,s=Math.floor(Math.log10(r)),i=Math.pow(10,s);return r/i>20?i*5:r/i>10?i*2:i}getGridRange(e){const n=e.summary.maxMemoryUsage;return{left:-1,right:e.stepStatistics.length,bottom:0,top:n}}draw2DElements(){if(!this.currentData)return;const e=this.canvas2d.ctx;e.save(),e.strokeStyle=this.config.axisColor,e.fillStyle=this.config.axisColor,e.lineWidth=1,e.font=this.config.labelFont,e.textAlign="center",e.textBaseline="middle",this.drawAxes(e),this.drawAxisLabels(e),this.drawMemoryLabels(e),e.restore()}drawAxes(e){const{left:n,right:r,bottom:s,top:i}=this.gridRange;console.log("[对齐] summary网格范围",this.gridRange);const o=this.worldToScreen([n,s]),a=this.worldToScreen([r,s]),l=this.worldToScreen([n,i]);console.log("[对齐] x 轴， y轴:",o,a,l),e.fillStyle="black",e.fillRect(0,0,1,1),e.beginPath(),e.moveTo(o[0],o[1]),e.lineTo(a[0],a[1]),e.stroke(),e.beginPath(),e.moveTo(o[0],o[1]),e.lineTo(o[0],l[1]),e.stroke()}drawAxisLabels(e){const{left:n,bottom:r,top:s}=this.viewRange;console.log("[对齐] viewRange 轴绘制",this.viewRange),this.currentData.stepStatistics.forEach(o=>{const a=this.worldToScreenLx([o.step,r]);e.beginPath(),e.moveTo(a[0],a[1]),e.lineTo(a[0],a[1]+5),e.stroke(),e.fillText(o.step.toString(),a[0],a[1]+15)});const i=this.calculateGridStep(0,s);for(let o=0;o<=s;o+=i){const a=this.worldToScreenLy([n,o]);console.log("[对齐] y轴坐标",a),e.beginPath(),e.moveTo(a[0],a[1]),e.lineTo(a[0]-5,a[1]),e.stroke(),e.textAlign="right",e.fillText(this.formatMemoryValue(o),a[0]-8,a[1]),e.textAlign="center"}}drawMemoryLabels(e){const{barWidth:n}=this.config;e.save(),e.font="10px sans-serif",e.textAlign="center",e.fillStyle="#000",this.currentData.stepStatistics.forEach(r=>{if(r.usedMemory>0){const s=this.worldToScreen([r.step,r.usedMemory]);e.fillText(this.formatMemoryValue(r.usedMemory),s[0],s[1]-8)}}),e.restore()}worldToScreen([e,n]){const{left:r,right:s,bottom:i,top:o}=this.viewRange,a=this.canvas.clientWidth,l=this.canvas.clientHeight,u=(e-r)/(s-r)*2-1,c=(n-i)/(o-i)*2-1,f=(u+1)*a/2,h=(c+1)*l/2;return[f,l-h]}worldToScreenLx([e,n]){const{left:r,right:s,bottom:i,top:o}=this.viewRange,a=this.canvas.clientWidth,l=this.canvas.clientHeight,u=(e-r)/(s-r)*2-1,c=(n-i)/(o-i)*2-1,f=(u+1)*a/2,h=(c+1)*l/2+this.config.padding.bottom;return[f,l-h]}worldToScreenLy([e,n]){const{left:r,right:s,bottom:i,top:o}=this.viewRange,a=this.canvas.clientWidth,l=this.canvas.clientHeight,u=(e-r)/(s-r)*2-1,c=(n-i)/(o-i)*2-1,f=(u+1)*a/2+this.config.padding.left,h=(c+1)*l/2;return[f,l-h]}formatMemoryValue(e){if(e===0)return"0 B";const n=["B"];let r=0,s=e;for(;s>=1024&&r<n.length-1;)s/=1024,r++;const i=s<10?2:s<100?1:0;return`${s.toFixed(i)} ${n[r]}`}}class om{constructor(e,n){this.canvas=e,this.viewMatrix=n,this.scale=1,this.maxScale=5,this.minScale=.2,this.onZoom=null,this.init()}init(){this.wheelHandler=e=>{e.preventDefault();const n=-Math.sign(e.deltaY)*.1;this.zoom(1+n,e.clientX,e.clientY)},this.canvas.addEventListener("wheel",this.wheelHandler)}zoom(e,n,r){const s=this.scale*e;if(s<this.minScale||s>this.maxScale)return;const i=this.canvas.getBoundingClientRect(),o=i.width,a=i.height,l=(n-i.left)/o*2-1,u=1-(r-i.top)/a*2,c=le();Ra(c,this.viewMatrix);const f=Wf([0,0],[l,u],c);hs(this.viewMatrix,this.viewMatrix,[f[0],f[1],0]),kf(this.viewMatrix,this.viewMatrix,[e,e,1]),hs(this.viewMatrix,this.viewMatrix,[-f[0],-f[1],0]),this.scale=s,this.onZoom&&typeof this.onZoom=="function"&&this.onZoom(this.scale)}destroy(){this.canvas.removeEventListener("wheel",this.wheelHandler)}}const am={class:"file-selector"},lm={key:0,class:"status"},cm={__name:"file-selector",emits:["file-loaded"],setup(t,{emit:e}){const n=it("📁 选择日志"),r=it(""),s=e,i=new Worker(URL.createObjectURL(new Blob([`(function () {
  'use strict';

  /**\r
   * 从原始日志中提取有效段落\r
   * @param {string} rawLog 原始日志文本\r
   * @returns {{\r
   *   lmemSections: string[],\r
   *   timestepSections: string[],\r
   *   chip: Object\r
   * }}\r
   */\r
  function extractValidSections(rawLog) {\r
    const sections = rawLog.split(/(?=; action = \\w+)/g);\r
\r
    /* 1. 芯片规格段落（只取第一条） */\r
    const chipSection = sections.find(sec =>\r
      sec.includes('; action = lmem_assign') && sec.includes('; step = lmem_spec')\r
    );\r
\r
    /* 2. 解析芯片字段 */\r
    const chip = {};\r
    if (chipSection) {\r
      const regex = /;\\s*(\\w+)\\s*=\\s*([^;]+)/gi;\r
      let m;\r
      while ((m = regex.exec(chipSection)) !== null) {\r
        const [, key, val] = m;\r
        if (['lmem_bytes', 'lmem_banks', 'lmem_bank_bytes'].includes(key)) {\r
          chip[key] = Number(val.trim());\r
        }\r
      }\r
      console.log('[extractValidSections] 芯片信息:', chip);\r
    }\r
\r
    /* 3. lmem_assign + iteration_result 段落（不含芯片段落） */\r
    const lmemSections = sections.filter(\r
      sec =>\r
        sec.includes('; action = lmem_assign') &&\r
        sec.includes('; tag = iteration_result') &&\r
        !sec.includes('; step = lmem_spec')\r
    );\r
\r
    /* 4. timestep  */\r
    const timestepSections = sections\r
      .filter(\r
        sec =>\r
          sec.includes('; action = timestep_assign') &&\r
          sec.includes('; tag = final_result')\r
      )\r
      .slice(-1);  // 只取最后一个\r
\r
    return { lmemSections, timestepSections, chip };\r
  }

  class LmemParser {\r
    static FIELDS_WHITELIST = new Set([\r
      'op_name',\r
      'op_type',\r
      'addr',\r
      'size',\r
      'timestep_start',\r
      'timestep_end',\r
      'lmem_type',\r
      'hold_in_lmem',\r
      //'allow_bank_conflict',\r
      //'one_loop',\r
      //'shape_secs',\r
      'status',\r
      'tag',\r
      'bank_id',\r
    ]);\r
    constructor() {\r
      this.maxTimestepGlobal = 0;\r
    }\r
\r
  getGlobalMaxTimestep() {\r
    return this.maxTimestepGlobal;\r
  }\r
\r
    /**\r
     * 解析并处理LMEM分配数据\r
     * @param {string[]} lmemSections 预处理后的 LMEM 日志段落数组\r
     * @returns {{settings: Object, allocations: LmemAllocation[]}[]}\r
     */\r
    parse(lmemSections) {\r
      const rawGroups = this._groupBySettings(lmemSections);\r
      return this._processAllocationGroups(rawGroups);\r
    }\r
\r
    // 按配置分组原始数据\r
    _groupBySettings(sections) {\r
      const groups = [];\r
      let currentGroup = null;\r
\r
      sections.forEach(section => {\r
        const { entry, settings } = this._parseSection(section);\r
        if(!entry) return;\r
\r
        // 新配置组检测\r
        if (!currentGroup || !this._isSameSettings(currentGroup.settings, settings)) {\r
          currentGroup = { settings, allocations: [] };\r
          groups.push(currentGroup);\r
        }\r
\r
        currentGroup.allocations.push(entry);\r
      });\r
\r
      return groups;\r
    }\r
\r
    // 解析单个日志段落\r
    _parseSection(section) {\r
      const entry = {};\r
      const settings = {};\r
      const fieldRegex = /; (\\w+) = ([^;]+)/g;\r
      //const fieldRegex = /;\\s*(\\w+)\\s*=\\s*([^;]+)/gi;\r
\r
      let match;\r
      while ((match = fieldRegex.exec(section)) !== null) {\r
        const [_, key, rawValue] = match;\r
        const value = this._convertValue(key, rawValue.trim());\r
        \r
\r
        if (key === 'shape_secs' || key === 'allow_bank_conflict') {\r
          settings[key] = value;\r
        }\r
\r
        if (this.constructor.FIELDS_WHITELIST.has(key)) {\r
          entry[key] = value;\r
        }\r
      }\r
\r
      return {\r
        entry: this._validateEntry(entry),\r
        settings\r
      };\r
    }\r
\r
    // 处理分组数据（包含失败分配的重定位）\r
    _processAllocationGroups(groups) {\r
      return groups.map(group => {\r
        const { settings, allocations } = group;\r
        const { success, failed } = this._splitByStatus(allocations);\r
\r
        // 计算成功分配的最大地址\r
        const maxAddr = success.reduce((max, alloc) => \r
          Math.max(max, alloc.addr + alloc.size), 0);\r
\r
        // 重定位失败分配\r
        let currentAddr = maxAddr;\r
        const relocated = failed.map(alloc => {\r
          const newAlloc = { ...alloc, addr: currentAddr };\r
          currentAddr += alloc.size;\r
          return newAlloc;\r
        });\r
\r
        // 计算最大时间步\r
        const maxTimestep = Math.max(\r
          ...success.map(a => a.timestep_end),\r
          ...failed.map(a => a.timestep_end)\r
        );\r
        // 更新全局最大时间步记录\r
        this.maxTimestepGlobal = Math.max(this.maxTimestepGlobal, maxTimestep);\r
\r
        return {\r
          settings,\r
          allocations: [\r
            ...success,\r
            ...relocated\r
          ].map(alloc => ({\r
            ...alloc,\r
            bank_id: (alloc.addr >> 16) & 0xF,\r
            max_timestep: maxTimestep\r
          }))\r
        };\r
      });\r
    }\r
\r
    // 按状态分类\r
    _splitByStatus(allocations) {\r
      return allocations.reduce((acc, alloc) => {\r
        if (alloc.status === 'success') {\r
          acc.success.push(alloc);\r
        } else {\r
          acc.failed.push(alloc);\r
        }\r
        return acc;\r
      }, { success: [], failed: [] });\r
    }\r
\r
    // 配置比较\r
    _isSameSettings(a, b) {\r
      return ['shape_secs', 'allow_bank_conflict'].every(\r
        key => JSON.stringify(a[key]) === JSON.stringify(b[key])\r
      );\r
    }\r
\r
    _convertValue(key, value) {\r
      value = value.trim();   // ← 先去掉首尾空格、换行\r
      // 布尔型字段\r
      if (['hold_in_lmem', 'allow_bank_conflict', 'one_loop'].includes(key)) {\r
        return value === '1' || value.toLowerCase() === 'true';\r
      }\r
      \r
      // 数值型字段\r
      if (value.startsWith('0x')) return parseInt(value, 16);\r
      if (!isNaN(value)) return Number(value);\r
      \r
      // 数组型字段\r
      if (key === 'shape_secs') return value.split(',').map(Number);\r
      \r
      // 字符串字段（去除引号）\r
      return value.startsWith('"') && value.endsWith('"') \r
        ? value.slice(1, -1) \r
        : value;\r
    }\r
\r
    _validateEntry(entry) {\r
      if(entry.tag === 'stamp') return null;\r
\r
      const requiredFields = [\r
        'op_name', 'addr', 'size',\r
        'timestep_start', 'timestep_end',\r
        'status', 'tag'\r
      ];\r
      \r
      return requiredFields.every(field => field in entry) &&\r
             entry.tag === 'iteration_result'\r
        ? entry\r
        : null;\r
    }\r
  }

  class TimestepParser {\r
    /**\r
     * @param {string[]} timestepSections 预处理后的Timestep段落\r
     * @returns {TimestepAssignment[]}\r
     */\r
    parse(timestepSections) {\r
      if (timestepSections.length === 0) return [];\r
      \r
      const section = timestepSections[0];\r
      const lines = section.split('\\n')\r
        .filter(line => line.includes('; ts ='));\r
      \r
      return lines.map(line => {\r
        try {\r
          return this._parseTimestepLine(line);\r
        } catch (e) {\r
          console.warn('解析timestep行失败:', e.message);\r
          return null;\r
        }\r
      }).filter(Boolean);\r
    }\r
\r
    _parseTimestepLine(line) {\r
      const tsMatch = line.match(/; ts = (\\d+);/);\r
      if (!tsMatch) throw new Error('无效的时间步格式');\r
      \r
      return {\r
        ts: parseInt(tsMatch[1]),\r
        compute: this._extractOperations(line, 'C'), // 计算操作\r
        loads: this._extractOperations(line, 'L'),   // 加载操作\r
        stores: this._extractOperations(line, 'S')   // 存储操作\r
      };\r
    }\r
\r
    _extractOperations(line, type) {\r
      if (type === 'C') {\r
        // 捕获两个括号里的字符串：C("...") 和 "..."\r
        const regex = /C\\("([^"]+)"\\)[^"]*"([^"]+)"/g;\r
        return [...line.matchAll(regex)].map(([_, id1, id2]) => ({\r
          id: \`\${id2}\`,   // 合并记录 \`\${id1} (\${id2})\`\r
          type: 'compute',\r
          operation: \`\${id1}\`\r
        }));\r
      }\r
      // type 为 L或S\r
      const regex = new RegExp(\`\${type}\\\\("([^"]+)", hold_in_lmem = (\\\\d)\\\\)->([^,\\\\]]+)\`, 'g');\r
      return [...line.matchAll(regex)].map(([_, id, hold, target]) => ({\r
        id,\r
        hold_in_lmem: parseInt(hold),\r
        target,\r
        type: type === 'C' ? 'compute' : type.toLowerCase()\r
      }));\r
    }\r
  }

  class MemoryStatistics {\r
      constructor() {\r
          this.lmemGroups = [];\r
          this.statisticsBySettings = [];\r
          this.summaryCache = null;\r
          this.tsCounts = 0;\r
      }\r
\r
      /**\r
       * 设置LMEM分组数据\r
       * @param {Array} lmemGroups - LmemParser解析后的分组数据\r
       */\r
      setLmemData(lmemGroups, tsCounts) {\r
          this.lmemGroups = lmemGroups;\r
          this.tsCounts = tsCounts;\r
          // console.log('[MemoryStatistics] 设置LMEM数据，时间步总数:', this.tsCounts);\r
          this.summaryCache = null; // 清除缓存\r
      }\r
\r
      /**\r
       * 预计算所有配置组的内存统计\r
       * @returns {Object} 包含所有配置组统计和全局摘要的缓存对象\r
       */\r
      calculateAllStatistics() {\r
          // 如果缓存存在则直接返回\r
          if (this.summaryCache) {\r
              return this.summaryCache;\r
          }\r
          \r
          this.statisticsBySettings = [];\r
          \r
          if (!this.lmemGroups.length) {\r
              console.warn('缺少LMEM数据');\r
              return this._createEmptyCache();\r
          }\r
\r
          // 为每个settings组分别计算统计\r
          for (const group of this.lmemGroups) {\r
              const groupStats = this.calculateStatisticsForGroup(group);\r
              this.statisticsBySettings.push(groupStats);\r
          }\r
          \r
          // 创建并返回缓存对象\r
          this.summaryCache = {\r
              groups: this.statisticsBySettings,\r
              globalSummary: this.calculateGlobalSummary()\r
          };\r
          \r
          return this.summaryCache;\r
      }\r
\r
      /**\r
       * 为单个settings组计算统计\r
       * @param {Object} group - 包含settings和allocations的组\r
       * @returns {Object} 该组的统计信息\r
       */\r
      calculateStatisticsForGroup(group) {\r
          const { settings, allocations } = group;\r
          \r
          // 获取该组的最大时间步\r
          const maxTimestep = this.getMaxTimestepForGroup(allocations);\r
          const stepStatistics = [];\r
\r
          // 为每个时间步计算统计\r
          for (let step = 0; step <= maxTimestep; step++) {\r
              const stepStats = this.calculateStepStatisticsForGroup(allocations, step, settings);\r
              stepStatistics.push(stepStats);\r
          }\r
\r
          return {\r
              settings: { ...settings },\r
              stepStatistics,\r
              summary: this.calculateGroupSummary(stepStatistics, allocations)\r
          };\r
      }\r
\r
      /**\r
       * 计算全局摘要信息\r
       * @returns {Object} 全局摘要\r
       */\r
      calculateGlobalSummary() {\r
          if (!this.statisticsBySettings.length) return {};\r
          \r
          // 计算所有配置组的峰值内存使用\r
          const maxMemoryUsage = Math.max(\r
              ...this.statisticsBySettings.map(group => \r
                  Math.max(...group.stepStatistics.map(step => step.usedMemory))\r
              )\r
          );\r
          \r
          // 计算所有配置组的总分配数\r
          const totalAllocations = this.statisticsBySettings.reduce(\r
              (sum, group) => sum + group.summary.totalAllocations, 0\r
          );\r
          \r
          // 计算所有配置组的平均成功率\r
          const successRates = this.statisticsBySettings.map(group => group.summary.successRate);\r
          const avgSuccessRate = successRates.reduce((sum, rate) => sum + rate, 0) / successRates.length;\r
          \r
          return {\r
              totalGroups: this.statisticsBySettings.length,\r
              maxMemoryUsage,\r
              totalAllocations,\r
              avgSuccessRate,\r
              // 可以添加更多全局指标\r
          };\r
      }\r
\r
      /**\r
       * 获取所有组的统计结果（使用缓存）\r
       * @returns {Array}\r
       */\r
      getStatistics() {\r
          if (!this.summaryCache) this.calculateAllStatistics();\r
          return this.statisticsBySettings;\r
      }\r
\r
      /**\r
       * 按settings键获取特定组的统计（使用缓存）\r
       * @param {string} settingsKey - settings的唯一标识键\r
       * @returns {Object|null}\r
       */\r
      getStatisticsBySettings(settingsKey) {\r
          if (!this.summaryCache) this.calculateAllStatistics();\r
          return this.statisticsBySettings.find(group => \r
              this.getSettingsKey(group.settings) === settingsKey\r
          ) || null;\r
      }\r
\r
      /**\r
       * 获取所有settings的对比摘要（使用缓存）\r
       * @returns {Array}\r
       */\r
      getSettingsComparison() {\r
          if (!this.summaryCache) this.calculateAllStatistics();\r
          return this.statisticsBySettings.map(group => ({\r
              settings: group.settings,\r
              settingsKey: this.getSettingsKey(group.settings),\r
              summary: group.summary\r
          }));\r
      }\r
\r
      /**\r
       * 获取全局摘要（使用缓存）\r
       * @returns {Object}\r
       */\r
      getGlobalSummary() {\r
          if (!this.summaryCache) this.calculateAllStatistics();\r
          return this.summaryCache.globalSummary;\r
      }\r
\r
      /**\r
       * 创建空缓存对象\r
       * @private\r
       */\r
      _createEmptyCache() {\r
          this.summaryCache = {\r
              groups: [],\r
              globalSummary: {}\r
          };\r
          return this.summaryCache;\r
      }\r
      /**\r
       * 获取单个组的最大时间步\r
       * @param {Array} allocations - 分配数组\r
       * @returns {number}\r
       */\r
      getMaxTimestepForGroup(allocations) {\r
          return allocations.reduce((max, alloc) => \r
              Math.max(max, alloc.timestep_end || 0, alloc.max_timestep || 0), 0\r
          );\r
      }\r
\r
      /**\r
       * 计算单个时间步的统计（针对特定settings组）\r
       * @param {Array} allocations - 分配数组\r
       * @param {number} step - 时间步\r
       * @param {Object} settings - 配置信息\r
       * @returns {Object} 时间步内存统计\r
       */\r
      calculateStepStatisticsForGroup(allocations, step, settings) {\r
          // 获取当前时间步的所有分配\r
          const stepAllocations = this.getAllocationsForTimestep(allocations, step);\r
          \r
          // 按bank分组分配\r
          const allocationsByBank = this.groupAllocationsByBank(stepAllocations);\r
\r
          return {\r
              step: step,\r
              settingsKey: this.getSettingsKey(settings),\r
              totalMemory: this.calculateTotalMemory(stepAllocations),\r
              usedMemory: this.calculateUsedMemory(stepAllocations),\r
              freeMemory: this.calculateFreeMemory(stepAllocations),\r
              memoryUsagePercentage: this.calculateUsagePercentage(stepAllocations),\r
              peakMemory: this.calculatePeakMemory(stepAllocations),\r
              allocationCount: stepAllocations.length,\r
              activeAllocations: stepAllocations.length,\r
              bankStatistics: this.calculateBankStatistics(allocationsByBank),\r
              detailedStats: this.getDetailedStatistics(stepAllocations)\r
          };\r
      }\r
\r
      /**\r
       * 生成settings的唯一标识键\r
       * @param {Object} settings - 配置信息\r
       * @returns {string}\r
       */\r
      getSettingsKey(settings) {\r
          return JSON.stringify({\r
              allow_bank_conflict: settings.allow_bank_conflict,\r
              shape_secs: settings.shape_secs\r
          });\r
      }\r
\r
      /**\r
       * 获取指定时间步的所有内存分配\r
       * @param {Array} allocations - 分配数组\r
       * @param {number} step - 时间步\r
       * @returns {Array} 该时间步的分配数组\r
       */\r
      getAllocationsForTimestep(allocations, step) {\r
          return allocations.filter(alloc => \r
              this.isAllocationActive(alloc, step)\r
          );\r
      }\r
\r
      /**\r
       * 检查分配是否在指定时间步活跃\r
       * @param {Object} allocation - 内存分配对象\r
       * @param {number} step - 时间步\r
       * @returns {boolean}\r
       */\r
      isAllocationActive(allocation, step) {\r
          if(allocation.hold_in_lmem){\r
              return true;\r
          }\r
          else if( allocation.timestep_start <= allocation.timestep_end){\r
              return allocation.timestep_start <= step && \r
                     allocation.timestep_end >= step;\r
          }\r
          else {\r
              return allocation.timestep_start <= step && this.tsCounts >= step \r
                  ||\r
                    allocation.timestep_end >= step && 0 <= step;\r
          }\r
          // return allocation.timestep_start <= step && \r
          //        allocation.timestep_end >= step;\r
      }\r
\r
      /**\r
       * 按bank分组分配\r
       * @param {Array} allocations - 分配数组\r
       * @returns {Object} 按bank分组的分配\r
       */\r
      groupAllocationsByBank(allocations) {\r
          return allocations.reduce((groups, alloc) => {\r
              const bankId = alloc.bank_id || 0;\r
              if (!groups[bankId]) {\r
                  groups[bankId] = [];\r
              }\r
              groups[bankId].push(alloc);\r
              return groups;\r
          }, {});\r
      }\r
\r
      /**\r
       * 计算bank级别的统计\r
       * @param {Object} allocationsByBank - 按bank分组的分配\r
       * @returns {Object} bank统计信息\r
       */\r
      calculateBankStatistics(allocationsByBank) {\r
          const bankStats = {};\r
          \r
          for (const [bankId, allocations] of Object.entries(allocationsByBank)) {\r
              bankStats[bankId] = {\r
                  usedMemory: this.calculateUsedMemory(allocations),\r
                  allocationCount: allocations.length,\r
                  averageAllocationSize: this.calculateAverageAllocation(allocations),\r
                  largestAllocation: this.calculateLargestAllocation(allocations)\r
              };\r
          }\r
          \r
          return bankStats;\r
      }\r
\r
      /**\r
       * 计算总内存（基于最大地址）\r
       * @param {Array} allocations - 分配数组\r
       * @returns {number}\r
       */\r
      calculateTotalMemory(allocations) {\r
          if (allocations.length === 0) return 0;\r
          \r
          // 找到最大的结束地址\r
          const maxAddr = Math.max(...allocations.map(alloc => alloc.addr + alloc.size));\r
          return maxAddr;\r
      }\r
\r
      /**\r
       * 计算已使用内存\r
       * @param {Array} allocations - 分配数组\r
       * @returns {number}\r
       */\r
      calculateUsedMemory(allocations) {\r
          return allocations.reduce((total, alloc) => total + alloc.size, 0);\r
      }\r
\r
      /**\r
       * 计算空闲内存\r
       * @param {Array} allocations - 分配数组\r
       * @returns {number}\r
       */\r
      calculateFreeMemory(allocations) {\r
          const total = this.calculateTotalMemory(allocations);\r
          const used = this.calculateUsedMemory(allocations);\r
          return Math.max(0, total - used);\r
      }\r
\r
      /**\r
       * 计算内存使用率\r
       * @param {Array} allocations - 分配数组\r
       * @returns {number}\r
       */\r
      calculateUsagePercentage(allocations) {\r
          const total = this.calculateTotalMemory(allocations);\r
          const used = this.calculateUsedMemory(allocations);\r
          return total > 0 ? (used / total) * 100 : 0;\r
      }\r
\r
      /**\r
       * 计算峰值内存（当前时间步最大单分配）\r
       * @param {Array} allocations - 分配数组\r
       * @returns {number}\r
       */\r
      calculatePeakMemory(allocations) {\r
          return allocations.length > 0 ? \r
              Math.max(...allocations.map(alloc => alloc.size)) : 0;\r
      }\r
\r
      /**\r
       * 计算平均分配大小\r
       * @param {Array} allocations - 分配数组\r
       * @returns {number}\r
       */\r
      calculateAverageAllocation(allocations) {\r
          const used = this.calculateUsedMemory(allocations);\r
          return allocations.length > 0 ? used / allocations.length : 0;\r
      }\r
\r
      /**\r
       * 计算最大分配大小\r
       * @param {Array} allocations - 分配数组\r
       * @returns {number}\r
       */\r
      calculateLargestAllocation(allocations) {\r
          return allocations.length > 0 ? \r
              Math.max(...allocations.map(alloc => alloc.size)) : 0;\r
      }\r
\r
      /**\r
       * 获取详细统计信息\r
       * @param {Array} allocations - 分配数组\r
       * @returns {Object}\r
       */\r
      getDetailedStatistics(allocations) {\r
          const successfulAllocs = allocations.filter(alloc => alloc.status === 'success');\r
          const failedAllocs = allocations.filter(alloc => alloc.status !== 'success');\r
\r
          return {\r
              successfulAllocations: successfulAllocs.length,\r
              failedAllocations: failedAllocs.length,\r
              successRate: allocations.length > 0 ? \r
                  (successfulAllocs.length / allocations.length) * 100 : 0,\r
              averageAllocationSize: this.calculateAverageAllocation(allocations),\r
              memoryFragmentation: this.calculateFragmentation(allocations),\r
              allocationTypes: this.countAllocationTypes(allocations)\r
          };\r
      }\r
\r
      /**\r
       * 计算内存碎片率\r
       * @param {Array} allocations - 分配数组\r
       * @returns {number}\r
       */\r
      calculateFragmentation(allocations) {\r
          if (allocations.length < 2) return 0;\r
          \r
          const sortedAllocs = [...allocations].sort((a, b) => a.addr - b.addr);\r
          let totalGap = 0;\r
          \r
          for (let i = 1; i < sortedAllocs.length; i++) {\r
              const prevEnd = sortedAllocs[i-1].addr + sortedAllocs[i-1].size;\r
              const gap = sortedAllocs[i].addr - prevEnd;\r
              totalGap += Math.max(0, gap);\r
          }\r
          \r
          const totalMemory = this.calculateTotalMemory(allocations);\r
          return totalMemory > 0 ? (totalGap / totalMemory) * 100 : 0;\r
      }\r
\r
      /**\r
       * 统计分配类型\r
       * @param {Array} allocations - 分配数组\r
       * @returns {Object}\r
       */\r
      countAllocationTypes(allocations) {\r
          return allocations.reduce((counts, alloc) => {\r
              const type = alloc.lmem_type || 'unknown';\r
              counts[type] = (counts[type] || 0) + 1;\r
              return counts;\r
          }, {});\r
      }\r
\r
      /**\r
       * 计算组的统计摘要\r
       * @param {Array} stepStatistics - 时间步统计数组\r
       * @param {Array} allocations - 分配数组\r
       * @returns {Object}\r
       */\r
      calculateGroupSummary(stepStatistics, allocations) {\r
          const successfulAllocs = allocations.filter(alloc => alloc.status === 'success');\r
          const failedAllocs = allocations.filter(alloc => alloc.status !== 'success');\r
\r
          return {\r
              totalAllocations: allocations.length,\r
              successfulAllocations: successfulAllocs.length,\r
              failedAllocations: failedAllocs.length,\r
              successRate: allocations.length > 0 ? \r
                  (successfulAllocs.length / allocations.length) * 100 : 0,\r
              maxMemoryUsage: Math.max(...stepStatistics.map(stat => stat.usedMemory)),\r
              averageMemoryUsage: stepStatistics.reduce((sum, stat) => sum + stat.usedMemory, 0) / stepStatistics.length,\r
              peakAllocationCount: Math.max(...stepStatistics.map(stat => stat.allocationCount)),\r
              totalMemoryFootprint: this.calculateTotalMemory(allocations)\r
          };\r
      }\r
\r
      /**\r
       * 获取所有组的统计结果\r
       * @returns {Array}\r
       */\r
      getStatistics() {\r
          return this.statisticsBySettings;\r
      }\r
\r
      /**\r
       * 按settings键获取特定组的统计\r
       * @param {string} settingsKey - settings的唯一标识键\r
       * @returns {Object|null}\r
       */\r
      getStatisticsBySettings(settingsKey) {\r
          return this.statisticsBySettings.find(group => \r
              this.getSettingsKey(group.settings) === settingsKey\r
          ) || null;\r
      }\r
\r
      /**\r
       * 获取所有settings的对比摘要\r
       * @returns {Array}\r
       */\r
      getSettingsComparison() {\r
          return this.statisticsBySettings.map(group => ({\r
              settings: group.settings,\r
              settingsKey: this.getSettingsKey(group.settings),\r
              summary: group.summary\r
          }));\r
      }\r
\r
      /**\r
       * 清空数据\r
       */\r
      clear() {\r
          this.lmemGroups = [];\r
          this.statisticsBySettings = [];\r
          this.summaryCache = null;   // 清除缓存\r
      }\r
  }

  self.onmessage = async (e) => {\r
    const rawLog = e.data;\r
    try {\r
      // 输入验证\r
      if (!rawLog || typeof rawLog !== 'string') {\r
        throw new Error('Invalid input: rawLog must be a non-empty string');\r
      }\r
\r
      // 提取有效段（分离LMEM和Timestep）\r
      const { lmemSections, timestepSections, chip } = extractValidSections(rawLog);\r
      \r
      // 独立解析结果对象\r
      const results = {\r
        lmem: null,\r
        summary: null,\r
        timestep: null,\r
        chip: chip || null\r
      };\r
      \r
      // 独立有效性标志\r
      const valid = {\r
        lmem: false,\r
        summary: false,\r
        timestep: false\r
      };\r
\r
      // 1. 独立解析LMEM数据\r
      if (lmemSections.length) {\r
        try {\r
          const lmemParser = new LmemParser();\r
          results.lmem = lmemParser.parse(lmemSections);\r
          valid.lmem = true;\r
          \r
          // 2. 独立计算Summary\r
          if (results.lmem.length) {\r
            const memoryStats = new MemoryStatistics();\r
            memoryStats.setLmemData(results.lmem, lmemParser.getGlobalMaxTimestep());\r
            const summaryCache = memoryStats.calculateAllStatistics();\r
            results.summary = summaryCache;\r
            valid.summary = true;\r
            \r
            // 将芯片信息合并到第一个settings组\r
            if (chip) {\r
              Object.assign(results.lmem[0].settings, chip);\r
            }\r
          }\r
        } catch (lmemErr) {\r
          console.error('[Worker] LMEM解析错误:', lmemErr);\r
        }\r
      }\r
\r
      // 3. 独立解析Timestep数据\r
      if (timestepSections.length) {\r
        try {\r
          const timestepParser = new TimestepParser();\r
          results.timestep = timestepParser.parse(timestepSections);\r
          valid.timestep = true;\r
        } catch (timestepErr) {\r
          console.error('[Worker] Timestep解析错误:', timestepErr);\r
        }\r
      }\r
\r
      // 检查至少有一个有效部分\r
      if (!valid.lmem && !valid.timestep) {\r
        throw new Error('No valid data sections found in the log file');\r
      }\r
\r
      // 返回结果和有效性状态\r
      self.postMessage({\r
        ...results,\r
        valid,\r
        success: true\r
      });\r
      \r
    } catch (err) {\r
      console.error('[Worker]', err);\r
      self.postMessage({ \r
        error: err.message,\r
        success: false\r
      });\r
    }\r
  };

})();
`],{type:"application/javascript"})));i.onmessage=a=>{const{success:l,error:u,valid:c,...f}=a.data;if(!l){r.value=`❌ ${u||"解析失败"}`;return}const h=[];c.lmem&&h.push("LMEM"),c.summary&&h.push("Summary"),c.timestep&&h.push("Timestep"),n.value="✅ 解析完成",r.value=`有效数据: ${h.join(", ")||"无"}`,s("file-loaded",{...f,valid:c})};async function o(a){const l=a.target.files[0];if(l){n.value="⏳ 解析中...",r.value="";try{const u=await l.text();i.postMessage(u)}catch(u){console.error(u),n.value="📁 选择日志",r.value="❌ 文件读取失败"}}}return(a,l)=>(ct(),pt("label",am,[N("input",{type:"file",accept:".log",onChange:o},null,32),N("span",null,ht(n.value),1),r.value?(ct(),pt("div",lm,ht(r.value),1)):Xe("",!0)]))}},rl=Je(cm,[["__scopeId","data-v-3d273144"]]),um={key:0,class:"comparison-slider"},fm=["value"],hm=["value"],dm={__name:"comparison-slider",props:{files:{type:Array,default:()=>[]}},emits:["compare"],setup(t,{emit:e}){const n=e,r=it(null),s=it(null);function i(){!r.value||!s.value||n("compare",{baseline:r.value,target:s.value})}return(o,a)=>t.files.length?(ct(),pt("div",um,[a[4]||(a[4]=N("span",null,"对比：",-1)),N("label",null,[a[2]||(a[2]=An(" 基准 ",-1)),ts(N("select",{"onUpdate:modelValue":a[0]||(a[0]=l=>r.value=l)},[(ct(!0),pt(Dt,null,es(t.files,l=>(ct(),pt("option",{key:l.name,value:l},ht(l.name),9,fm))),128))],512),[[ls,r.value]])]),N("label",null,[a[3]||(a[3]=An(" 目标 ",-1)),ts(N("select",{"onUpdate:modelValue":a[1]||(a[1]=l=>s.value=l)},[(ct(!0),pt(Dt,null,es(t.files,l=>(ct(),pt("option",{key:l.name,value:l},ht(l.name),9,hm))),128))],512),[[ls,s.value]])]),N("button",{onClick:i},"执行对比")])):Xe("",!0)}},pm=Je(dm,[["__scopeId","data-v-2aa7e75b"]]),mm={key:0,class:"spec-panel"},gm={key:0,class:"config-selector"},vm=["value"],ym={key:1,class:"chip-info"},_m={class:"chip-details"},wm={class:"chip-item"},xm={class:"value"},bm={class:"chip-item"},Sm={class:"value"},Am={class:"chip-item"},Em={class:"value"},Tm={class:"chip-item"},Cm={class:"value"},Rm={class:"chip-item"},Mm={class:"value"},Om={key:1,class:"spec-panel-loading"},Lm={__name:"lmem-spec-panel",props:{initialSettings:{type:Object,required:!0,default:()=>({})},availableConfigs:{type:Array,default:()=>[]},currentIndex:{type:Number,default:0}},emits:["settings-change","config-change"],setup(t,{emit:e}){const n=t,r=e;Sr(()=>{n.availableConfigs.length===0&&console.warn("No available configs provided to LmemSpecPanel")});const s=In({allow_bank_conflict:n.initialSettings?.allow_bank_conflict??0,shape_secs:n.initialSettings?.shape_secs??"1,1,1,1,1"}),i=it(typeof s.shape_secs=="string"?s.shape_secs.split(",").map(Number):[1,1,1,1,1]),o=it(n.currentIndex);mn(()=>n.initialSettings,c=>{c&&Object.keys(c).length>0&&(s.allow_bank_conflict=c.allow_bank_conflict??0,s.shape_secs=Array.isArray(c.shape_secs)?c.shape_secs.join(","):c.shape_secs,i.value=s.shape_secs.split(",").map(Number))},{deep:!0});function a(){r("config-change",o.value);const c=n.availableConfigs[o.value]?.settings;c&&l(c)}function l(c){s.allow_bank_conflict=c.allow_bank_conflict??0,s.shape_secs=Array.isArray(c.shape_secs)?c.shape_secs.join(","):c.shape_secs,i.value=s.shape_secs.split(",").map(Number)}function u(c){return c?c<1024?c+" B":c<1024*1024?(c/1024).toFixed(0)+" KB":(c/(1024*1024)).toFixed(1)+" MB":"N/A"}return(c,f)=>n.availableConfigs.length>0?(ct(),pt("div",mm,[f[8]||(f[8]=N("div",{class:"header"},[N("h3",null,"Local Memory Configuration")],-1)),n.availableConfigs.length>1?(ct(),pt("div",gm,[f[1]||(f[1]=N("label",null,"Memory Configuration:",-1)),ts(N("select",{"onUpdate:modelValue":f[0]||(f[0]=h=>o.value=h),onChange:a},[(ct(!0),pt(Dt,null,es(n.availableConfigs,(h,d)=>(ct(),pt("option",{key:d,value:d}," #"+ht(d+1)+" - allow_bank_conflict: "+ht(h.settings.allow_bank_conflict?"True":"False")+" | shape: "+ht(Array.isArray(h.settings.shape_secs)?h.settings.shape_secs.join("×"):h.settings.shape_secs),9,vm))),128))],544),[[ls,o.value]])])):Xe("",!0),n.initialSettings.lmem_bytes?(ct(),pt("div",ym,[f[7]||(f[7]=N("h4",null,"Chip Specifications",-1)),N("div",_m,[N("div",wm,[f[2]||(f[2]=N("span",{class:"label"},"Total Memory:",-1)),N("span",xm,ht(n.initialSettings.lmem_bytes,u(n.initialSettings.lmem_bytes)),1)]),N("div",bm,[f[3]||(f[3]=N("span",{class:"label"},"Banks:",-1)),N("span",Sm,ht(n.initialSettings.lmem_banks||"N/A"),1)]),N("div",Am,[f[4]||(f[4]=N("span",{class:"label"},"Bank Size:",-1)),N("span",Em,ht(n.initialSettings.lmem_bank_bytes,u(n.initialSettings.lmem_bank_bytes)),1)]),N("div",Tm,[f[5]||(f[5]=N("span",{class:"label"},"Bank Conflict:",-1)),N("span",Cm,ht(n.initialSettings.allow_bank_conflict?"Allowed":"Disallowed"),1)]),N("div",Rm,[f[6]||(f[6]=N("span",{class:"label"},"Shape Sections:",-1)),N("span",Mm,"["+ht(Array.isArray(n.initialSettings.shape_secs)?n.initialSettings.shape_secs.join(", "):n.initialSettings.shape_secs)+"]",1)])])])):Xe("",!0)])):(ct(),pt("div",Om,f[9]||(f[9]=[N("p",null,"Loading configurations...",-1)])))}},sl=Je(Lm,[["__scopeId","data-v-d54721e5"]]),Pm={class:"lmem-view"},Im={class:"toolbar"},Fm={class:"visualization-area"},Dm={class:"specs-panel"},km={__name:"lmem-view",setup(t){const e=it(null),n=it(null),r=it(null),s=it(null),i=it(null),o=it([]),a=it([]),l=it(0);let u=null,c=null,f=null;const h=it(null),d=it(null);it([]),Sr(async()=>{await Dn(),u=new sm(e.value,{tooltipElement:r.value}),await u.init(),c=new im(n.value),await c.init(),f=new om(e.value,u.viewMatrix),f.onZoom=_=>{console.log("Zoom level 在 Vue 中更新为：",_),console.log("After zoom the viewMatrix:",u.viewMatrix),u&&(u.zoomScale=_),u&&d.value&&u.render(d.value,!0)},u.on("blockSelect",handleBlockSelect),u.on("blockHover",handleBlockHover),window.addEventListener("resize",T),T()}),Ar(()=>{u?.destroy(),c?.destroy(),f?.destroy(),window.removeEventListener("resize",T)});function v(_){console.log("[LmemView] File loaded:",_);const{lmem:b,summary:x,valid:M,chip:k}=_;if(M.lmem&&b?.length){if(o.value=b,a.value=x?.groups||[],a.value.length>0&&u){const st=a.value[0]?.summary?.totalMemoryFootprint;st&&u.setMemoryFootprint(st)}if(k&&o.value.forEach(W=>{Object.assign(W.settings,k)}),l.value=0,d.value=o.value[0],u.render(d.value),a.value.length>l.value){const W=a.value[l.value];c.render(W),console.log("[SummaryData] summary 数据传递检查1：",{settings:W.settings,stepStatistics:W.stepStatistics,summary:W.summary})}else console.warn("No corresponding summary data found for config",l.value)}else console.warn("[LmemView] No valid LMEM data received")}function y(_){if(_>=0&&_<o.value.length){if(l.value=_,d.value=o.value[_],a.value.length>0&&u){const x=a.value[_]?.summary?.totalMemoryFootprint;x&&u.setMemoryFootprint(x)}if(u.render(d.value),a.value.length>_){const b=a.value[_];c.render(b),console.log("[SummaryData] summary 数据传递检查2：",{settings:b.settings,stepStatistics:b.stepStatistics,summary:b.summary})}else console.warn("No summary data for config index:",_)}}function T(){if(!s.value||!i.value)return;const{width:_,height:b}=s.value.getBoundingClientRect();e.value.width=_,e.value.height=b;const{width:x,height:M}=i.value.getBoundingClientRect();if(n.value.width=x,n.value.height=M,u&&d.value&&u.render(d.value),c&&d.value){const k=w(d.value.allocations);c.render(k)}}function w(_){if(!_?.length)return[];const b=Math.max(..._.map(M=>M.timestep_end)),x=[];for(let M=0;M<=b;M++){const k=_.filter(W=>W.timestep_start<=M&&W.timestep_end>=M).reduce((W,st)=>W+st.size,0);x.push({timestep:M,memory_used:k,memory_total:d.value?.settings?.lmem_bytes||0})}return x}return(_,b)=>(ct(),pt("div",Pm,[N("div",Im,[ot(rl,{onFileLoaded:v}),h.value?(ct(),la(pm,{key:0,data:h.value,onCompare:_.onCompare},null,8,["data","onCompare"])):Xe("",!0)]),N("div",Fm,[N("div",{class:"main",ref_key:"main",ref:s},[N("canvas",{ref_key:"canvas",ref:e,class:"lmem-canvas"},null,512),N("div",{ref_key:"tooltip",ref:r,class:"tooltip"},null,512),N("button",{class:"reset-btn",onClick:b[0]||(b[0]=x=>Oe(u)?.resetZoom()),title:"Reset zoom"},"⟲")],512),N("div",{class:"summary",ref_key:"summaryContainer",ref:i},[N("canvas",{ref_key:"summaryCanvas",ref:n,class:"summary-canvas"},null,512)],512)]),N("div",Dm,[ot(sl,{"initial-settings":d.value?.settings||{},"available-configs":o.value,"current-index":l.value,onConfigChange:y},null,8,["initial-settings","available-configs","current-index"])])]))}},Bm=Je(km,[["__scopeId","data-v-82baa55a"]]);class Nm{constructor({canvas:e,tooltipElement:n,onOperationSelect:r=()=>{},onOperationHover:s=()=>{}}){this.canvas=e,this.gl=e.getContext("webgl")||e.getContext("experimental-webgl"),this.tooltipElement=n,this.onOperationSelect=r,this.onOperationHover=s,this.program=null,this.overlayProgram=null,this.buffers={},this.uniforms={},this.overlayUniforms={},this.attributes={},this.overlayAttributes={},this.projectionMatrix=le(),this.viewMatrix=le(),this.viewProjectionMatrix=le(),this.orthoMatrix=le(),this.overlayCanvas=document.createElement("canvas"),this.overlayCtx=this.overlayCanvas.getContext("2d"),this.overlayTexture=null,this.data=null,this.zoomLevel=1,this.viewOffset=0,this.hoveredOperation=null,this.selectedOperations=new Set,this.dependencies={},this.animationFrame=null,this.lanes=[{id:"stores",label:"存储操作",color:[.882,.341,.349,1]},{id:"compute",label:"计算操作",color:[.305,.557,.655,1]},{id:"loads",label:"加载操作",color:[.949,.557,.173,1]}],this.fixedLeft=80,this.translateX=0,this.WORLD_COORDS={AXIS_Y:-3,TOP_Y:1.2,LANE_START_Y:-1.8,LANE_HEIGHT:.8,LABEL_OFFSET_X:-.5,TICK_LENGTH:.2},this.RECT_COORDS={LANE_START_Y:-1.8,LANE_HEIGHT:.8,RECT_HEIGHT_RATIO:.5,LANE_MARGIN:.2},this.timeStepBaseWidth=50,this.stepInterval=1,this.minZoom=1e-4,this.maxZoom=5,this.isDragging=!1,this.dragStartX=0,this.startViewOffset=0,this.dependencies={downstream:{},upstream:{}},this.gl?this.initWebGL():console.error("WebGL not supported"),this.bindEvents(),this.resize()}initWebGL(){const e=this.gl;this.gl.enable(this.gl.POLYGON_OFFSET_FILL),this.gl.polygonOffset(1,1),this.gl.disable(this.gl.SMOOTH),this.gl.disable(this.gl.DITHER);const n=`
      attribute vec2 aPosition;
      attribute vec4 aColor;
      uniform mat4 uViewProjectionMatrix;
      varying vec4 vColor;
      
      void main() {
        gl_Position = uViewProjectionMatrix * vec4(aPosition, 0.0, 1.0);
        vColor = aColor;
      }
    `,r=`
      precision mediump float;
      varying vec4 vColor;
      
      void main() {
        gl_FragColor = vColor ;
      }
    `;this.program=this.createProgram(n,r);const s=`
      attribute vec2 aPosition;
      attribute vec2 aTexCoord;
      varying vec2 vTexCoord;
      
      void main() {
        gl_Position = vec4(aPosition, 0.0, 1.0);
        vTexCoord = aTexCoord;
      }
    `,i=`
      precision mediump float;
      varying vec2 vTexCoord;
      uniform sampler2D uTexture;
      
      void main() {
        gl_FragColor = texture2D(uTexture, vTexCoord);
      }
    `;this.overlayProgram=this.createProgram(s,i),e.useProgram(this.program),this.uniforms.viewProjectionMatrix=e.getUniformLocation(this.program,"uViewProjectionMatrix"),this.attributes.position=e.getAttribLocation(this.program,"aPosition"),this.attributes.color=e.getAttribLocation(this.program,"aColor"),e.useProgram(this.overlayProgram),this.overlayUniforms.texture=e.getUniformLocation(this.overlayProgram,"uTexture"),this.overlayAttributes.position=e.getAttribLocation(this.overlayProgram,"aPosition"),this.overlayAttributes.texCoord=e.getAttribLocation(this.overlayProgram,"aTexCoord"),this.buffers.operations=e.createBuffer(),this.buffers.lanes=e.createBuffer(),this.buffers.overlay=e.createBuffer(),this.buffers.overlayTexCoords=e.createBuffer(),this.overlayTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.overlayTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA)}createProgram(e,n){const r=this.gl,s=this.compileShader(r.VERTEX_SHADER,e),i=this.compileShader(r.FRAGMENT_SHADER,n),o=r.createProgram();if(r.attachShader(o,s),r.attachShader(o,i),r.linkProgram(o),!r.getProgramParameter(o,r.LINK_STATUS))throw new Error("Program linking error: "+r.getProgramInfoLog(o));return o}compileShader(e,n){const r=this.gl,s=r.createShader(e);if(r.shaderSource(s,n),r.compileShader(s),!r.getShaderParameter(s,r.COMPILE_STATUS))throw new Error("Shader compilation error: "+r.getShaderInfoLog(s));return s}resize(){const e=window.devicePixelRatio||1;this.canvas.width=this.canvas.clientWidth*e,this.canvas.height=this.canvas.clientHeight*e,this.overlayCanvas.width=this.canvas.width,this.overlayCanvas.height=this.canvas.height;const n=this.fixedLeft*e,r=this.canvas.width-n;if(this.gl.viewport(n,0,r,this.canvas.height),this.data){const s=(this.canvas.width-this.fixedLeft*e)/e,i=this.timeStepBaseWidth*this.zoomLevel,o=s/i,a=Math.max(0,this.data.length-o);this.viewOffset=Math.min(a,this.viewOffset)}this.render()}setData(e){console.log("setData called with",e),this.data=e,this.viewOffset=0,this.analyzeDependencies(),console.log("Dependencies-downstream raw:",JSON.parse(JSON.stringify(this.dependencies.downstream))),console.log("Dependencies-upstream   raw:",JSON.parse(JSON.stringify(this.dependencies.upstream))),this.render()}updateMatrices(){if(!this.data)return;const e=window.devicePixelRatio||1,n=2,r=(this.canvas.width-this.fixedLeft*e)/e,s=this.timeStepBaseWidth*this.zoomLevel,i=r/s,o=this.data.length+1;this.viewOffset=Math.max(-1,Math.min(o,this.viewOffset));const a=Math.max(-n,this.viewOffset-n),l=Math.min(this.data.length+n,this.viewOffset+i+n),u=this.WORLD_COORDS.AXIS_Y-.5,c=this.WORLD_COORDS.TOP_Y+.5;ar(this.projectionMatrix,a,l,u,c,-1,1),Ff(this.viewMatrix);const f=(0-a)/(l-a)*2-1,d=(-1+this.fixedLeft/(r+this.fixedLeft)*2-f)*(l-a)/2;hs(this.viewMatrix,this.viewMatrix,[d,0,0]),Df(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix)}worldToScreen(e,n){const r=window.devicePixelRatio||1,s=zi(e,n,0,1);Vi(s,s,this.viewProjectionMatrix);const i=s[0]/s[3],o=s[1]/s[3],a=0,l=this.canvas.width-a,u=this.canvas.height,c=a+(i+1)*.5*l,f=(1-o)*.5*u;return[c*r,f*r]}screenToWorld(e,n){const r=window.devicePixelRatio||1,s=e/r,i=n/r,o=0,a=this.canvas.width-o,l=this.canvas.height,u=2*(s-o)/a-1,c=1-2*i/l,f=zi(u,c,0,1),h=le();Ra(h,this.viewProjectionMatrix),Vi(f,f,h);const d=f[0]/f[3],v=f[1]/f[3];return[d,v]}render(){!this.gl||!this.data||(this.animationFrame&&cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(()=>{this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.gl.clearColor(.98,.98,.98,1),this.gl.disable(this.gl.DEPTH_TEST),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.updateMatrices(),this.drawOperations(),this.drawOverlay(),console.log({zoomLevel:this.zoomLevel,viewOffset:this.viewOffset})}))}drawLanes(){const e=this.gl;e.useProgram(this.program),e.uniformMatrix4fv(this.uniforms.viewProjectionMatrix,!1,this.viewProjectionMatrix);const n=[],r=[];this.lanes.forEach((s,i)=>{const o=this.RECT_COORDS.LABEL_OFFSET_X,a=this.RECT_COORDS.LANE_START_Y+i*this.RECT_COORDS.LANE_HEIGHT+this.RECT_COORDS.LANE_HEIGHT*this.RECT_COORDS.RECT_HEIGHT_RATIO/2,l=this.worldToScreen(o,a)[1],u=this.RECT_COORDS.LANE_HEIGHT*this.RECT_COORDS.RECT_HEIGHT_RATIO,c=[-100,l,100,l,-100,l+u,-100,l+u,100,l,100,l+u];n.push(...c);const f=[...s.color];f[3]=.3;for(let h=0;h<6;h++)r.push(...f)}),this.drawGeometry(n,r,this.buffers.lanes)}drawOperations(){const e=this.gl;e.useProgram(this.program),e.uniformMatrix4fv(this.uniforms.viewProjectionMatrix,!1,this.viewProjectionMatrix);const n=[],r=[],{startTs:s,endTs:i}=this.getVisibleTimeStepRange();for(let o=s;o<=i;o++){const a=this.data[o];a&&["stores","loads","compute"].forEach(l=>{a[l]&&a[l].forEach(u=>{this.addOperationGeometry(n,r,u,l,o)})})}n.length>0&&(console.log("绘制操作矩形"),this.drawGeometry(n,r,this.buffers.operations))}addOperationGeometry(e,n,r,s,i){const o=this.lanes.findIndex(x=>x.id===s);if(o===-1)return;const a=this.RECT_COORDS.LANE_START_Y+o*this.RECT_COORDS.LANE_HEIGHT,l=this.RECT_COORDS.LANE_HEIGHT*this.RECT_COORDS.RECT_HEIGHT_RATIO,u=this.data[i],c=u[s]?u[s].length:1,f=u[s].indexOf(r),d=1/c,v=i+f*d,y=d,T=this.hoveredOperation&&this.hoveredOperation.op&&this.hoveredOperation.op.id===r.id,w=this.selectedOperations.has(r.id);let _=nl.getColorForOperator(r.id,1);T?_=[1,0,0,.3]:w&&(_=[0,1,0,.8]);const b=[v,a,v+y,a,v,a+l,v,a+l,v+y,a,v+y,a+l];e.push(...b);for(let x=0;x<6;x++)n.push(..._)}drawGeometry(e,n,r){const s=this.gl;console.log("绘制几何体 - 顶点数:",e.length/2);const i=new Float32Array(e.length/2*6);for(let o=0;o<e.length/2;o++)i[o*6]=e[o*2],i[o*6+1]=e[o*2+1],i[o*6+2]=n[o*4],i[o*6+3]=n[o*4+1],i[o*6+4]=n[o*4+2],i[o*6+5]=n[o*4+3];s.bindBuffer(s.ARRAY_BUFFER,r),s.bufferData(s.ARRAY_BUFFER,i,s.DYNAMIC_DRAW),s.enableVertexAttribArray(this.attributes.position),s.enableVertexAttribArray(this.attributes.color),s.vertexAttribPointer(this.attributes.position,2,s.FLOAT,!1,24,0),s.vertexAttribPointer(this.attributes.color,4,s.FLOAT,!1,24,8),s.drawArrays(s.TRIANGLES,0,e.length/2)}drawFixedLeftPanel(){const e=this.overlayCtx,n=window.devicePixelRatio||1,r=0,s=this.fixedLeft*n,i=this.overlayCanvas.height;e.save(),e.beginPath(),e.rect(r,0,s,i),e.clip(),e.fillStyle="#f7f7f7",e.fillRect(r,0,s,i),e.textAlign="right",e.textBaseline="middle",e.font=`${16*n}px Arial`,e.fillStyle="#333",this.lanes.forEach((l,u)=>{const c=this.RECT_COORDS.LANE_START_Y+u*this.RECT_COORDS.LANE_HEIGHT+this.RECT_COORDS.LANE_HEIGHT*this.RECT_COORDS.RECT_HEIGHT_RATIO/2,f=this.worldToScreen(0,c)[1];e.fillText(l.id,s-10*n,f)}),e.textAlign="left",e.textBaseline="middle",e.font=`${14*n}px Arial`;const o=this.WORLD_COORDS.AXIS_Y-.3,a=this.worldToScreen(0,o)[1];e.fillText("TimeSteps",r+10*n,a),e.restore()}drawAlignmentLinesWithCanvas2D(){const e=this.overlayCtx,n=window.devicePixelRatio||1;if(!this.data||this.data.length===0)return;const{startTs:r,endTs:s}=this.getVisibleTimeStepRange(),i=this.WORLD_COORDS.TOP_Y,o=this.WORLD_COORDS.AXIS_Y;e.strokeStyle="#544f4fff",e.lineWidth=1*n,e.setLineDash([2*n,2*n]);for(let a=r;a<=s;a++){const[l,u]=this.worldToScreen(a,i),[c,f]=this.worldToScreen(a,o);e.beginPath(),e.moveTo(l,u),e.lineTo(c,f),e.stroke()}e.setLineDash([])}drawTimelineWithCanvas2D(){const e=this.overlayCtx,n=window.devicePixelRatio||1;if(!this.data||this.data.length===0)return;const{startTs:r,endTs:s}=this.getVisibleTimeStepRange(),i=this.WORLD_COORDS.AXIS_Y,[o,a]=this.worldToScreen(r,i),[l,u]=this.worldToScreen(s,i);e.beginPath(),e.moveTo(o,a),e.lineTo(l,u),e.strokeStyle="#120c0cff",e.lineWidth=1*n,e.stroke();const c=this.calculateStepInterval(s-r);e.font=`${12*n}px Arial`,e.fillStyle="#333",e.textAlign="center",e.textBaseline="top";for(let f=r;f<=s;f++){const[h,d]=this.worldToScreen(f,i),[v,y]=this.worldToScreen(f,i-.3),T=f%c===0;if(T||(f===r||f===s)){e.beginPath();const _=T?10*n:6*n;e.moveTo(h,d-_),e.lineTo(h,d),e.strokeStyle=T?"#444":"#888",e.lineWidth=T?1.5*n:1*n,e.stroke(),T&&e.fillText(`T${f}`,v,y+5*n)}}this.debugCoordinateSystems()}calculateStepInterval(e){if(e<=0)return 1;const n=80,s=(this.canvas.width-this.fixedLeft*window.devicePixelRatio)/e;let i=1;return s<n&&(i=Math.ceil(n/s)),i>20?i=20:i>10?i=10:i>5?i=5:i>2&&(i=2),i}drawOverlay(){const e=window.devicePixelRatio||1;this.overlayCtx.clearRect(0,0,this.overlayCanvas.width,this.overlayCanvas.height),this.drawFixedLeftPanel(),this.overlayCtx.save(),this.overlayCtx.beginPath(),this.overlayCtx.rect(this.fixedLeft*e,0,this.overlayCanvas.width-this.fixedLeft*e,this.overlayCanvas.height),this.overlayCtx.clip(),this.drawTimelineWithCanvas2D(),this.drawAlignmentLinesWithCanvas2D(),this.drawDependenciesWithCanvas2D(),this.overlayCtx.restore(),this.renderOverlayTexture()}analyzeDependencies(){this.dependencies={downstream:{},upstream:{}};for(let e=0;e<this.data.length;e++)["loads","compute","stores"].forEach(n=>{this.data[e][n]&&this.data[e][n].forEach(r=>{const s=this.findDownstreamDependencies(r,e);s.length&&(this.dependencies.downstream[r.id]=s,s.forEach(i=>{this.dependencies.upstream[i.op.id]||(this.dependencies.upstream[i.op.id]=[]),this.dependencies.upstream[i.op.id].push({type:n,ts:e,op:r})}))})})}findDownstreamDependencies(e,n){const r=[];for(let s=n+1;s<this.data.length;s++)["loads","compute","stores"].forEach(i=>{if(!this.data[s][i])return;const o=this.data[s][i].find(a=>a.id===e.id);o&&r.push({type:i,ts:s,op:o})});return r}drawDependenciesWithCanvas2D(){console.log("drawDependenciesWithCanvas2D: selectedOperations =",this.selectedOperations);const e=window.devicePixelRatio||1;this.selectedOperations.forEach(n=>{this.dependencies.downstream[n]&&this.dependencies.downstream[n].forEach(r=>{const s=this.findOperationById(n),i={op:r.op,type:r.type,ts:r.ts};this.drawDependencyArrow(s,i,e,"#ff6b6b",2)}),this.dependencies.upstream[n]&&this.dependencies.upstream[n].forEach(r=>{const s={op:r.op,type:r.type,ts:r.ts},i=this.findOperationById(n);this.drawDependencyArrow(s,i,e,"#4ecdc4",2)})})}drawDependencyArrow(e,n,r,s,i){const o=this._getOpCenter(e),a=this._getOpCenter(n);if(!o||!a)return;const l=this.overlayCtx;l.beginPath(),l.moveTo(o.x,o.y);const u=Math.abs(a.x-o.x)*.4;l.bezierCurveTo(o.x+u,o.y,a.x-u,a.y,a.x,a.y),l.strokeStyle=s,l.lineWidth=i*r,l.setLineDash([]),l.stroke();const c=Math.atan2(a.y-o.y,a.x-o.x);l.save(),l.translate(a.x,a.y),l.rotate(c),l.fillStyle=s,l.beginPath(),l.moveTo(0,0),l.lineTo(-8*r,-4*r),l.lineTo(-8*r,4*r),l.closePath(),l.fill(),l.restore()}_getOpCenter({op:e,type:n,ts:r}){const s=this.lanes.findIndex(d=>d.id===n);if(s===-1)return null;const i=this.data[r],o=i[n]?i[n].length:1,a=i[n]?i[n].indexOf(e):0,l=1/o,u=r+a*l+l,c=this.RECT_COORDS.LANE_START_Y+s*this.RECT_COORDS.LANE_HEIGHT+this.RECT_COORDS.LANE_HEIGHT*this.RECT_COORDS.RECT_HEIGHT_RATIO/2,[f,h]=this.worldToScreen(u,c);return{x:f,y:h}}drawLaneLabelsWithCanvas2D(){const e=this.overlayCtx,n=window.devicePixelRatio||1;this.lanes.forEach((r,s)=>{const i=this.RECT_COORDS.LANE_START_Y+s*this.RECT_COORDS.LANE_HEIGHT+this.RECT_COORDS.LANE_HEIGHT*this.RECT_COORDS.RECT_HEIGHT_RATIO/2,o=-1,[a,l]=this.worldToScreen(o,i);e.fillStyle="#333",e.font=`${16*n}px Arial`,e.textAlign="right",e.textBaseline="middle",e.fillText(r.id,a,l)})}renderOverlayTexture(){const e=this.gl;e.bindTexture(e.TEXTURE_2D,this.overlayTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this.overlayCanvas),e.useProgram(this.overlayProgram),e.uniform1i(this.overlayUniforms.texture,0);const n=new Float32Array([-1,-1,0,1,1,-1,1,1,-1,1,0,0,-1,1,0,0,1,-1,1,1,1,1,1,0]);e.bindBuffer(e.ARRAY_BUFFER,this.buffers.overlay),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW),e.vertexAttribPointer(this.overlayAttributes.position,2,e.FLOAT,!1,16,0),e.vertexAttribPointer(this.overlayAttributes.texCoord,2,e.FLOAT,!1,16,8),e.drawArrays(e.TRIANGLES,0,6),e.enable(e.BLEND)}bindEvents(){this.canvas.addEventListener("wheel",this.handleWheel.bind(this)),this.canvas.addEventListener("mousemove",this.handleMouseMove.bind(this)),this.canvas.addEventListener("mousedown",this.handleMouseDown.bind(this)),this.canvas.addEventListener("mouseup",this.handleMouseUp.bind(this)),this.canvas.addEventListener("mouseleave",this.handleMouseLeave.bind(this)),this.canvas.addEventListener("click",this.handleClick.bind(this)),window.addEventListener("resize",this.resize.bind(this))}handleWheel(e){e.preventDefault();const n=this.canvas.getBoundingClientRect(),r=e.clientX-n.left,s=this.screenToWorld(r,0)[0],i=e.deltaY>0?-.1:.1,o=this.zoomLevel;this.zoomLevel=Math.max(this.minZoom,Math.min(this.maxZoom,this.zoomLevel+i));const a=o/this.zoomLevel,l=s;this.viewOffset=this.viewOffset+(s-l)*a,this.render()}handleMouseMove(e){const{x:n,y:r}=this.getCanvasRelativePosition(e),s=window.devicePixelRatio||1,i=n*s,o=r*s;if(this.isDragging){const[l,u]=this.screenToWorld(n,r),c=this.dragStartWorldX-l,f=this.startViewOffset+c,{x0:h,x1:d}=this.getVisibleTimeStepRange();this.viewOffset=Math.max(0,f),this.render();return}const a=this.hoveredOperation;this.hoveredOperation=this.findOperationAt(i,o),this.updateTooltip(n,r),a!==this.hoveredOperation&&this.render(),this.hoveredOperation&&this.onOperationHover(this.hoveredOperation)}getCanvasRelativePosition(e){const n=this.canvas.getBoundingClientRect(),r=getComputedStyle(this.canvas),s=parseInt(r.borderLeftWidth)||0,i=parseInt(r.borderTopWidth)||0,o=window.scrollX||window.pageXOffset,a=window.scrollY||window.pageYOffset;return{x:e.clientX+o-n.left-s,y:e.clientY+a-n.top-i}}handleMouseDown(e){this.isDragging=!0,this.dragStartX=e.clientX,this.startViewOffset=this.viewOffset;const{x:n,y:r}=this.getCanvasRelativePosition(e),[s,i]=this.screenToWorld(n,r);this.dragStartWorldX=s,e.preventDefault()}handleMouseUp(){this.isDragging=!1}handleMouseLeave(){this.isDragging=!1,this.hoveredOperation=null,this.updateTooltip(),this.render()}handleClick(e){if(!this.data||!this.hoveredOperation)return;const n=this.hoveredOperation.op.id;this.selectedOperations.clear(),this.selectedOperations.add(n),this.dependencies.downstream[n]&&this.dependencies.downstream[n].forEach(r=>{this.selectedOperations.add(r.op.id)}),this.dependencies.upstream[n]&&this.dependencies.upstream[n].forEach(r=>{this.selectedOperations.add(r.op.id)}),console.log(`Clicked operation: ${n}`),console.log("Selected operations:",[...this.selectedOperations]),this.onOperationSelect(this.hoveredOperation,this.selectedOperations),this.render()}addPeerDependencies(e){const n=this.findOperationById(e);if(n){if(n.type==="compute"){const r=this.findOperationByProperties({type:"loads",address:n.address,ts:n.ts-1}),s=this.findOperationByProperties({type:"stores",address:n.address,ts:n.ts+1});r&&this.selectedOperations.add(r.id),s&&this.selectedOperations.add(s.id)}else if(n.type==="loads"||n.type==="stores"){const r=this.findOperationByProperties({type:"compute",address:n.address,ts:n.type==="loads"?n.ts+1:n.ts-1});r&&this.selectedOperations.add(r.id)}}}findOperationAt(e,n){if(!this.data)return null;const[r,s]=this.screenToWorld(e,n),{startTs:i,endTs:o}=this.getVisibleTimeStepRange(2);for(let a=i;a<=o;a++){const l=this.data[a];if(l)for(const u of["stores","compute","loads"]){if(!l[u]||!l[u].length)continue;const c=this.lanes.findIndex(w=>w.id===u);if(c===-1)continue;const f=this.RECT_COORDS.LANE_HEIGHT*this.RECT_COORDS.RECT_HEIGHT_RATIO,h=this.RECT_COORDS.LANE_START_Y+c*this.RECT_COORDS.LANE_HEIGHT+f,d=h+f,v=window.devicePixelRatio||1;if(s*v<h||s*v>d)continue;const y=l[u].length,T=1/y;for(let w=0;w<y;w++){const _=l[u][w],b=a+w*T,x=b+T;if(r>=b&&r<=x)return{op:_,type:u,ts:a}}}}return null}calculateStepInterval(e){this.canvas.width-100;const r=Math.ceil(80/(this.timeStepBaseWidth*this.zoomLevel));return r<1?1:r>10?10*Math.ceil(r/10):r}findOperationById(e){if(!this.data)return null;for(let n=0;n<this.data.length;n++){const r=this.data[n];for(const s of["stores","compute","loads"])if(r[s]){const i=r[s].find(o=>o.id===e);if(i)return{op:i,type:s,ts:n}}}return null}updateTooltip(e,n){if(this.tooltipElement)if(this.hoveredOperation){const r=this.hoveredOperation.op,s=this.hoveredOperation.type;this.tooltipElement.innerHTML=`
        <div class="tooltip-title">Op</div>
        <div><span>ID:</span> ${r.id}</div>
        <div><span>Operation:</span> ${r.operation||"N/A"}</div>
        <div><span>Type:</span> ${s}</div>
        <div><span>TS:</span> ${this.hoveredOperation.ts}</div>
        <div><span>Duration:</span> ${Math.max(1,r.hold_in_lmem||0)} time steps</div>
        <div><span>Target:</span> ${r.target||"N/A"}</div>
      `,this.tooltipElement.style.left=`${e+15}px`,this.tooltipElement.style.top=`${n+15}px`,this.tooltipElement.classList.add("show")}else this.tooltipElement.classList.remove("show")}lightenColor(e,n){return[Math.min(1,e[0]+n),Math.min(1,e[1]+n),Math.min(1,e[2]+n),e[3]]}zoomIn(){this.zoomLevel=Math.min(this.maxZoom,this.zoomLevel+.2),this.render()}zoomOut(){this.zoomLevel=Math.max(this.minZoom,this.zoomLevel-.2),this.render()}resetZoom(){this.zoomLevel=1,this.viewOffset=0,this.render()}destroy(){this.animationFrame&&cancelAnimationFrame(this.animationFrame),this.gl&&(this.gl.deleteProgram(this.program),this.gl.deleteProgram(this.overlayProgram),Object.values(this.buffers).forEach(e=>this.gl.deleteBuffer(e)),this.gl.deleteTexture(this.overlayTexture)),this.canvas.removeEventListener("wheel",this.handleWheel),this.canvas.removeEventListener("mousemove",this.handleMouseMove),this.canvas.removeEventListener("mousedown",this.handleMouseDown),this.canvas.removeEventListener("mouseup",this.handleMouseUp),this.canvas.removeEventListener("mouseleave",this.handleMouseLeave),this.canvas.removeEventListener("click",this.handleClick),window.removeEventListener("resize",this.resize)}logPoint(e,n,r){const[s,i]=this.worldToPhysical(n,r);console.log(`${e} | world(${n}, ${r}) -> phys(${s.toFixed(1)}, ${i.toFixed(1)})`)}worldToPhysical(e,n){const[r,s]=this.worldToScreen(e,n);return[r,s]}getVisibleTimeStepRange(e=1){const n=window.devicePixelRatio||1,r=this.fixedLeft;if(!this.data)return{startTs:0,endTs:0};const s=(this.canvas.width-r*n)/(this.timeStepBaseWidth*this.zoomLevel*n),i=Math.max(0,Math.floor(this.viewOffset-e)),o=Math.min(this.data.length-1,Math.ceil(this.viewOffset+s+e));return{startTs:i,endTs:o}}debugCoordinateSystems(){console.log("坐标系调试:"),console.log("- Y轴屏幕位置:",this.fixedLeft),console.log("- 时间步0世界坐标: (0, 0)"),console.log("- 时间步0屏幕坐标:",this.worldToScreen(0,0)),console.log("- 视图偏移 viewOffset:",this.viewOffset),console.log("- 画布宽度:",this.canvas.width)}}const Hm={class:"timestep-view"},$m={class:"toolbar"},Wm={class:"visualization-area"},Um={key:0,class:"stats-panel"},zm={__name:"timestep-view",setup(t){const e=it(null),n=it(null),r=it(null),s=it(null),i=it(null),o=At(()=>s.value?.length||0),a=At(()=>s.value?.reduce((w,_)=>w+(_.compute?.length||0),0)||0),l=At(()=>s.value?.reduce((w,_)=>w+(_.loads?.length||0),0)||0),u=At(()=>s.value?.reduce((w,_)=>w+(_.stores?.length||0),0)||0);Sr(async()=>{await Dn(),i.value=new Nm({canvas:e.value,tooltipElement:n.value,onOperationSelect:f,onOperationHover:h}),window.addEventListener("resize",T),T()}),Ar(()=>{i.value?.destroy(),window.removeEventListener("resize",T)});function c(w){let _=w;if(w&&w.timestep&&(_=w.timestep),!_?.length){console.warn("[TimestepView] No valid timestep data received");return}s.value=_,i.value.setData(_),i.value.render()}function f(w,_){console.log("Operation selected:",w,_)}function h(w){}function d(){i.value?.zoomIn()}function v(){i.value?.zoomOut()}function y(){i.value?.resetZoom()}function T(){if(!r.value)return;const{width:w,height:_}=r.value.getBoundingClientRect();e.value.width=w,e.value.height=_,i.value?.render()}return(w,_)=>(ct(),pt("div",Hm,[N("div",$m,[ot(rl,{onFileLoaded:c}),N("div",{class:"zoom-controls"},[N("button",{onClick:d},"+"),N("button",{onClick:v},"-"),N("button",{onClick:y},"Reset")])]),N("div",Wm,[N("div",{class:"main",ref_key:"main",ref:r},[N("canvas",{ref_key:"canvas",ref:e,class:"timestep-canvas"},null,512),N("div",{ref_key:"tooltip",ref:n,class:"tooltip"},null,512)],512)]),s.value?(ct(),pt("div",Um,[_[0]||(_[0]=N("h3",null,"时间步统计",-1)),N("p",null,"总时间步: "+ht(o.value),1),N("p",null,"compute操作: "+ht(a.value),1),N("p",null,"load操作: "+ht(l.value),1),N("p",null,"store操作: "+ht(u.value),1),ot(sl,{"initial-settings":s.value?.settings||{},"available-configs":w.allLmemConfigs,"current-index":w.currentConfigIndex,onConfigChange:w.handleConfigChange},null,8,["initial-settings","available-configs","current-index","onConfigChange"])])):Xe("",!0)]))}},Vm=Je(zm,[["__scopeId","data-v-0524a0bb"]]),Gm=[{path:"/",redirect:"/lmem"},{path:"/lmem",name:"lmem",component:Bm},{path:"/timestep",name:"timestep",component:Vm}],Ym=Pf({history:af(),routes:Gm});console.log(">>> main.js 正在执行");xu(Ru).use(Ym).mount("#app");</script>
    <style rel="stylesheet" crossorigin>#app[data-v-d174690f]{height:100vh;display:flex;flex-direction:column}.view-navigation[data-v-d174690f]{background-color:#2c3e50;padding:1rem;display:flex;gap:1rem;box-shadow:0 2px 4px #0000001a}.nav-link[data-v-d174690f]{color:#ecf0f1;text-decoration:none;padding:.5rem 1rem;border-radius:4px;transition:background-color .3s ease}.nav-link[data-v-d174690f]:hover{background-color:#34495e}.nav-link.active[data-v-d174690f]{background-color:#3498db;font-weight:700}.main-content[data-v-d174690f]{flex:1;overflow:hidden}.file-selector[data-v-3d273144]{cursor:pointer;display:inline-flex;flex-direction:column;padding:12px;border:1px solid #ccc;border-radius:8px;background:#f8f9fa;font-size:14px;min-width:80px}.file-selector input[type=file][data-v-3d273144]{display:none}.status[data-v-3d273144]{margin-top:4px;font-size:8px;color:#666}.comparison-slider[data-v-2aa7e75b]{display:flex;align-items:center;gap:8px;font-size:14px}.comparison-slider select[data-v-2aa7e75b]{padding:2px 4px}.spec-panel[data-v-d54721e5]{padding:8px;background:#f8f9fa;border:1px solid #e0e0e0;border-radius:4px;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;font-size:11px;line-height:1.2}.header h3[data-v-d54721e5]{margin:0 0 4px;font-size:14px;font-weight:600;color:#2c3e50}.config-selector label[data-v-d54721e5]{font-size:13px;color:#5c6b7a;margin-right:8px}.config-selector select[data-v-d54721e5]{padding:5px 8px;border:1px solid #d1d5db;border-radius:4px;background:#fff;font-size:13px}.chip-info[data-v-d54721e5]{margin-top:8px}.chip-info h4[data-v-d54721e5]{margin:0 0 4px;font-size:12px;color:#374151}.chip-details[data-v-d54721e5]{display:flex;flex-wrap:wrap;gap:4px 12px}.chip-item[data-v-d54721e5]{width:calc(33% - 6px);display:flex;justify-content:space-between;height:20px;line-height:20px}.chip-item .label[data-v-d54721e5]{color:#6b7280}.chip-item .value[data-v-d54721e5]{color:#111;font-family:Monaco,Consolas,monospace}.lmem-view[data-v-82baa55a]{display:grid;grid-template-rows:auto 1fr auto;height:120vh;background:#f8f9fa}.toolbar[data-v-82baa55a]{grid-row:1;flex:0 0 60px;display:flex;align-items:center;gap:1rem;padding:0 1.5rem;border-bottom:1px solid #e0e0e0;background:#fff;box-shadow:0 1px 3px #0000001a}.visualization-area[data-v-82baa55a]{grid-row:2;display:flex;flex-direction:column;min-height:0;overflow:auto}.specs-panel[data-v-82baa55a]{grid-row:3;max-height:40vh;min-height:330px;padding:12px 20px;background:#f5f7f9;border-top:1px solid #dde1e6;overflow-y:auto}.main[data-v-82baa55a]{flex:1;position:relative;min-height:450px;background:#fff;border-bottom:1px solid #e0e0e0}.lmem-canvas[data-v-82baa55a]{width:100%;height:100%;display:block}.tooltip[data-v-82baa55a]{position:absolute;pointer-events:none;background:#000000e6;color:#fff;padding:10px 12px;border-radius:6px;font-size:13px;line-height:1.4;z-index:1000;box-shadow:0 4px 12px #00000026;max-width:300px;display:none;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.tooltip.show[data-v-82baa55a]{display:block;animation:fadeIn-82baa55a .15s ease-out}.tooltip-title[data-v-82baa55a]{font-weight:600;margin-bottom:6px;color:#fff;border-bottom:1px solid rgba(255,255,255,.2);padding-bottom:4px}.tooltip div[data-v-82baa55a]{margin:3px 0}.tooltip span[data-v-82baa55a]{font-weight:500;color:#ccc;margin-right:6px}.summary[data-v-82baa55a]{flex:0 1 relative;min-height:450px;padding:0;background:#fff;border-top:1px solid #e0e0e0}.summary-canvas[data-v-82baa55a]{width:90%;height:90%;background:#fafafa;border-radius:4px;border:1px solid #e0e0e0}.reset-btn[data-v-82baa55a]{position:absolute;top:3px;right:4px;width:28px;height:28px;border-radius:50%;border:none;background:#fffc;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);font-size:14px;cursor:pointer;box-shadow:0 1px 4px #00000040}.reset-btn[data-v-82baa55a]:hover{background:#fff}@keyframes fadeIn-82baa55a{0%{opacity:0;transform:translateY(5px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 768px){.toolbar[data-v-82baa55a]{padding:0 1rem;flex-wrap:wrap;height:auto;min-height:60px}.summary[data-v-82baa55a]{flex:0 0 120px;padding:8px}.specs-panel[data-v-82baa55a]{padding:10px;font-size:12px}}.timestep-view[data-v-0524a0bb]{display:flex;flex-direction:column;height:100vh;background:#f8f9fa}.toolbar[data-v-0524a0bb]{flex:0 0 60px;display:flex;align-items:center;padding:0 1.5rem;border-bottom:1px solid #e0e0e0;background:#fff;box-shadow:0 1px 3px #0000001a}.visualization-area[data-v-0524a0bb]{flex:1;display:flex;flex-direction:column;min-height:0}.main[data-v-0524a0bb]{flex:1;position:relative;min-height:500px;background:#fff}.timestep-canvas[data-v-0524a0bb]{width:100%;height:100%;display:block;cursor:grab}.timestep-canvas[data-v-0524a0bb]:active{cursor:grabbing}.tooltip[data-v-0524a0bb]{position:absolute;pointer-events:none;background:#000000e6;color:#fff;padding:10px 12px;border-radius:6px;font-size:13px;line-height:1.4;z-index:1000;box-shadow:0 4px 12px #00000026;max-width:300px;display:none;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.tooltip.show[data-v-0524a0bb]{display:block;animation:fadeIn-0524a0bb .15s ease-out}.tooltip .tooltip-title[data-v-0524a0bb]{font-weight:600;margin-bottom:8px;color:#fff;border-bottom:1px solid rgba(255,255,255,.2);padding-bottom:6px}.tooltip div[data-v-0524a0bb]{margin:4px 0;display:flex;align-items:center}.tooltip span[data-v-0524a0bb]:first-child{font-weight:500;color:#aaa;min-width:80px;margin-right:8px}.stats-panel[data-v-0524a0bb]{flex:0 0 auto;padding:12px 20px;background:#f5f7f9;border-top:1px solid #dde1e6;font-size:13px}.stats-panel h3[data-v-0524a0bb]{margin:0 0 8px;color:#2c3e50;font-size:15px;font-weight:600}.stats-panel p[data-v-0524a0bb]{margin:5px 0;color:#5c6b7a;line-height:1.4}.zoom-controls[data-v-0524a0bb]{margin-left:auto;display:flex;gap:8px}.zoom-controls button[data-v-0524a0bb]{padding:6px 12px;background:#f0f0f0;border:1px solid #ddd;border-radius:4px;cursor:pointer;transition:background .2s}.zoom-controls button[data-v-0524a0bb]:hover{background:#e0e0e0}@keyframes fadeIn-0524a0bb{0%{opacity:0;transform:translateY(5px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 768px){.toolbar[data-v-0524a0bb]{padding:0 1rem}.stats-panel[data-v-0524a0bb]{padding:10px;font-size:12px}}</style>
  </head>
  <body>
    <div id="app">
      <div style="padding: 20px; text-align: center;">
        应用加载中...
      </div>
    </div>
    <!-- Vite 会注入 JS -->
  </body>
</html>